---
slug: 计算机
title: 计算机
description: 计算机,计算机网络,安全,通信,软考,linux,windows
keywords: 计算机,计算机网络,安全,通信,软考,linux,windows
category: 计算机,计算机网络,安全,通信,软考,linux,windows
tags: [计算机,计算机网络,安全,通信,软考,linux,windows]
author: liming
date: 28-12-2022
sticky: 1
swiper_index: 1
swiper_desc: 计算机,计算机网络,安全,通信,软考,linux,windows
---

上午的考试为62道选择题，总分75分，通过分数通常为45分。纵观下面的考点分布，根据考试用书的章节，将各章节考点的分数占比从高到低排序：

- “第6章 网络互连与互联网”，占比高达20%。
- “第8章 网络安全”，占比12%。
- “第9章 网络操作系统与应用服务器配置”，占比12%。
- “第12章 网络规划和设计”，占比10%。
- “第13章 计算机基础知识”，占比10%。
- “第2章 数据通信基础”，占比8%。
- “第4章 局域网与城域网”，占比8%。
- “第10章 组网技术”，占比8%。
- “第3章 广域通信网”，占比5%。



# 常识

## 概念

## 单位

### 存储单位

![929a50a758624913b389a8d7d14dfe20](img/计算机/计算机基础/929a50a758624913b389a8d7d14dfe20.png)

- 位（bit）

- 字节（Byte）

- 字、字长

  定义：CPU一次能处理的二进制就是一个字；CPU一次能处理的**二进制的位数**就是字长；
  举例说明
  32位的CPU，一次能处理32位的二进制（32bit是一个字），此时字长是32；所以 1字 = 32 bit（32个字长）；
  64位的CPU，一次能处理64位的二进制（64bit是一个字），此时字长是64；所以 1字 = 64 bit；（64个字长）

### 波特率/速率

波特率用于描述UART通信时的通信速度，其单位为bps bit per second）即**每秒钟传送的bit的数量** 。bps=bit/s

通过知道每秒钟传送的bit的数量，可得到1个bit传送的时间，从而知道传输的是1位还是2位(电平一样)。但是这个接收方和发送方时间基准可能不同（即串口异步），从而造成累计误差，为了避免误差，最多只发8位

### 周期和频率

f=1/T

f是指赫兹，赫兹是国际单位制中频率的单位（赫兹(H·Hertz)是德国著名的物理学家,1887年,是他通过实验证实了电磁波的存在。后人为了纪念他,把“赫兹”定为频率的单位），它具体是指每秒中的周期性变动重复次数的计量。秒是时间的计量单位。

- 频率：1秒中发生的次数；

- 周期：发生一次所需要的时间；

- 频率和周期互为倒数。*时间(s)=1÷时钟频率Hz*
  - 4、1Hz —— 1s
  - 5、KHz —— ms
  - 6、MHz —— us

| 周期类型   | 与其它周期类型的关系                                         |
| ---------- | ------------------------------------------------------------ |
| 振荡周期   | 1/ (晶振频率) 或 1/(RC震荡频率）                             |
| 时钟周期   | 振荡周期* 分频比 <br/>分频比是指计数器电路中，输出信号的频率与输入信号的频率之比。 |
| 机器周期   | 时钟周期* 单片机T数                                          |
| 单指令周期 | 机器周期                                                     |
| 双指令周期 | 2* 机器周期                                                  |
| 四指令周期 | 4* 机器周期                                                  |

#### 时钟/CPU频率

时钟以精确和固定的时间间隔，发出脉冲信号，其信号被控制单元用于推进CPU的内部操作。

**时钟的频率由处理器内部的晶体振荡器控制**，处理器会按照时钟周期的长度执行一系列的操作，包括取指令、解码指令、读写数据、执行运算等。处理器的时钟频率越高，每秒钟可以执行的操作就越多，因此处理器的运行速度也就越快。

#### 时钟/CPU周期

时钟周期也称为振荡周期，定义为时钟频率的倒数，**[单片机](https://so.csdn.net/so/search?q=单片机&spm=1001.2101.3001.7020)中最小的时间单位。**

> 例如51单片机中，时钟频率是12MHz，那么它的时钟周期就是1/12us。
>
> 在51单片机中晶振频率没有分频就直接作为CPU频率使用，所以
>
> 时钟周期 = 晶振周期 = 振荡周期。

#### 状态周期

在51单片机中把一个时钟周期定义为一个节拍（用P表示），二个节拍定义为一个状态周期（用S表示）。即**两个时钟周期=状态周期**。

#### 机器周期

取指令、存储器读、存储器写等，这每一项工作称为一个基本操作。完成一个基本操作所需要的时间称为机器周期。

51单片机的一个机器周期同6个S周期（状态周期）组成，即51单片机的机器周期由6个状态周期组成，也就是 **机器周期=6个状态周期=12个时钟周期**
那么以12Mhz的振荡频率为例，一个机器周期的时长是1us。

## 公式

### 逻辑

逻辑异或的公式：相同逻辑变量异或结果为0；相异逻辑变量异或结果为1。

$0\bigoplus0或者1\bigoplus1=0$

$0\bigoplus1=1$



# 计算机

## 编码

### ASCII 编码

计算机是以二进制的形式来存储数据的，它只认识 0 和 1 两个数字，我们在屏幕上看到的文字，在存储之前都被转换成了二进制（0和1序列），在显示时也要根据二进制找到对应的字符。

可想而知，特定的文字必然对应着固定的二进制进行标识，否则在转换时将发生混乱。那么，怎样将文字与二进制对应起来呢？这就需要有一套规范，计算机公司和软件开发者都必须遵守，这样的一套规范就称为字符集（Character Set）或者字符编码（Character Encoding）。

> 严格来说，字符集和字符编码不是一个概念，字符集定义了文字和二进制的对应关系，为字符分配了唯一的编号，而字符编码规定了如何将文字的编号存储到计算机中。

可以将字符集理解成一个很大的表格，它列出了所有字符和二进制的对应关系，计算机显示文字或者存储文字，就是一个查表的过程。

![ASCII](img/编程语言/c语言/ASCII.png)

## 进制

http://c.biancheng.net/view/1725.html

### 转换为十进制

假设当前数字是 N 进制，那么：

- 对于整数部分，从右往左看，第 i 位的位权等于$N^{i-1}$
- 对于小数部分，恰好相反，要从左往右看，第 j 位的位权为$N^{-j}$

整数部分

例如，将八进制数字 53627 转换成十进制：

53627 = 5×8^4 + 3×8^3 + 6×8^2 + 2×8^1 + 7×8^0 = 22423（十进制）

小数部分

例如，将八进制数字 423.5176 转换成十进制：

423.5176 = 4×8^2 + 2×8^1 + 3×8^0 + 5×8^-1 + 1×8^-2 + 7×8^-3 + 6×8^-4 = 275.65576171875（十进制）

### 十进制转换

#### 整数部分

十进制整数转换为 N 进制整数采用“**除 N 取余，逆序排列**”法。具体做法是：

- 将 N 作为除数，用十进制整数除以 N，可以得到一个商和余数；
- 保留余数，用商继续除以 N，又得到一个新的商和余数；
- 仍然保留余数，用商继续除以 N，还会得到一个新的商和余数；
- ……
- 如此反复进行，每次都保留余数，用商接着除以 N，直到商为 0 时为止。

把先得到的余数作为 N 进制数的低位数字，后得到的余数作为 N 进制数的高位数字，依次排列起来，就得到了 N 进制数字。

将十进制数字 36926 转换成八进制的过程：

![img](http://c.biancheng.net/uploads/allimg/181221/1AP56143-0.png)

#### 小数部分

十进制小数转换成 N 进制小数采用“**乘 N 取整，顺序排列**”法。具体做法是：

- 用 N 乘以十进制小数，可以得到一个积，这个积包含了整数部分和小数部分；
- 将积的整数部分取出，再用 N 乘以余下的小数部分，又得到一个新的积；
- 再将积的整数部分取出，继续用 N 乘以余下的小数部分；
- ……
- 如此反复进行，每次都取出整数部分，用 N 接着乘以小数部分，直到积中的小数部分为 0，或者达到所要求的精度为止。


把取出的整数部分按顺序排列起来，先取出的整数作为 N 进制小数的高位数字，后取出的整数作为低位数字，这样就得到了 N 进制小数。

将十进制小数 0.930908203125 转换成八进制小数的过程：

![img](http://c.biancheng.net/uploads/allimg/181221/1AP55414-2.png)

如果一个数字既包含了整数部分又包含了小数部分，那么将整数部分和小数部分开，分别按照上面的方法完成转换，然后再合并在一起即可

- 十进制数字 36926.930908203125 转换成八进制的结果为 110076.7345；



> 对十进制数47和0.25分别表示为十六进制形式，为（）。
>
> 十进制47转二进制为101111，转十六进制，整数从右至左每四位一组，为2F。
>
> 十进制0.25转二进制0.01，转十六进制，小数从左至右每四位一组，后面补00，为0.4。

### 二进制和八进制、十六进制的转换

#### 二进制整数和八进制整数之间的转换

二进制整数转换为八进制整数时，每三位二进制数字转换为一位八进制数字，运算的顺序是从低位向高位依次进行，高位不足三位用零补齐

![img](http://c.biancheng.net/uploads/allimg/181221/1AP53a2-4.png)

八进制整数转换为二进制整数时，思路是相反的，每一位八进制数字转换为三位二进制数字，运算的顺序也是从低位向高位依次进行

![img](http://c.biancheng.net/uploads/allimg/181221/1AP54395-5.png)

#### 二进制整数和十六进制整数之间的转换

![img](http://c.biancheng.net/uploads/allimg/181221/1AP53006-6.png)

![img](http://c.biancheng.net/uploads/allimg/181221/1AP53555-7.png)

## 原码补码反码

### 概念引入

在介绍补码概念之前，先介绍一下“[模](https://baike.baidu.com/item/模/13332718?fromModule=lemma_inlink)”的概念：“模”是指一个计量系统的计数范围，如过去计量粮食用的斗、时钟等。计算机也可以看成一个计量机器，因为计算机的存储和处理的位数是有限的，因此它也有一个计量范围，即都存在一个“模”。如：时钟的计量范围是0~11，模=12。表示n位的[计算机](https://baike.baidu.com/item/计算机/140338?fromModule=lemma_inlink)计量范围是

$$
0\sim2^n-1
$$
，模=

$$
2^n
$$
“模”实质上是计量器产生“溢出”的量，它的值在计量器上表示不出来，计量器上只能表示出模的余数。**任何有模的计量器，均可化减法为加法运算 。**

假设当前时针指向8点，而准确时间是6点，调整时间可有以下两种拨法：一种是倒拨2小时，即8-2=6；另一种是顺拨10小时，8+10=12+6=6，即8-2=8+10=8+12-2(mod 12)．在12为模的系统里，加10和减2效果是一样的，因此凡是减2运算，都可以用加10来代替。若用一般公式可表示为：a-b=a-b+mod=a+mod-b。**对“模”而言，2和10互为补数**。实际上，以12为模的系统中，11和1，8和4，9和3，7和5，6和6都有这个特性，共同的特点是两者相加等于模。对于[计算机](https://baike.baidu.com/item/计算机/140338?fromModule=lemma_inlink)，其概念和方法完全一样。n位计算机，设n=8，所能表示的最大数是11111111，若再加1成100000000(9位)，但因只有8位，最高位1自然丢失（相当于丢失一个模）。又回到了 00000000，所以8位[二进制](https://baike.baidu.com/item/二进制/361457?fromModule=lemma_inlink)系统的模为$2^8$

在这样的系统中减法问题也可以化成加法问题，只需**把减数用相应的补数表示**就可以了。把补数用到计算机对数的处理上，就是补码。**8-2=8+12-2=8+10，2和10是补码(mod 12)**

**取反后加1**

- 00001011- 00000100 = 00000111（11-4=7）


- 补码：00001011- 00000100 =  00001011+（11111011+1）= 00000111

### 编码

计算机中的有符号数有三种表示方法，即[原码](https://baike.baidu.com/item/原码/1097586?fromModule=lemma_inlink)、[反码](https://baike.baidu.com/item/反码/769985?fromModule=lemma_inlink)和补码。三种表示方法均有符号位和数值位两部分

- 符号位，都是用0表示“正”，用1表示“负”，

- 数值位，三种表示方法各不相同


> 在[计算机](https://baike.baidu.com/item/计算机/140338?fromModule=lemma_inlink)系统中，**数值一律用补码来表示和存储。**原因在于，使用补码，可以将符号位和数值域统一处理；同时，**加法和减法也可以统一处理** 

![数据编码](img/计算机/计算机基础/数据编码.png)

### 原码求补码

#### 正数

正整数与原码相同 。

例：+9的补码是00001001。

#### 负数

求负整数的补码，将其原码**除符号位外的所有位取反**（0变1，1变0，符号位为1不变）**后加1** 。

同一个数字在不同的补码表示形式中是不同的。比如-15的补码，在8位二[进制](https://baike.baidu.com/item/进制?fromModule=lemma_inlink)中是11110001，然而在16位二进制补码表示中，就是1111111111110001。以下都使用8位2进制来表示。

例：求-5的补码

-5对应带符号位负数5（10000101）→除符号位外所有位取反（11111010）→加 00000001为 (11111011)

所以-5的补码是11111011。

#### 0的补码

数0的补码表示是**唯一**的 。

[+0]补=[+0]反=[+0]原=00000000

[ -0]补=11111111+1=00000000

### 补码求原码

**已知一个数的补码，求原码的操作其实就是对该补码再求补码 ：**

⑴如果补码的符号位为“0”，表示是一个[正数](https://baike.baidu.com/item/正数/1294288?fromModule=lemma_inlink)，其原码就是补码。

⑵如果补码的符号位为“1”，表示是一个[负数](https://baike.baidu.com/item/负数/1294977?fromModule=lemma_inlink)，那么求给定的这个补码的补码就是要求的原码。

例：已知一个补码为11111001，则原码是10000111。

解：因为符号位为“1”，表示是一个负数，所以该位不变，仍为“1”。其余七位1111001取反后为0000110；再加1，所以是10000111。



## 计算机分类

### Flynn

Flynn根据不同的指令流和数据流组织方式，把计算机系统分成如下4类：

| 类型                   | 特点                                                 | 典型                                |
| ---------------------- | ---------------------------------------------------- | ----------------------------------- |
| SISD                   | 传统串行计算机，一个时钟周期仅处理一条指令和一条数据 | 早期的大型机 / 微型机 / 单核 PC     |
| SIMD                   | 所有处理器单时钟一条指令处理多条数据                 | 矩阵处理器 / 向量流水线             |
| MISD(**只有理论意义**) | 多个处理单元各自独立使用指令处理一条数据             | 实时容错计算机 / 单一信号多频滤波器 |
| MIMD                   | **每个处理器**执行各自的指令和各自的数据             | 超级计算机 / 集群服务器 /多核计算机 |

串行计算机单个处理器 + 单条指令 + 单条数据 = SISD

现代计算机多个处理器 + 独立指令(或单条指令) + 独立数据 = MIMD (或SIMD)

超级计算机多个处理器 + 独立指令 + 独立数据 = MIMD

## 计算机硬件架构

计算机硬件系统是冯诺依曼设计的体系结构，由运算器、控制器、存储器、输入/输出设备（1/0）五大部件组成，**运算器和控制器组成中央处理器（CPU）。**

<img src="img/计算机/计算机网络/image-20240918141124738.png" alt="image-20240918141124738" style="zoom: 50%;" />

### CPU

cpu组成：

- 运算器
- 控制器
- 寄存器组（PC、IR、PSW、DR、通用寄存器等）
- 内部总线
- 中断系统组成

如下图所示：

![image-20230318215729763](img/计算机/计算机网络/image-20230318215729763.png)

#### 控制器

控制器的功能：**它决定了计算机运行过程的自动化**

- 从指令cache中取出一条指令，并指出下一条指令在cache中的位置。
- 对指令进行译码或测试，并产生相应的操作控制信号，以便于启动规定的动作。例如：一次数据cache的读写操作，一个算术逻辑运算操作，一个输入输出操作。
- 指挥并控制CPU，数据cache和输入输出设备之间数据流向的方向。

控制器的组成

- 程序计数器**PC**：程序的执行分两种情况，一是顺序执行，二是转移执行。
  - **PC（程序计数器）是用于存放下一条指令所在单元的地址**。当执行一条指令时，处理器首先 需要从 PC 中取出指令在内存中的地址，通过地址总线寻址获取。执行指令时，CPU 将自动修改 PC 的 内容，以便使其保持的总是将要执行的下一条指令的地址。**由于大多数指令都是按顺序来执行的， 所以修改的过程通常只是简单地对 PC 加 1**。
  - 当遇到转移指令时，后继指令的地址根据当前指令的 地址加上一个向前或向后转移的位移量得到，或者根据转移指令给出的直接转移地址得到。

- 指令寄存器**IR**：**用来存放当前正在执行的指令**。当 CPU 执行一条指令时，先把它从内存储器取到缓冲寄存器中，再送入IR暂存。
  - 指令寄存器的位数取决于 （ ）。指令字长
- 地址寄存器**AR**：AR保存**当前CPU所访问的内存单元的地址**，暂存指令执行地址
- 指令译码器**ID**：对指令进行“翻译”，确定指令执行什么操作。指令分为操作码和地址码两部分

#### 运算器

(1) 算术逻辑单元ALU：处理数据，实现对数据的算术运算和逻辑运算。

(2) 累加寄存器AC：为ALU提供一个工作区，例如，在执行一个减法运算前，先将被减数取出暂存在AC中，再从内存储器中取出减数，然后同AC的内容相减，将所得的结果送回AC中

(3) 数据缓冲寄存器DR：用来暂时存放由内存读出的一条指令或一个[数据字](https://baike.baidu.com/item/数据字/8877755?fromModule=lemma_inlink)；反之，当向内存存入一条指令或一个数据字时，也暂时将它们存放在数据缓冲寄存器中。**DR的主要作用为： 作为CPU和内存、外部设备之间数据传送的中转站，起操作速度上的缓冲**

(4) 状态条件寄存器PSW：保存由算术指令和逻辑指令运行或测试的结果建立的各种条件码内容，主要分为状态标志和控制标志

#### 知识点

##### cpu位宽 vs cpu的地址总线位宽

cpu位宽不等于cpu的地址总线位宽

16位cpu（cpu位宽是16位）的地址总线位宽可以是20位。32位cpu的地址总线位宽可以是36位。64位cpu的地址总线位宽可以是36位或者40位（cpu能够寻址的物理地址空间为64GB或者1T）。

- cpu位宽表示一次能够处理的数据宽度

  我们说的16位cpu，32位cpu，64位cpu，指的都是cpu的位宽，**表示的是一次能够处理的数据宽度，即一个时钟周期内cpu能处理的2进制位数**，即分别是16bit，32bit和64bit。不是地址总线的数目。

  （那么是谁决定了cpu可以处理的数据宽度呢？通用寄存器的宽度决定了cpu可以直接表示的数据范围。我们说的16位cpu，32位cpu，64位cpu，指的就是通用寄存器的位数（宽度）。见汇编语言 那篇文章）

- **cpu的地址总线位宽决定了可以直接进行寻址物理内存空间。**

  所以如果cpu的址总线位宽是32位的，也就是它可以寻址能力就是0~0xFFFFFFFF（4G）的物理内存空间。（36位或者40位，它们寻址的物理地址空间为64GB或者1T）

  虽然如果你的计算机上只装了512M的内存条，物理地址的有效部分只有0x00000000~0x1FFFFFFF，其他部分都是无效的物理地址。（这里无视一些外部的I/O设备映射到物理空间。）

  在cpu访问任何存储单元必须知道其物理地址，所以在一定程度上，cpu的地址总线宽度影响了最大支持的物理内存RAM大小。



### 输入输出

计算机输入输出/Q控制有3种方式：直接程序控制（软件方式）、中断方式（软件+硬料）、直接存储器存取（DMA）。

- 直接程序控制/程序查询（软件方式）：软件方式会消耗CPU资源，导致CPU利用率低，因此，这种方式适合工作不太繁忙的系统。

- 中断方式（软件+硬件方式）：当出现来自系统外部、机器内部甚至处理机本身的任何例外时，CPU暂停执行现行程序，转去处理这些事情，

  等处理完成后再返回来继续执行原先的程序。中断处理过程为：

  - 引入中断的原因：
    1.适应 I/O 设备工作速度低问题
    2.将有用信息送至不受电源控制的存储系统中，带电源恢复后接着使用

  - 中断处理程序的流程：

    1.中断请求

    2.中断判优：可能会有多个部件同时请求中断，此时需要判优

    3.中断响应：判优完成之后，就需要对 CPU 进行中断了，CPU保护好被中断的主程序的断点及现场信息，保持中断前一时刻的状态不被破坏。

    4.中断服务：此次响应完以后，CPU根据中断类型码从中断向量表中找到对应中断服务程序的入口地址，并进入中断服务程序，执行某些操作

    5.中断返回：服务程序执行完成之后，就要返回原来的地方，继续执行原本的程序

  - 中断服务程序流程：

    1.保护现场。 （保护程序断点，保护通用寄存器和状态寄存器）
    
    2.中断服务程序: 不同的 I/O 设备具有不同的中断服务程序
    
    3.恢复现场：将原程序中断时现场恢复到原来的寄存器中（采用取数指令或出栈指令）
    
    4:中断返回： 中断服务程序的最后一条指令通常是返回指令，时原程序的断点处，以便继续执行原程序。
    ⚠️注意：计算机在执行中断的时候，可能会出现新的中断，这时候有两种方：一种对于新的中断不理睬，叫做*单重中断，另一种暂停现在执行的中断，转向新的中断，叫做多重中断*。**这两种中断最大的区别就是开中断的位置的区别**

- 直接存储器存取（DMA）方式：DMA方式不是用软件而是采用一个专门的控制器（相当于一个硬件设备）**来控制内存与外设（硬盘也算）之间的数据交流，无需CPU介入，可大大提高CPU的工作效率。**

  - DMA 工作流程

    - 1.预处理：
      cpu 给 dma 指明传送方向是输入还是输出
      给 DMA 地址寄存送入设备号，启动设备
      向 DMA 主存地址寄存器送入交换数据的主存起始地址
      对计数器赋予交换数据的个数

    - 2.数据传送：以块为单位

    - 3.后处理中断服务程序，做 DMA 结束处理（包括，检验送入主存的数是否正确，决定是否使用 DMA 传送其他数据块，，测试传送过程是否正确）

  - 注意

    - DMA传送虽然脱离CPU的控制，但并不是说DMA传送不需要进行控制和管理。通常是采用DMA控制器来取代CPU，负责DMA传送的全过程控制。**DMA 中的程序中断部件的作用是向 CPU 提出传输结束**
    - DMA是必须利用中断的，否则CPU无法得到数据已经传输结束,当数据传输开始结束的时候,需要给CPU一个中断信号，CPU进行处理.这个就大大的节约了CPU的 资源。

#### 总结

- [中断](https://so.csdn.net/so/search?q=中断&spm=1001.2101.3001.7020)控制方式虽然在某种程度上解决了上述问题，但由于中断次数多，因而CPU仍需要花较多的时间处理中断，而且能够**并行**操作的设备台数也受到中断处理时间的限制，中断次数增多导致数据丢失。

- [DMA](https://so.csdn.net/so/search?q=DMA&spm=1001.2101.3001.7020)方式不需CPU干预传送操作,**仅仅是开始和结尾借用CPU一点时间,其余不占用CPU任何资源**，中断方式是程序切换,每次操作需要保护和恢复现场
- DMA方式和通道方式较好地解决了上述问题。这两种方式采用了外设和内存直接交换数据的方式。只有在一段数据传送结束时，这两种方式才发出中断信号要求CPU做善后处理，从而大大减少了CPU的工作负担。

|          | DMA                                                          | 中断                                                         | 通道                                                         |
| -------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 驱动方式 | 直接存储器存取方式的基本思想是在I/O设备和内存之间开辟直接的数据交换通路，彻底“解放” CPU | 允许I/O设备主动打断CPU的运行并请求服务                       | DMA方式的发展，它可以进一步减少CPU的干预，即把对一个数据块的读（或写）为单位的干预，减少为对一组数据块的读（或写）及有关的控制和管理为单位的干预。 |
| 适用场景 | 不需要CPU干预介入的控制器来控制内存与外设之间的数据交流的场合 I/O通道方式：适用于以字节为单位的干预，同时实现CPU、通道和I/O设备三者并行操作的场合 | 适用于高效场合                                               |                                                              |
| 处理方法 | 获取总线的3种方式分别为:暂停方式、周期窃取方式和共享方式     | 在系统中具有多个中断源的情况下,常用的处理方法有，多中断信号线法.中断软件查询法.雏菊链法、总线仲裁法和中断向量表法 | 通道是一种通过执行通道程序管理I/O操作的控制器,它使主机与1/0操作之间达到更高的并行程度。 |



### 指令

https://blog.csdn.net/helloword111222/article/details/121312837

指令的地址码字段**通常不代表操作数的真实地址**，故把它称为**形式地址，记作A**。操作数的真实地址称为**有效地址，记作EA**，它是由寻址方式和形式地址共同确定的。

格式：操作码    |    寻址特征   |   形式地址A

> 立即数寻址和寄存器寻址在效率上是最快的，但是寄存器数目少，不可能将操作数都存入其中等待使用，立即数的使用场合也非常有限，这样就需要将数据保存在内存中，然后使用直接寻址、寄存器间接寻址、寄存器相对寻址、基址加变址寻址、相对基址及变址寻址等寻址方式将内存中的数据移入寄存器中

#### 种类

##### 立即寻址

立即寻址的特点是**操作数设在指令字内**，即形式地址A不是操作数地址，而是操作数本身，又称为立即数。数据是采用补码存放的。

![img](https://img-blog.csdnimg.cn/c5bcc7bc4d7c4189b9cdab8fc82238a4.png)

优点：是只要取出指令就能立即获得操作数，在执行阶段不必再访问存储器。

缺点：A的位数限制了这类指令所能表达的立即数的范围。

##### 直接寻址

直接寻址的特点是指令中的形式地址A就是操作数的实际地址EA

![img](https://img-blog.csdnimg.cn/670f9542f1594db0a89f47e8f524998f.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5qyi5b-r55qE5bCP5aSq6Ziz,size_13,color_FFFFFF,t_70,g_se,x_16)

**优点：**寻找操作数比较简单，不需要专门计算操作数的地址，在指令执行阶段对主存只访问一次。

**缺点：**A的范围限制了操作数的寻址范围，而且必须修改A的值，才能修改操作数的地址。



##### 间接寻址 

形式地址不直接指出操作数的地址，而是指出操作数有效地址所在的存储单元地址，也就是说有效地址是由形式地址间接提供的，即为间接寻址。

<img src="https://img-blog.csdnimg.cn/eb129beffd5245b5ad3796b51c04156e.jpg?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5qyi5b-r55qE5bCP5aSq6Ziz,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img" style="zoom:50%;" />

**优点：**

1，扩大了操作数的寻址范围。

2，便于编制程序。例如间接寻址可以很方便地完成子程序的返回。如下图

<img src="https://img-blog.csdnimg.cn/ba668c8092bb404299059c3cdf185a01.jpg?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5qyi5b-r55qE5bCP5aSq6Ziz,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img" style="zoom:33%;" />

 **缺点：**是指令在执行阶段需要访问两次内存（一次间接寻址）或多次（多次间接寻址），使执行时间延长。

##### 寄存器寻址

在寄存器的指令中，地址码字段直接指出了寄存器的编号，即EA=Ri.

如下图示：

<img src="https://img-blog.csdnimg.cn/347f1702f756467380a0796f9c1642db.jpg?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5qyi5b-r55qE5bCP5aSq6Ziz,size_10,color_FFFFFF,t_70,g_se,x_16" alt="img" style="zoom:33%;" />

**优点**：操作数不在主存中，而在寄存器中，故寄存器寻址在指令执行阶段无需访存，减少执行时间。地址字段只需指明寄存器编号（寄存器数量有限），故指令字较短，节省了存储空间。



##### 寄存器间接寻址

 寄存器寻址指令中的Ri的内容不是操作数，而是操作数所处在主存单元的地址号，即有效地址EA=(Ri)，与寄存器寻址相比指令的执行阶段还需要访存，但他比间接寻址少访存一次。

 <img src="https://img-blog.csdnimg.cn/e48a1fa87727457a9c850f2b1b2f5589.jpg?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5qyi5b-r55qE5bCP5aSq6Ziz,size_12,color_FFFFFF,t_70,g_se,x_16" alt="img" style="zoom:50%;" />

##### 基址寻址

基址寻址需设基址寄存器BR，其操作数的有效地址EA等于指令字中的形式地址与基址寄存器中的内容相加，即

**EA=A  +（BR）**

<img src="https://img-blog.csdnimg.cn/dc9ee3656c204cab9d623c7fa667b30b.jpg?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5qyi5b-r55qE5bCP5aSq6Ziz,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img" style="zoom: 25%;" />

基址寄存器可采用隐式和显式两种。

```
隐式：在计算机内专门设有一个基址寄存器BR，不必指明该基址寄存器，只需有指令的寻址特征反映出基址寻址即可。

显式：在一组通用寄存器里，由用户明确指出那个寄存器用作基址寄存器，存放基地址。
```

基址寻址主要用于为程序或数据分配存储空间，故基址寄存器的内容通常由操作系统或管理程序确定，在程序的执行过程中其值是不可变的，而指令字中的A是可变的。

优点：基址寻址可以扩大寻址范围，寄存器位数可以大于形式地址A的位数。

##### 变址寻址

变址寻址与基址寻址极为相似，其有效地址EA等于形式地址A与变址寄存器IX的内容相加之和，

即：EA=A+（IX）

<img src="https://img-blog.csdnimg.cn/727e6a984db2483d97f543a0f4e9e2b7.jpg?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5qyi5b-r55qE5bCP5aSq6Ziz,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img" style="zoom:25%;" />

在变址寻址中，变址寄存器的内容是用户设定的，而指令之中的A 是不可改变的。

变址寄存器主要用于处理数组问题，在数组处理过程中可设定A为数组的首地址，不断改变变址寄存器IX的内容，便可容易形成数组中任意数据的地址，特别适合变址循环程序。


##### 相对寻址

相对寻址的有效地址是将程序计数器PC的内容（当前指令的地址）与指令中的形式地址A相加之和，即：EA=（PC）+A

相对寻址常被用于转移类指令，转以后的目标地址与当前指令有一段距离，称为相对位移量，他有指令字的形式地址A给出，故又称A 为位移量。位移量A可正可负，通常用补码表示。 

<img src="https://img-blog.csdnimg.cn/6e68707245fc4ebba88ac0756a19b2ce.jpg?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5qyi5b-r55qE5bCP5aSq6Ziz,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img" style="zoom:25%;" />



#### 指令系统

RISC精简指令集，是计算机中央处理器的一种设计模式。这种设计思路可以想像成是一家**流水线工厂**，对指令数目和寻址方式都做了精简，使其实现更容易，指令并行执行程度更好，编译器的效率更高。

| 指令系统         | 特点                                                         |
| ---------------- | ------------------------------------------------------------ |
| **CISC（复杂）** | 指令复杂，操作种类多，串行顺序执行，主要用于中低端服务器     |
| **RISC（精简）** | 指令格式统一 ，操作种类少，寻址方式简单，处理速度快，通常用于高端服务器和专用计算机系统。 |

RISC和CISC采用流水线技术

~~RISC采用较多的通用寄存器，CISC采用很少的通用寄存器~~

RISC采用组合逻辑控制器，CISC普遍采用微程序控制器

#### 指令系统分类总结

如果按功能分类，STC89C52系列单片机指令系统可分为：

- 1.数据传送类指令；

- 2.算术操作类指令；

- 3.逻辑操作类指令；

- 4.控制转移类指令；

- 5.布尔变量操作类指令。

![image-20230401230745840](img/计算机/计算机基础/image-20230401230745840.png)

![image-20230401230829458](img/计算机/计算机基础/image-20230401230829458.png)

![image-20230401230852761](img/计算机/计算机基础/image-20230401230852761.png)



![image-20230401230917987](img/计算机/计算机基础/image-20230401230917987.png)

### 存储器

计算机存储器分为：寄存器、Cache（高速缓冲存储器）、主存储器（内存）、**辅助存储器（硬盘）。**

#### **分类**

- 计算机系统的存储器按所处的位置：可分为内存和外存。

- 按构成存储器的材料：可分为磁存储器，信半导体存储器和光存储器。

- 按存储器的工作方式：可分为读写存储器和只读存储器。

- 按访问方式可分为

  - 按地址访问的存储器
  - 按内容访问的存储器。
    -  相联存储器是一种按**内容访问**的存储器。

- 按寻址方式：可分为随机存储器、顺序存储器和直接存储器。

#### 读写速度

- 寄存器

- Cache是在计算机存储系统的层次结构中，**介于中央处理器和主存储器之间的高速小容量存储器**。它和主存储器一起构成一级的存储器。高速缓冲存储器和主存储器之间信息的调度和传送**是由硬件**自动进行的，所以其读写速度最快
- 内存速度次之
- 硬盘是有机械装置的存储方式，比较慢，光盘最慢。


#### 外存ROM只读存储器

**掉电数据不丢失，用来放程序**

常见的外存设备：硬盘、flash、rom、u盘、光盘、磁带

##### 闪存

- 闪存是非易失性存储器，断电后数据不会丢失
- 闪存通常用于存储固件和操作系统
- 闪存以块为单位进行擦除和写入操作

##### 磁盘

- RAID 0：将多个较小的磁盘合并成一个大的磁盘，不具有冗余，并行I/O，**速度最快， 磁盘容量利用率最高，可靠性最差**

- RAID 1：两组相同的磁盘系统作镜像，速度没有提高，但是允许单个磁盘出错，**可靠性/安全性最好**，但是其磁盘的利用率却只有50%，**是所有RAID上磁盘利用率最低的一个级别**。

- RAID2：2级廉价冗余磁盘阵列是采用**海明码**作错误检测的 一种磁盘阵列。

- RAID3：存放数据的原理和RAID0、RAID1不同。RAID3是**以一个硬盘来存放数据的奇偶校验位**，**数据分段存储于其余硬盘中**。利用单独的校验盘来保护数据虽然没有镜像的安全性高，但是硬盘利用率得到了很大的提高，为n-1。

- RAID4：4级廉价冗余磁盘阵列是一种可独立地对组内各磁 盘进行读写的磁盘阵列,、该阵列也只用一个检验盘。

- RAID 5：向阵列中的磁盘写数据，**奇偶校验**数据存放在阵列中的各个盘上，允许单个磁盘出错。RAID 5也是以数据的校验位来保证数据的安全，但它不是以单独硬盘来存放数据的校验位，而是**将数据段的校验位交互存放于各个硬盘上**。这样，任何一个硬盘损坏，都可以提供其他硬盘上的校验位来重建损坏的数据。**raid5实际数据存储为n-1块硬盘的容量，至少3块**

- RAID 6存在**两组**独立的分散在不同条带上的校验数据，**允许两块数据盘故障**，并可通过校验数据计算得到故障硬盘中的数据。


>  为保障数据安全，在数据中心本地和异地定时进行数据备份。其中本地备份磁盘陈列要求至少坏2块磁盘而不丢失数据(不计算热备盘)，应采用RAID 6 磁盘冗余方式，因为**与RAID 5相比，RAID 6增加了第二个独立的奇偶校验信息块。**两个独立的奇偶系统使用不同的算法，数据的可靠性非常高，即使两块磁盘同时失效也不会影响数据的使用。

#### 内存/主存RAM

> 内存（RAM随机存储器）又叫内部存储器和**主存储器**，暂时存放数据，掉电数据丢失，常见的内存设备：RAM、DDR

- 它用于暂时存放CPU中的运算数据
- 它是[外存](https://baike.baidu.com/item/外存/2445612?fromModule=lemma_inlink)与[CPU](https://baike.baidu.com/item/CPU/120556?fromModule=lemma_inlink)进行沟通的桥梁。计算机中所有程序的运行都在内存中进行，内存性能的强弱影响计算机整体发挥的水平。只要计算机开始运行，[操作系统](https://baike.baidu.com/item/操作系统/192?fromModule=lemma_inlink)就会把需要运算的数据从内存调到CPU中进行运算，当运算完成，CPU将结果传送出来。

##### 虚拟内存

如果我们运行的程序较多，占用的空间就会超过内存（内存条）容量。例如计算机的内存容量为2G，却运行着10个程序，这10个程序共占用3G的空间，也就意味着需要从硬盘复制 3G 的数据到内存，这显然是不可能的。

操作系统（Operating System，简称 OS）为我们解决了这个问题：当程序运行需要的空间大于内存容量时，会将内存中暂时不用的数据再写回硬盘；需要这些数据时再从硬盘中读取，并将另外一部分不用的数据写入硬盘。这样，硬盘中就会有一部分空间用来存放内存中暂时不用的数据。这一部分空间就叫做虚拟内存（Virtual Memory）。

3G - 2G = 1G，上面的情况需要在硬盘上分配 1G 的虚拟内存。

硬盘的读写速度比内存慢很多，反复交换数据会消耗很多时间，所以如果你的内存太小，会严重影响计算机的运行速度，甚至会出现”卡死“现象，即使CPU强劲，也不会有大的改观。

**总结：CPU直接从内存中读取数据，处理完成后将结果再写入内存。**

![img](http://c.biancheng.net/uploads/allimg/181221/1I05B017-0.png)

##### QQ是怎么运行起来的呢？

首先，有一点你要明确，你安装的QQ软件是保存在硬盘中的。

双击QQ图标，操作系统就会知道你要运行这个软件，它会在硬盘中找到你安装的QQ软件，将数据（安装的软件本质上就是很多数据的集合）复制到内存。对！就是复制到内存！QQ不是在硬盘中运行的，而是在内存中运行的。

为什么呢？因为内存的读写速度比硬盘快很多。

对于读写速度，内存 > 固态硬盘 > 机械硬盘。机械硬盘是靠电机带动盘片转动来读写数据的，而内存条通过电路来读写数据，电机的转速肯定没有电的传输速度（几乎是光速）快。虽然固态硬盘也是通过电路来读写数据，但是因为与内存的控制方式不一样，速度也不及内存。

所以，不管是运行QQ还是编辑Word文档，都是先将硬盘上的数据复制到内存，才能让CPU来处理，这个过程就叫作载入内存（Load into Memory）。完成这个过程需要一个特殊的程序（软件），这个程序就叫做加载器（Loader）。

CPU直接与内存打交道，它会读取内存中的数据进行处理，并将结果保存到内存。如果需要保存到硬盘，才会将内存中的数据复制到硬盘。

例如，打开Word文档，输入一些文字，虽然我们看到的不一样了，但是硬盘中的文档没有改变，新增的文字暂时保存到了内存，Ctrl+S才会保存到硬盘。因为内存断电后会丢失数据，所以如果你编辑完Word文档忘记保存就关机了，那么你将永远无法找回这些内容。



#### Cache存储器和主存映射

> Cache行中的信息是主存中某个块的副本，将内存**以块为单位**调入Cache供**快速访问**。内存的数据将被调入到Cache行的**数据块**中，**Cache用于缓和主存和CPU之间的速度矛盾。**

Cache存储器的组织结构与主存储器不一样，它以行(line)作为基本单元。**每一行又分为标志项和数据域**两部分。数据域中存放着若干项数据，而标志项则是这一块数据的地址标识。

当CPU发出对存储器的读命令后，其访问地址先送给Cache控制器，Cache检查其地址标识符目录以确定是否有匹配项。若发现有匹配项(命中)，则根据其访问地址确定是对该行数据块中的第几项进行读取，然后该项即进入Cache的数据寄存器。如果没有命中，则去主存储器读取数据。这时不仅仅只是读该地址指定的存储单元而且把其**相邻的K-1个单元(K是Cache中一行所能保存的数据单元个数)**的内容都读入Cache中保存。因为根据**局部性原理**，这一块数据很有可能将被CPU访问。同时把指定的存储单元的内容送入CPU。如果Cache存储器已满；还要根据某种淘汰算法从Cache中清除一行以存放该数据块。

**当CPU发出访存请求后，存储器地址先被送到Cache控制器以确定所需数据是否已在 Cache中，若命中(hit)则直接对Cache进行访问。这个过程称为Cache的地址映射(mapping)。为了适应Cache存储器的极高存取速率，映射也必须在极短的时间内完成。Cache存储器的映射机制比较复杂，常见的映射方法有直接映射、相联映射和组相联映射。** 

- 直接映像

  主存与Cache的划分：将主存根据Cache的大小分成若干分区，Cache也分成若干个相等的块

  主存与Cache的映像：主存中的每一个分区由于大小相同，可以与整个Cache相像，其中的每一块正好配对。编号不一致的块是不能相互映像的。

  特点：

  - 优点：地址变换简单。

  - 缺点：每块相互对应，不够灵活。

  主存与Cache的地址组成：

  - 主存地址：区号+块号（cache行号）+块内地址（cache行长）

  - Cache地址：行号+行长

  ![image-20231017174028217](img/计算机/计算机基础/image-20231017174028217.png)

- 全相联映像

  主存与Cache的划分：将主存与Cache划分成若干个大小相等的块。

  主存与Cache的映像：主存中每一块都可以调到Cache中的每一块。

  特点：

  优点：访问灵活，冲突率低，只有Cache满时才会出现在冲突。

  缺点：地址变换比较复杂，速度相对慢。

  主存与Cache的地址组成：

  - 主存：块号+块内地址
  - Cache：块号+块内地址

- 组相联映像

  主存与Cache的划分：

  - 主存：主存根据Cache大小划分成若干个区，每个区内划分成若干个组，每个组再划分成若干个块。
  - Cache：划分成若干个组，每个组划分成若干个块。

  主存与Cache的映像：**主存的每个分区与Cache采用直接映像，主存的每个组之内采用全相联映像**。

  特点：**融合了直接映像与全相联映像两种映像方式，结合了两者的优据点。**具体实现容易，命中率与全相联映像接近。

  主存与Cache的地址组成：

  - 主存：区号+组号+块号+块内地址
  - Cache：组号+块号+块内地址







容量为64块的Cache采用组相联方式映像，字块大小为128个字，每4块为一组。若主存容量为4096块，且以字编址，那么主存地址应为 (30) 位，主存区号应为 (31) 位

组相联的**地址构成为：区号+组号+块号+块内地址。**

**主存的每个分区大小与整个Cache大小相等**，故此主存需要分的区数为：4096/64=64，因为$2^6$＝64，因此需要6位来表示区号。

每4块为一组，故共有组数 64/4 = 16 ，因为$2^4$＝16，因此需要4位表示组号。

每组4块，故表示块号需要2位。

块内地址共128字节，$2^7$＝128，所以块内地需要7位表示。

所以：主存地址的位数＝6+4+2+7 ＝ 19

主存区号的位数＝6

#### 外置存储架构

随着主机、磁盘、网络等技术的发展，对于承载大量数据存储的服务器来说，服务器内置存储空间，或者说内置磁盘往往不足以满足存储需要。因此，在内置存储之外，服务器需要采用外置存储的方式扩展存储空间，今天在这里我们分析一下当前主流的存储架构。

- **DAS（Direct Attached Storage）**，直接连接存储（**直连式存储**）

  意思是存储设备只与一台主机服务器连接，存储设备是通过电缆(通常是**SCSI**接口电缆)直接到服务器的。

- **NAS（Network Attached Storage），网络附加存储**

  NAS是随着网络**文件系统**的出现而出现的，网络文件系统也是OS中的一种文件系统。常使用NFS协议为Linux操作系统提供文件共享服务。

- **SAN（Storage Area Network），存储区域网络**

  前面我们已经得知DAS是通过SCSI接口总线，而SCSI接口有16个节点的限制，不可能接入很多的磁盘。SCSI并行总线结构，传输距离短，是一种宽而短的电缆结构。而**细长的串行的FC是一种可寻址容量大、稳定性强、速度快（1Gbps~8Gbps，现在成熟的技术已经达到上百G）、传输距离远的网络结构**，所以最终替代了SCSI接口和总线

  **替换了原来的并行SCSI通路技术，将一个个磁盘作为网络上的节点，即彻底变成网络化存储系统了**

开放系统的数据存储有多种方式，属于网络化存储的是 （ ） 。nas,san

常见存储连接方式包括直连式存储（DAS）、网络接入存储（NAS）、存储区域网络（SAN）等。文件共享存储的连接方式为（14），备份存储的连接方式为（15）。

- 网络接入存储（NAS）
- 存储区域网络（SAN）

## 操作系统

### 基础

操作系统内核功能通常包含以下几部分： 

- 系统调用接口（System call interface）。 

- 程序管理（Process control）。 

- 内存管理（Memory management）。 

- 文件系统管理（FileSystem management）。 

- 设备驱动（Device driver）。 

**但不包括版本管理。**



PC和服务器端操作系统分类：Windows、Unix、Linux（开源）。

Ubuntu、 CentOS 【都是基于Linux开发】

国产操作系统：UOS、麒麟、中科方德、深度、红旗。【都是基于Linux开发】  

基于Android的移动端开发平台是一个以（）为基础的开源移动设备操作系统。Linux

### 进程与线程

进程是一个正在执行的程序的实例，包括程序计数器、寄存器和程序变量的当前值。

进程有哪些特征？

进程依赖于程序运行而存在，进程是动态的，程序是静态的。

每个进程拥有独立的地址空间，地址空间包括代码区、数据区和堆栈区，进程之间的地址空间是隔离的，互不影响。

线程被设计成进程的一个执行路径，同一个进程中的线程共享进程的资源，因此系统对线程的调度所需的成本远远小于进程。

一个进程可能包含多个线程，但一个线程只能属于一个进程。

**本质区别：进程是操作系统资源分配的基本单位，而线程是处理器任务调度和执行的基本单位。**

![补充02 操作系统_13](img/计算机/计算机网络/补充02 操作系统_13.png)

### 资源互斥

某计算机系统中互斥资源R的可用数为8，系统中有3个进程P1、P2 和P3竞争R，且每个进程都需要i个R，该系统**可能会发生死锁的最小i值**为（  ）。

**利用公式（i-1）* 3+1>R；i每个进程需要的资源，R总共有的资源**     

（i-1）*  3+1>8，得出i最小为4。



> 不发生死锁的资源数R
> M个进程 ，每个进程要N个资源，不发生死锁：R = M ×（N－1）+1

若在系统中有若干个互斥资源R，6个并发进程，每个进程都需要2个资源R，那么使系统**不发生死锁的资源R的最少数目**为  （ ）  。7

**死锁的发生是由于并发进程竞争资源而出现相互等待的现象。**那么如果每个进程需要2个资源的话，即进程必须获得到2个资源才可以顺利的运行。那么在极端的情况下，6个进程每个都只获得了1个资源，这时6个进程都不能运行，而处于等待，这个时候就会等待其它进程释放1个资源，而获取到该释放的资源，才凑齐2个资源，得以运行，那么如果想保证不发生死锁的话，即只要在极端情况下，再多增加一个资源，就可以打破死锁了。6X1+1=7.

### 时间片轮转法

时间片轮转算法的基本思想是，系统将所有的**就绪进程（不是线程）**按先来先服务算法的原则，排成一个队列，每次调度时，系统把[处理机](https://baike.baidu.com/item/处理机)分配给队列首进程，并让其执行一个时间片。当执行的时间片用完时，由一个计时器发出时钟中断请求，调度程序根据这个请求停止该进程的运行，将它送到就绪队列的末尾，再把处理机分给就绪队列中新的队列首进程，同时让它也执行一个时间片。

**主要用于分时系统中的进程调度**。为了实现轮转调度，系统把所有就绪进程按先入先出的原则排成一个队列。新来的进程加到就绪队列末尾。每当执行进程调度时，进程调度程序总是选出就绪队列的队首进程，让它在CPU上运行一个时间片的时间。时间片是一个小的时间单位，通常为10~100ms数量级。当进程用完分给它的时间片后，系统的计时器发出时钟中断，调度程序便停止该进程的运行，把它放入就绪队列的末尾；然后，把CPU分给就绪队列的队首进程，同样也让它运行一个时间片，如此往复。

采用此算法的系统，其程序就绪队列往往按进程到达的时间来排序。进程调度程序总是选择就绪队列中的第一个进程，也就是说按照先来先服务原则调度，但一旦进程占用[处理机](https://baike.baidu.com/item/处理机)则仅使用一个时间片。在使用先一个时间片后，进程还没有完成其运行，它必须释放出处理机给下一个就绪的进程，而被抢占的进程返回到就绪队列的末尾重新排队等待再次运行。



假设某分时系统采用简单时间片轮转法，当系统中的用户数为n,时间片为q时，系统对每个用户的响应时间T=（ ）。

- n*q

## 考点

### 背

> USB是是英文Universal Serial Bus（通用串行总线）的缩写，是一个外部总线标准。
>
> UART（Universal Asynchronous Receiver/Transmitter）通用异步接收/发送装置，是一个并行输入成为串行输出的芯片。
>
> I2C总线由数据线SDA和时钟线SCL两条线构成通信线路，是**串行**通信方式。
>
> PCI是Peripheral Component Interconnect（外设部件互连标准）的缩写，它是个人电脑中使用最为广泛的接口，是**并行**通信方式。
>

下列I/O接口类型中，采用并行总线的是()。C
A.USB
B.UART
C.PCI
D.i2C



增量备份是备份的一个类型，是指在一次全备份或上一次增量备份后，以后每次的备份只需备份与前一次相比增加或者被修改的数据，能节约备份时间。



中断向量可提供中断程序的入口地址



为了便于实现多级中断，使用（ ）来保护断点和现场最有效。堆栈



计算机中CPU的中断响应时间指的是 （）的时间。从发出中断请求到开始进入中断处理程序



CPU响应DMA请求是在一个**总线周期**结束



在程序运行过程中，CPU需要将指令从内存中取出并加以分析和执行。 CPU依据 （） 来区分在内存中以二进制编码形式存放的指令和数据。 **指令周期的不同阶段**



操作系统内核功能通常包含以下几部分：

-  系统调用接口（System call interface）。
-  程序管理（Process control）。
-  内存管理（Memory management）。
-  文件系统管理（FileSystem management）。
-  设备驱动（Device driver）。
-  **但不包括版本管理。**





### 计算

对十进制数47和0.25分别表示为十六进制形式，为（）。

十进制47转二进制为101111，转十六进制，整数从右至左每四位一组，为2F。
十进制0.25转二进制0.01，转十六进制，小数从左至右每四位一组，后面补00，为0.4。



内存按字节编址从A5000H到DCFFFH的区域其存储容量为 224KB

A5000H-DCFFFH+1H =  38FFFH

> 1. 求编码个数时，需要用最大编号减去最小编号，再加一；
> 2. 因为编码时两端都有编码，用最大编码减去最小编码时相当于丢掉了最小编码，所以还需要加回来。



如果主存容量为16M字节，且按**字节**编址，表示该主存地址至少应需要 （ ） 位。

- 24,16M=16 * 1024 * 1024 = 2^24



采用n位补码(包含一个符号位)表示数据，可以直接表示数值(1)。D

（1）A.2n      B.-2n      C.2n-1      D.-2n-1

解析：补码的取值范围：$-2^{n-1} \sim 2^{n-1}-1$

采用n位补码表示数据时，用1位表示数的符号（0为正1为负），其余n-1位表示数值。

2^7=128 (因为有一位是符号为，所以由7位是数 值位），但是机器中是从0开始表示的，所以： 正数是从 +0～+127， 刚好128个数字。 负数是从 -0～-127，刚好128个数字。 但是补码中 +0＝-0 ，所以，-0这个位置可以空 出来， 因此就在负数的区域中多出一位，因此就 把这一位进行平移，由原来的 -0~-127, 变成 -1~ -128，也还是128位。 也就是强制性的把补码的最小负数定义为 -2^7 了。





设X、Y为逻辑变量，与逻辑表达式![img](http://www.cnitpm.com/upload/image/zidongup/20171214113132_9708.png)等价的是（  )。X+Y

<img src="http://pic.cnitpm.com/upload/img2013/2016-09-02/wlgcs-201211-4.jpg" alt="img" style="zoom:150%;" />



若每一条指令都可以分解为取指、分析和执行三步。已知取指时间t取指=5△t，分析时间t分析=2△t，执行时间t执行=5△t。如果按顺序方式从头到尾执行完 500 条指令需 （1） △t。如果按照[执行]k、[分析]k+1、[取指]k+2重叠的流水线方式执行指令，从头到尾执行完 500 条指令需 （2） △t。

- 顺序执行很简单，500*12

- 重叠流水线方式参考下图：

  ![img](http://pic.cnitpm.com/upload/image/20160708/20160708094238_9429.jpg)

  

将一条指令的执行过程分解为取指、分析和执行三步，按照流水方式执行，若取指时间t取指=4△t、分析时间t分析=2△t、执行时间t执行=3△t，则执行完100条指令，需要的时间为（5） △t

假设执行 n 条指令，**使用流水时间最长的乘以 n-1**，再加上一条指令的执行时间，即（ 100-1） ＊4△t +（ 4△t + 2△t + 3△t） =396△t + 9△t ＝ 405△t

### 存储

主存容量和内存地址关系

当计算机的地址总线为32时,也就是说该计算机的寻址范围为2^32,即主存容量为4GB。

计算机可以找到4GB个储存单元，但是一个储存单元到底是8位还是16位还是32位，不一定（不同的计算机定义不同）

八位机一个储存单元就是八位，十六位机就是十六位，32位机就是32位。因为32位机的数据总线是32位的，也就意味着每读取一次，可以获得32位的数据。所以将内存划分成32位为一格一格的比较好。

计算机采用分级存储体系的主要目的是为了解决（ ）的问题。存储容量，成本和速度之间的矛盾

计算机系统的主存主要是由（）构成的。DRAM动态随机存储器

虚拟存储器由主存-辅存两级存储器组成

在程序执行过程中，Cache与主存的地址映像由 （ ） 。硬件自动完成

固态硬盘是没有IDE接口的，常见的有：SATA、PCIe和M.2。



# 计算机网络

## 概念

网络把许多计算机连接在一起，而互联网把许多网络通过路由器连接到一起

### OSI模型

- 某一层所做的改动不会影响到其他的层，利于设计、开发和故障排除。
- 通过定义在模型的每一层实现功能，鼓励产业的标准化。
- 通过网络组件的标准化，允许多个供应商协同进行开发。
- 允许各种类型的网络硬件和软件互相通信，无缝融合。
- 促进网络技术快速迭代，降低成本。

<img src="img/计算机/计算机网络/webp" alt="img" style="zoom: 50%;" />

### 网络协议图

<img src="img/计算机/计算机网络/06大涛网络协议神图.jpg" alt="06大涛网络协议神图" style="zoom:67%;" />

#### 协议端口

- 传输层对应应用层

  - DNS 53(TCP和UDP都可调用)  域名服务

  - TCP上层协议
    - FTP 数据20控制21  文件传输协议（数据/控制端口）
    
    - 22 SSH 安全登录（加密）
    
    - 23Telnet远程登录（明文）
    
    - 邮件
      
      IMAP和POP3的区别是：POP3协议允许电子邮件客户端下载服务器上的邮件，但是在客户端的操作（如移动邮件、标记已读等），不会反馈到服务器上，比如通过客户端收取了邮箱中的3封邮件并移动到其他文件夹，邮箱服务器上的这些邮件是没有同时被移动的。**而IMAP客户端的操作都会反馈到服务器上**，对邮件进行的操作，服务器上的邮件也会做相应的动作。
      
      - 25 SMTP电子邮件传输协议（发送邮件）
      - 110 POP3邮局协议（接收邮件）
      - 143 IMAP交互邮件访问协议
      
    - 80 HΤΤP超文本传输协议
    
    - 443 HTTPS安全网页传输协议（加密）
    
    - 3389 RDP远程桌面
    
  - UDP上层协议
  
    - 67、68   DHCP动态主机配置协议（服务器端/客户端）
  
    - 69ТFTP简单文件传输协议
  
    - 161/162 SNMP简单网络管理协议（客户端/服务器端）
  
      SNMP协议实体发送请求和应答报文的默认端口号是161，SNMP代理发送陷阱报文(**Trap**) 的默认端口号是162。
  
    - 500IKE  Internet 密钥交换协议
  
    - 520 RIP路由协议信息
  
- 网络层对应传输层

  - TCP下层IP协议
    - 1 ICMP Internet控制报文协议
    - 2 IGMP Internet组管理协议
    - 50 ESP 安全封装协议
    - 51 AH 认证头协议
    - x2.5 93
    - 179 BGP边界网关协议
  - UDP下层IP协议
    - 89 OSPF 开放式最短路径优先
    - 124 ISIS 中间系统到中间系统
    - 112 VRRP 虚拟路由冗余协议

#### 传输

> 100BASET ，T表示双线线，F表示光纤，如果有5表示500米

802.3研究**以太网介质访问控制协议CSMA/CD及物理层技术规范。**

- WLAN
  - 802.11研究**无线局域网（WLAN）的介质访问控制协议及物理层技术规范。**
    - 802.11b   2.4GHz  11
    - **802.11a  5.0GHz 54**
    - 802.11g   2.4GHz  54
    - **802.11n   2.4&5  300-600**
    - 802.11ac  5.0GHz  500-1G

- MAN
  - **IEEE802.3ab 千兆以太网** 1000M
    - 1000 base-T：1000BaseT是一种使用**4对5类UTP**作为网络传输介质的千兆以太网技术，最长有效距离与100BaseTX一样可以达到100米。可以采用这种技术在原有的快速以太网系统中实现从100Mb/s~1000Mb/s的平滑升级。与前面介绍的其他3种网络介质不同，**1000BaseT不支持8B/10B编码方案**，需要采用专门的更加先进的编码/译码机制。
  - **IEEE802.3ae 万兆以太网 ** 10G
    - 10GBase-E（Extended）**单模光纤 40km**
  - **IEEE802.3an 万兆以太网 ** 10G
    - 10GBase-T 双绞线 100m

- LAN
  - **IEEE802.3z 千兆以太网**  1000
    - 1000 base-sx标准使用的是波长为850nm的**多模光纤（短波）**，光纤长度可以达到300～**550m**。
    - 1000 base-lx标准使用的是波长为1300nm的**单模/多模光纤（长波）**，光纤长度可以达到5000m；
    - 1000 base-cx标准使用的是屏蔽双绞线**（2对STP）**，双绞线长度可以达到25m；
  - **IEEE802.3u 快速/百兆以太网**  100
    - 100Base-TX **两对五类UTP无屏蔽双绞线  100m**
      - 采用的编码技术为( )。4B/5B
    - 100Base-FX 一对**单模光纤**SMF 40Km
      - **采用的编码技术为( )。4B/5B+NRZI**
    - 100Base-T4四对3类UTP（淘汰）100m
      - **采用的编码技术为( )。8B6T**

### 数据通信流程

**数据通信** `data communication` 是在两台设备之间通过「诸如线缆的某种形式的传输介质」进行的数据交换。

数据通信系统的效率取决于四个关键因素：传递性、准确性、及时性和抖动性。

- 传递性 Delivery 。系统必须将数据传递到正确的目的地。数据必须由而且只能由预定的设备或用户接收。

- 准确性 Accuracy 。系统必须准确地传递数据。在传递过程中发生改变和不正确的数据，都是不可用的。

- 及时性 Timeliness 。系统必须以及时的方式传递数据。传递延误的数据是无用的。就视频和音频数据而言，及时传递意味着在数据产生时就传递数据，所传递数据的顺序和产生时的顺序相同，而且没有明显的延迟。这种传递称为实时传输。

- 抖动性 Jitter 。抖动是指分组到达时间的变化，音频或视频的分组在传递过程中延迟各不相同。

  比如，假定每 30 ms发送一个视频的分组，其中某些分组到达延时 30 ms，而另一些分组延时 40 ms，就引起视频不均匀后果。

#### 组成

![图1.1数据通信的五个组成部分](https://img-blog.csdnimg.cn/2bf8dbb4747d4ddb95aed598259193fd.png)

报文 message 是进行通信的信息（数据），它可以是文本、数字、图片、声音、视频等信息形式。
发送方 sender 是指发送数据报文的设备，它可以是计算机、工作站、手机、摄像机等。
接收方 receiver 是指接收报文的设备，它可以是计算机、工作站、手机、电视等。
传输介质 transmission medium 是报文从发送方到接收方之间所经过的物理通路，它可以是双绞线、同轴电缆 光纤和无线电波。
协议 protocol 是管理数据通信的一组规则，它表示通信设备之间的一组约定。如果没有协议，即使两台设备之间可能是连接的，那也无法通信，就像一个说法语的人无法被一个只说日语的人理解一样。

#### 数据表示

- 文本：在数据通信中，文本表示为位模式，即位 0 00 或 1 11序列。模式中位的数目取决于该文本中的符号数目。每一种位模式称为一种编码 code ，**表示符号的过程称为编码过程**。当前流行的编码系统是统一码 Unicode ，用 32 3232 位表示一个符号或字符，它可表示世界上任何一种语言。几十年前，美国制定的美国信息交换标准代码 American Standard Code for Information Interchange, ASCII 现在是统一码前面的 127 127127 个字符，也称为基本拉丁字符集 Basic Latin 。

- 数字：数字也用位模式表示。但诸如ASCII的编码不是用来表示数字的。数字直接转换为二进制数。原因是简化数字的数学运算。

- 图像：现在，图像 image 也采用位模式表示。就最简单的形式而言，图像被划分成像素（图片的基本元素）矩阵，每个像素是一个小点。像素的多少取决于称为分辨率的因素。例如，一幅图像可以划分成 1000像素或 10000 像素，后一种有更清晰的图像表示（更高分辨率），但需要更多的内存来存储图像。

  将图像划分成像素，对每个像素分配一个位模式。模式的大小和值取决于该图像，就一幅仅由黑白点（例如棋盘）构成的图像而言，1位模式就足以表示一个像素。

  如果像素不是由纯白或纯黑的像素构成，则可通过增加位模式的大小来包含更多的灰度范围。例如，可以采用 2位模式来表示 4个级别的灰度 。 黑像素可以用 00表示，深灰像素用 01 ，浅灰像素用 10，白像素用 11 来表示制。

  有几种方法表示彩色图像：一种方法是每个颜色像素被分解为三原色 three primary colors ：红、绿、蓝 RGB ，然后测量每种色彩的浓度，并为其赋予一种位模式；另一种方法是每个颜色像素被分解为三原色：黄、紫、青 yellow, cyan, and magenta, YCM 。

- 音频 audio ：指录音带、声音广播或音乐等声音的表示。**音频与文本、数字或图像有本质的不同。它是连续的、非离散的**。即使用麦克风将声音或音乐转换成电信号，所产生的也是一个连续的信号。【计算机网络】第二部分 物理层和介质(4) 数字传输和【计算机网络】第二部分 物理层和介质(5) 模拟传输介绍，如何将声音或音乐转换成数字或模拟信号。

- 视频 video ：指录像带、图像或动画的合成，既可以由一个连续实体（如电视摄像机 TV camera）产生，也可以由一组图像或动画合成，这些图像的每一幅都是一个离散的实体，组织起来即可表示运动的意思。正如第4章和第5章所述，同样可以将视频转换为数字或模拟信号。

#### 数据流

<img src="https://img-blog.csdnimg.cn/b460ed62004b4f0eb81e13d131a6f164.png" alt="图1.2 数据流(单工、半双工和全双工)" style="zoom: 67%;" />

#### 网络准则

- 性能
- 可靠性
- 安全性



### 广域网

> *局域网与广域网皆属第1、2层*

常用的广域网包括公用电话交换网（ PSTN）、公用分组交换网（X.25）、数字数据网（DDN）、帧中继（FR）和异步传输模式（ATM）等。

5.6.1 PSTN
　　公共电话交换网（Public Switched Telephone Network，PSTN）是以电路交换技术为基础的用于传输模拟话音的网络。
　　电话网概括起来主要由三个部分组成：本地回路、干线和交换机。其中干线和交换机一般采用数字传输和交换技术，而本地回路（也称用户环路）基本上采用模拟线路。由于PSTN的本地回路是模拟的，因此当两台计算机想通过PSTN传输数据时，中间必须经双方Modem实现计算机数字信号与模拟信号的相互转换。
　　PSTN是一种电路交换的网络，可看作是物理层的一个延伸，在PSTN内部并没有上层协议进行差错控制。在通信双方建立连接后电路交换方式独占一条信道，当通信双方无信息时，该信道也不能被其他用户所利用。
　　用户可以使用普通拨号电话线或租用一条电话专线进行数据传输，使用PSTN实现计算机之间的数据通信是最廉价的，但由于PSTN线路的传输质量较差，而且带宽有限，再加上PSTN交换机没有存储功能，因此PSTN只能用于对通信质量要求不高的场合。目前通过PSTN进行数据通信的最高速率不超过56Kbps。
5.6.2DDN
　　数字数据网（ Digital Data Network，DDN）是一种利用数字信道提供数据通信的传输网，它主要提供点到点及点到多点的数字专线或专网。DDN的传输介质主要有光纤、数字微波、卫星信道等。
　　DDN采用了计算机管理的数字交叉连接（Data CrossConnection，DXC）技术，为用户提供半永久性连接电路，即DDN提供的信道是非交换、用户独占的永久虚电路（PVC）。一旦用户提出申请，网络管理员便可以通过软件命令改变用户专线的路由或专网结构，而无须经过物理线路的改造扩建工程，因此DDN极易根据用户的需要，在约定的时间内接通所需带宽的线路。
　　DDN为用户提供的基本业务是点到点的专线。从用户角度来看，租用一条点到点的专线就是租用了一条高质量、高带宽的数字信道。用户在DDN上租用一条点到点数字专线与租用一条电话专线十分类似。DDN专线与电话专线的区别在于：电话专线是固定的物理连接，而且电话专线是模拟信道，带宽窄、质量差、数据传输率低；而DDN专线是半固定连接，其数据传输率和路由可随时根据需要申请改变。另外， DDN专线是数字信道，其质量高、带宽宽，并且采用热冗余技术，具有路由故障自动迂回功能。
　　线路提供方只提供相应的连接线路，其传输速率在9.6Kbps - 2Mbps之间。
5.6.3ISDN
　　ISDN就是在一个统一的网络系统内传送和处理各种类型的数据，向用户提供多种业务服务，如电话、传真、视频以及数据通信业务等。ISDN网络可以替代整个电话网、数据网以及CATV网，通过ISDN网络可以传送各种类型的信息。与现存的网络相比，它所支持的数据传输率更大，能提供的业务范围也更广。
　　ISDN的目标是为各种数字传输提供标准接口。数字化语音、低速和高速数据、视频、传真和图像能够通过一对普通的铜线、同轴电缆或光纤在ISDN上传送。
　　第一代ISDN称为窄带ISDN（N-ISDN）。它利用64Kbps的信道作为基本交换单位，采用电路交换技术。第二代ISDN称为宽带ISDN（B-ISDN）。它支持更高的数据传输速率，发展趋势是采用报文分组交换技术。
5.6.4X.25
　　X.25是公用数据网上以分组方式工作的数据终端设备DTE和数据电路设备DCE之间的接口。从ISO/OSI体系结构观点看，X.25对应于OSI参考模型底下三层，分别为物理层、数据链路层和网络层。
　　X.25的网络层描述主机与网络之间的相互作用，网络层协议处理诸如分组定义、寻址、流量控制以及拥塞控制等问题。网络层的主要功能是允许用户建立虚电路，然后在已建立的虚电路上发送最大长度为128个字节的数据报文。报文可靠且按顺序到达目的端。X.25网络层采用分组级协议（ Packet level Protocol，PLP）。
　　X.25网络是在物理链路传输质量很差的情况下开发出来的。为了保障数据传输的可靠性，它在每一段链路上都要执行差错校验和出错重传；这种复杂的差错校验机制虽然使它的传输效率受到了限制，但确实为用户数据的安全传输提供了很好的保障。
　　X.25分组交换网可以满足不同速率和不同型号的终端与计算机、计算机与计算机间以及局域网LAN之间的数据通信。X.25网络提供的数据传输率一般为64Kbps。
　　DDN与X.25网的区别。X.25是一个分组交换网， X.25网本身具有3层协议，用呼叫建立临时虚电路。X.25具有协议转换、速度匹配等功能，适合于不同通信规程、不同速率的用户设备之间的相互通信。而DDN是一个全透明的网络，它不具备交换功能，利用DDN的主要方式是定期或不定期地租用专线。从用户所需承担的费用角度看， X.25是按字节收费，而DDN是按固定月租收费。所以DDN适合于需要频繁通信的LAN之间或主机之间的数据通信。DDN网提供的数据传输率一般为2Mbps，最高可达45Mbps甚至更高。
5.6.5ChinaPAC
　　分组交换网的突出优点是可以在一条电路上同时开放多条虚电路，为多个客户同时使用，网络具有动态路由功能和先进的误码检错功能，网络性能较佳。中国公用分组交换数据网（ChinaPAC）是邮电部门经营管理的全国性分组交换数据网
　　ChinaPAC提供两种基本业务：
　　1、交换型虚电路（SVC）
　　客户通信时，通过呼叫建立虚电路，通信结束后释放虚电路。交换型虚电路使用灵活，每次均可以与不同的客户建立通信电路。ChinaPAC可以为一个客户开放多条虚电路。
　　2、永久型虚电路（PVC）
　　永久型虚电路类似于固定专线，在客户申请时提出，电信部门将线路固定接好，客户一开机不需通过呼叫即建立起电路，通信费采用包月方式。该功能适合于点对点固定连接的客户使用。
5.6.6帧中继
　　帧中继（ Frame Relay，FR）技术是由X.25分组交换技术演变而来的。为了提高网络的传输率，帧中继技术省去了X.25分组交换网中的差错控制和流量控制功能，这就意味着帧中继网在传送数据时可以使用更简单的通信协议，而把某些工作留给用户端去完成，这样使得帧中继网的性能优于X.25网，它可以提供1.5Mbps的数据传输率。我们可以把帧中继看作一条虚拟专线。用户可以在两结点之间租用一条永久虚电路并通过该虚电路发送数据帧，其长度可达1600字节。用户也可以在多个结点之间通过租用多条永久虚电路进行通信。
5.6.7 ATM
　　异步传输模式（ Asynchronous Transfer Mode，AT M）为实现高速交换展示了诱人的前景，AT M技术的基本思想是让所有的信息都以一种长度较小且大小固定的信元进行传输。
　　网络在发送数据之前，首先建立数据传输对话，称为虚连接，它的标识符是用来标记每个特定连接的信元。ATM有自己的地址系统，自身不支持IP协议,需要通过地址解析服务器(ARP Server)来实现。建立逻辑IP子网(LIS)的概念来支持IP协议
　　ATM网络的结构与传统的广域网一样，由电缆和交换机构成。ATM网络目前支持的数据传输率主要是155Mbps和622Mbps两种，
5.6.8 SDH
　　SDH传送网的概念最初于1985年由美国贝尔通信研究所提出，称之为同步光网络(Synchronous Optical NETwork .SONET)。它是由一整套分等级的标准传送结构组成的，适用于各种经适配处理的净负荷(即网络节点接口比特流中可用于电信业务的部分)在物理媒质，如光纤、微波、卫星等上进行传送。是对SONET的扩充与修正，可以将不同速率的信号汇接到一个统一的信号中。可以容纳各种速率的业务类型，如FDDI，ATM。
5.6.9 DSL
　　数字用户线路（DSL，Digital subscriber lines）是一种相对比较新的传输技术，它直接对ISDN构成威胁。DSL由于采用了先进的数据调制技术，通过普通的电话线就可以达到非常高的吞吐量。
　　术语x DSL是对所有不同DSL的总称。目前共有七种DSL。比较有名的DSL类型包括：非对称DSL （ADSL ）、高比特率DSL（HDSL），单线DSL（SDSL）以及超高比特率DSL（VDSL）—xDSL中的“x”被各种类型的DSL的第一个字母替换了。它们主要的区别就是体现在信号传输速度和距离的不同以及上行速率和下行速率对称性的不同这两个方面
　　ADSL 在一对铜线上支持上行速率640Kbps到1Mbps，下行速率1Mbps到8Mbps，有效传输距离在3－5公里范围以内；ADSL接入服务能做到较高的性能价格比这一点，与ADSL接入技术较其它接入技术具有其独特的技术优势是分不开的。

　　比起普通拨号 Modem的最高56K速率，以及N-ISDN 128K的速率，ADSL的速率优势是不言而喻的。 与普通拨号 Modem 或ISDN相比， ADSL在同一铜线上分别传送数据和语音信号，数据信号并不通过电话交换机设备，减轻了电话交换机的负载，并且不需要拨号，一直在线，属于专线上网方式。这意味着使用ADSL上网并不需要缴付另外的电话费

#### 公共交换电话网PSTN

在公共交换电话网（Public Switched Telephone Network（PSTN））是**为了语音通信**而建立的网络，从20世纪60年代开始又被**用于数据传输**。

##### DSL

> DSL是介于物理层和数据链路层之间

数字用户线路（Digital Subscriber Line，DSL）是以铜质电话线为传输介质的通信技术组合，采用**频分复用**技术把PSTN线路划分为话音、上行和下行三个独立的信道。允许用户在传统电话线上提供高速的传输，用户计算机借助于DSL调制解调器连接到电话线上，通过DSL连接访问互联网络或者企业网络。 DSL技术存在多种类型，以下是常见的技术类型： 

- ADSL：**非对称DSL**，用户的上下行流量不对称，一般 具有三个信道，分别为1.544-9Mb/s的高速下行信道， 16-640Kb/s的双工信道，64Kb/s的语音信道。 

- SDSL: **对称DSL**，用户的上下行流量对等，最高可以达到 **1.544Mb/s**。 

- HDSL：高比特率DSL，是在两个线对上提供1.544Mb/s或在 三个线对上提供2.048Mb/s**对称**通信的技术， 其最大特点是 可以运行在低质量线路上，最大距离为3700-4600m。 

- VDSL:_甚高比特率DSL，一种快速**非对称**DSL业务，可以 在一对电话线上提供数据和语音业务。




①HDSL中断距离可达3-5KM、传输速率2.048Mbits/s

**②ADSL是一种非对称的DSL技术**

③VDSL是一种非对称的技术，也是DSL中**传输速度最快的技术**

④SDSL：单线路数字用户技术是对称的

⑤RADSL：速率自适应数字用户线技术，是采用非对称技术。



###### ADSL

**下面是家庭用户安装 ADSL 宽带网络时的拓扑结构图，图中左下角的 X 是（）设备，为了建立虚拟拨号线路，在用户终端上应安装（）协议。**
<img src="https://img-blog.csdnimg.cn/2019082720054018.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0VuZGVybWFuX3hpYW9oZWk=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述" style="zoom: 67%;" />
**问题1：**A
A. DSLAM
B. HUB
C. ADSL Modem
D. IP Router
**问题2：**D
A. [ARP](https://so.csdn.net/so/search?q=ARP&spm=1001.2101.3001.7020)
B. HTTP
C. PPTP
D. PPPoE

**解析**：
在 ADSL 宽带拓扑结构中，来自用户线路的流量若要进入 IP 网络，需要在局端经过数字用户线路进入 IP 网络，需要在局端经过数字用户线路接入复用器（DSLAM）设备进行解调，还原成数字信号，再经由宽带接入服务器（BAS）进入到因特网。



ADSL采用的两种接入方式是 （ ） 。**虚拟拨号接入和专线接入**



ADSL用于连接公共交换电话网PSTN，PSTN属于电路交换网，**所以ADSL是电路交换网的一部分。** 



ADSL 采用多路复用技术是（1），最大传输距离可达（2）米。**FDM**,5000



### 网络交换技术

采用交换网络——将多个[计算机网络](https://so.csdn.net/so/search?q=计算机网络&spm=1001.2101.3001.7020)或通信网络相互连接，以实现信息交换和资源共享的技术叫网络互联技术，也即**网络交换技术**。交换网络由一系列互联的节点构成，这些节点称为**交换机** `switch` ，交换机能在链接到交换机的两台或多条设备之间，建立起临时连接（即组建局域网和VLAN）

为什么需要数据交换？

- 如果两台主机需要通信的话，最直接的方法是使用通信链路连接任意一对主机，这会导致 $N^2$ 链路问题，在成本和技术方面都是不可行的；
- 如果将每台主机与一台交换设备相连，这样每台主机仅需要一条链路，交换设备可以实现这些主机之间的数据转发，但局限于网络规模及主机间的距离；
- 为了保证连通性并且适应不同的网络规模，于是将交换设备互连在一起形成交换网络，主机与交换网络中的某台交换设备相连，交换网络负责将数据转发至目的主机。

<img src="img/计算机/计算机网络/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NTgzNDUw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述" style="zoom:50%;" />

### 设备

![image-20240804220401763](img/计算机/计算机通信/image-20240804220401763.png)

#### 物理层

- 中继器【Repeater，也叫放大器】：同一局域网的再生信号；两端口的网段必须同一协议；


- 集线器：同一局域网的再生、放大信号**（多端口的中继器）**；半双工，不能隔离冲突域也不能隔离广播域

<img src="img/计算机/计算机网络/image-20240804222609919.png" alt="image-20240804222609919" style="zoom:50%;" />

集线器的两大问题：

- 产生环路，形成广播风暴，影响通信效率。
- 数据扩散，严重安全威胁。

#### 数据链路层

##### 网桥

网桥和交换机都是第二层转发设备， 即都是根据 数据链路层地址转发 （包括广播） 数据包。二者 的区别是网桥的端口数较少， 一般是用主机插入 多个网卡来连接多个子网， 并通过软件来实现分 组过滤功能。 而交换机通常是采用专门的硬件实现， 端口数较多。由于采用了专用硬件，因此交 换机转发速度更快。 无论网桥或交换机， 一个端 口就是一个冲突域。

##### 交换机

![image-20240807215812687](img/计算机/计算机网络/image-20240807215812687.png)

交换机有多个网络端口，它通过识别**数据帧的目标 MAC 地址**，根据 **MAC 地址表**决定从哪个**端口**发送数据。发现没有匹配的表项，因此将数据帧从除了其入站接口之外的所有接口**泛洪**出去。

![img](img/计算机/计算机网络/v2-2e9606f05c1c778ac23df0ae3ac699ec_720w.webp)

> 交换机是如何添加、更新、删除 MAC 地址表条目的？

在初始状态下，交换机的 MAC 地址表是空的，不包含任何条目。当交换机的某个端口接收到一个数据帧时，它就会将这个数据帧的源 MAC 地址、接收数据帧的端口号作为一个条目保存在自己的 MAC 地址表中，同时在接收到这个数据帧时重置这个条目的老化计时器时间。这就是交换机自动添加 MAC 地址表条目的方式。



![img](https://pic4.zhimg.com/80/v2-94c4fdb3a308f405a7b6cc7d7b02ca33_720w.webp)



在新增这一条 MAC 地址条目后，如果交换机再次从同一个端口收到相同 MAC 地址为源 MAC 地址的数据帧时，交换机就会**更新**这个条目的老化计时器，确保活跃的的条目不会老化。但是如果在老化时间内都没收到匹配这个条目的数据帧，交换机就会将这个老化的条目从自己的 MAC 地址表中**删除**。

![img](https://pic2.zhimg.com/80/v2-182787b10366b2981075f003c4b1f6f1_720w.webp)



还可以手动在交换机的 MAC 地址表中添加**静态条目**。静态添加的 MAC 地址条目优先动态学习的条目进行转发，而且静态条目没有老化时间，会一直保存在交换机的 MAC 地址表中。

> 如何使用 MAC 地址表条目进行转发？

当交换机的某个端口收到一个单播数据帧时，它会查看这个数据帧的二层头部信息，并进行两个操作。

- 一个操作是根据**源 MAC** 地址和端口信息添加或更新 MAC 地址表。

- 另一个操作是查看数据帧的**目的 MAC** 地址，并根据数据帧的目的 MAC 地址查找自己的 MAC 地址表。在查找 MAC 地址表后，交换机会根据查找结果对数据帧进行处理，这里有 3 中情况

  - 交换机没有在 MAC 地址表中找到这个数据帧的目的 MAC 地址，因此交换机不知道自己的端口是否有连接这个 MAC 地址的设备。于是，交换机将这个数据帧从除了接收端口之外的所有端口**泛洪**出去。

  - 交换机的 MAC 地址表中有这个数据帧的目的 MAC 地址，且对应端口不是接收到这个数据帧的端口，交换机知道目的设备连接在哪个端口上，因此交换机会根据 MAC 地址表中的条目将数据帧从对应端口单播**转发**出去，而其它与交换机相连的设备则不会收到这个数据帧。

  - 交换机的 MAC 地址表中有这个数据帧的目的 MAC 地址，且对应端口就是接收到这个数据帧的端口。这种情况下，交换机会认为数据帧的目的地址就在这个端口所连接的范围内，因此目的设备应该已经收到数据帧。这个数据帧与其它端口的设备无关，不会将数据帧从其它端口转发出去。于是，交换机会**丢弃**数据帧。

#### 路由器与三层交换机

![image-20240806224714527](img/计算机/计算机网络/image-20240806224714527.png)

#### 网关

网关是互连网络中操作在OSI**传输层**之上的设施。

网关的主要功能：

（1）连接网络层之上**执行不同协议的子网**，组成异构型的互联网。
（2）网关能对互不兼容的高层协议进行转换。
（3）为了实现异构型设备之间的通信，网关要对不同传输层、会话层、表示层、应用层协议进行翻译和转换。

### 流量控制

> 流量控制：让发送方发送速率不要太快，TCP协议**使用滑动窗口实现流量控制**。

流量控制：协调发送站和接收站工作步调，避免发送速度过快，接收站处理不过来。造成丢包重传，浪费网络资源。

#### 停等协议

工作原理：发送站发一帧，收到应答信号后再发送下一帧，接收站每收到一帧后回送一个应答信号
（ACK），表示愿意接收下一帧，如果接收站不应答，发送站必须等待。
T=Ta发+ Ta传+ Tb发+ Tb传 ≈Ta发+2T传。（因为回应的包大概是64B,可以忽略）

<img src="img/计算机/计算机网络/image-20240728230718679.png" alt="image-20240728230718679" style="zoom:50%;" />

#### 滑动窗口

滑动窗口协议主要思想是：**允许连续发送多个帧而无须等待应答。**

如图假设站A和B通过全双工链路连接，B维持能容纳8个帧的缓冲区（W收=8）。

这样A就可以连续发送8个帧而不必等待应答信号（W发=8）。

<img src="img/计算机/计算机网络/image-20240728231147014.png" alt="image-20240728231147014" style="zoom:50%;" />

![image-20240816143024396](img/计算机/计算机网络/image-20240816143024396.png)



### 拥塞控制

> 拥塞控制目的是防止数据过多注入到网络中导致网络资源（路由器、交换机等）过载。因为拥塞控制涉及网络链路全局，所以属于**全局控制**。控制拥塞使用**拥塞窗口**

拥塞控制主要是四个算法：1）慢启动，2）拥塞避免，3）拥塞发生，4）快速恢复。

- 慢启动：

  所谓慢启动，也就是[TCP连接](https://so.csdn.net/so/search?q=TCP连接&spm=1001.2101.3001.7020)刚建立，一点一点地提速，试探一下网络的承受能力，以免直接扰乱了网络通道的秩序。

  **翻倍增长**

  > 主机甲和主机乙建立一条TCP连接，采用慢启动进行拥塞控制，TCP最大段长度为1000字节。主机甲向主机乙发送第1个段并收到主机乙的确认，确认段中接收窗口大小为3000字节，则此时主机甲可以向主机乙发送的最大字节数是（）字节。2000
  >
  > 甲->乙窗口
  >
  > 1000->3000
  >
  > 2000->3000
  >
  > 4000->3000

- 拥塞避免

  到达阈值时进入【拥塞避免】，变成+1增长；避免窗口增长过快导致窗口拥塞，而是缓慢的增加调整到网络的最佳值

- 拥塞发生

  一般来说，[TCP拥塞控制](https://so.csdn.net/so/search?q=TCP拥塞控制&spm=1001.2101.3001.7020)默认认为网络丢包是由于网络拥塞导致的，所以一般的TCP拥塞控制算法以丢包为网络进入拥塞状态的信号。对于丢包有两种判定方式，一种是超时重传RTO[Retransmission Timeout]超时，另一个是收到三个重复确认ACK。

- 快恢复算法

  【超时】，阈值变为当前cwnd的一半（不能<2）；再从【慢开始】，拥塞窗口从1指数增长。



![img](img/计算机/计算机网络/c3d988070902418d89ba7e7ea623138a.png)

### 拥塞控制与流量控制的区别

流量控制考虑点对点的通信量的流量控制，而拥塞控制考虑整个网络，是全局性的考虑。拥塞控制的方法：慢启动算法+拥塞避免算法。

### 差错控制和重传

检测和纠正传输错误

- 检错码：CRC
- 纠错码：海明码

应付差错的办法

- 直接发送应答

- 默不作声，超时重传

  ARQ(Automatic Repeat reQuest)自动重传协议

  - ARQ协议

    停等ARQ协议是停等流控技术和自动请求重发技术的结合。
    发送站发出一帧后必须等待应答信号，**收到肯定应答信号ACK 后继续发送下一帧；**收到否定应答信号NAK 后重发该帧；若在一定的时间内没有收到应答信号也必须重发。

  - **选择重发ARQ协议 SREJN**

  - **后退N帧ARQ协议 REJN**

    <img src="img/计算机/计算机网络/image-20240728231923629.png" alt="image-20240728231923629" style="zoom:50%;" />



<img src="img/计算机/计算机网络/image-20240728232120404.png" alt="image-20240728232120404" style="zoom:50%;" />

当发送站发送了编号为0、1、2、3、4的5帧时，收到了对方应答帧REJ3，表明需重传编号为3及后续的所有，因此后续3 帧为3、4、5；若收到的对方应答为SREJ3，仅需重传出错的3 即可，故后续3帧为3、5、6。

## 物理层

物理层的作用：连接不同的物理设备，传输**比特流**。该层为上层协议提供了一个传输数据的可靠的物理媒体。简单的说，物理层确保原始的数据可在各种物理媒体上传输。

物理层考虑以下一系列问题：

- 接口与介质的物理特性。物理层定义了设备与传输介质之间的接口特性，也定了传输介质的类型。
- 位的表示。物理层的数据是没有任何解释的位 bit 流（由 0 和 1  所组成的序列）。要进行传输，位必须编码成信号一一电信号或光信号。物理层定义编码 encoding 的类型（如何将 0 和 1 转换成信号）。
- 数据速率。传输速率 transmisson rate ，即每秒发送的位数，也在物理层定义。换言之，物理层也定义一个位持续多长时间。
- 位同步。发送方与接收方不仅使用相同的比特率，还必须位同步。换言之，发送方的时钟与接收方的时钟必须同步。
- 线路配置。物理层涉及设备与介质的连接。在点到点配置中，两个设备通过一条专用链路连接。在多点配置中，许多设备共享一条链路。
- 物理拓扑结构。物理拓扑结构定义如何将设备连接成网络。设备的连接方式可以是网状拓扑结构（每台设备均与其他设备连接）、星型拓扑结构（通过中心设备与其他设备连接）、环状拓扑结构（每台设备与下一台设备连接以组成一个环）和总线拓扑结构（每台设备都在一条公共链路上）。
- 传输方式。物理层也定义两台设备之间的传输方向：单工、半双工和全双工。在单工方式中，只有一个设备能发送，另一个设备只能接收。单工方式是单向通信。在半双工方式中，两台设备都能发送和接收，但不能在同一时刻。在全双工（或双工）方式中，两个设备能在同一时刻发送与接收。

### 数据交换技术

数据交换技术有3种：电路交换、报文交换和分组交换。

- 电路交换：将数据传输分为电路建立、数据传输和电路拆除3个过程。在数据传送之前需建立一条物理通路，在线路被释放之前，该通路将一直被用户完全占有。

  【代表：早期电话】**ADSL用于连接公共交换电话网PSTN，PSTN属于电路交换网，所以ADSL是电路交换网的一部分。数字数据网（DDN）**

- 报文交换：报文从发送方传送到接收方采用存储转发的方式。报文中含有每一个下一跳节点，完整的报文在一个个节点间传送（数据不拆分）

  【代表：早期电报】

- 分组交换：将数据拆分成很小的分组进行传送，包括：数据报和虚电路。
  
  > **分组交换优势**
  >
  > 减小了延迟，提高了吞吐量。分组交换可以按分组纠错，发现错误只需重发出错的分组，通信效率提高。
  
  - 数据报：每个分组被独立地处理，**每个节点根据路由选择算法，被独立送到目的，路径和到达目的顺序都可能不一样**。（IP）
  - 虚电路：在数据传送之前，先建立起一条逻辑上的连接，每个分组都沿着一条路径传输，不会乱序。
  
  【代表：】**X.25分组交换网络，IP电话，帧中继网络FR，ATM**

- **信元交换：信息被分成固定长度53B的信元来传递，按照虚电路的方式进行分组转发。**

  **应用技术：ATM网络**

<img src="img/计算机/计算机网络/7dbd7ca7636b4bbcb92c295b484f555e.png" alt="在这里插入图片描述" style="zoom:50%;" />

### 网络拓扑

**物理拓扑结构** `physical topology` 一词指的是**网络在物理上分布的方式**。两台或更多的设备连接到一条链路，两条或更多的链路组成拓扑结构。**网络拓扑结构**是**所有链路及其互相连接的设备**（通常称为节点）**之间关系的几何表示**。有四种可能的基本拓扑结构：网状、星型、总线和环状

**五种网络拓扑结构**

![image-20240724141603477](img/计算机/计算机网络/image-20240724141603477.png)

- 网状拓扑结构：网络的每台设备之间均有点到点的链路连接，**常用于广域网**。

- 总线型结构：各工作站和服务器均挂在一条总线上，各工作站地位平等，无中心节点控制，公用总线上的信息多以基带形式串行传递，其传递方向总是从发送信息的节点开始向两端扩散，各节点在接受信息时都进行地址检查，看是否与自己的工作站地址相符，相符则接收网上的信息,**多用于同轴电缆架构的以太网**。
- 环型结构：由网络中若干节点通过点到点的链路首尾相连形成一个闭合的环，这种结构使公共传输电缆组成环型连接，数据在环路中沿着一个方向在各个节点间传输，信息从一个节点传到另一个节点，**多用于令牌环网、城域网FDDI网**。
- 星型结构：星型结构是指各工作站以星型方式连接成网。网络有中央节点，其他节点（工作站、服务器）都与中央节点直接相连，这种结构以中央节点为中心，因此又称为集中式网络。
- 树型结构：网络的每台设备之间均有点到点的链路连接，层次级网络，每个节点可能采用其他拓扑结构，比如星型结构。

### 传输介质

#### 同轴电缆

- 基带同轴电缆
- 宽带同轴电缆

1. 物理结构：同轴电缆由中心导体、绝缘层、外导体（屏蔽层）和外护套组成，中心导体和外导体之间通过绝缘层分隔。而光纤由光纤芯和包覆层（包括纤芯外层的护套和包覆层）构成
2. 传输性能：**同轴电缆主要用于传输电信号**，其传输速率一般较低，受制于电信号传输的限制。**光纤则用于传输光信号**，可传输大量的数据，其传输速率远远高于同轴电缆，能够达到几个Gbps甚至更高的速率。
3. 带宽和距离：**同轴电缆的带宽相对较窄，距离相对较短，一般适用于短距离传输需求。而光纤具有较宽的带宽和较长的传输距离，可以在公里级距离内进行高速数据传输。**
4. 抗干扰和安全性：由于同轴电缆的外导体是屏蔽层，能够提供一定程度的抗干扰性能。而光纤由于采用光信号传输，不受电磁干扰影响，具有较好的抗干扰能力。此外，光纤传输还具有较高的安全性，不容易被窃听或干扰。
5. 应用领域：同轴电缆主要用于有线电视、电缆网络、监控系统等场景，而光纤广泛应用于光纤通信、数据中心、广域网、医疗设备、航天航空等领域。

#### 光纤

> 利用光在玻璃或塑料纤维中的全反射原理

光纤传输介质由可以传送光波的**玻璃纤维或透明塑料**制成，**外包一层比玻璃折射率低的材料**。光波在光纤中以什么模式传播，这与芯线和包层的相对折射率、芯线的真径以及工作波长有关

- 多模光纤MMF：多模光纤纤芯的几何尺寸远大于光波波长，进入光纤的光波在两种材料的介面上形成全反射，从而不断地向前传播。 
  - 光波在光导纤维中以**多种模式**传播，不同的传播模式有不同的电磁场分布和不同的传播路径。多模光纤的带宽约为2.5Gbps
  - 多模光纤仅用于较小容量、短距离的光纤传输通信。（便宜）

- 单模光纤SMF： 芯线的直径小到光波波长大小，则光纤就成为波导，光在其中无反射地沿直线传播，很少反射。但是与之配套的光端设备价格较高，单模光纤的带宽超过10Gbps。
  - 光纤只允许一种模式在其中传播
  - 单模光纤具有极宽的带宽，特别适用于大容量，长距离的光纤通信。




**单模光纤比多模光纤的数据速率高，但价格更昂贵。单模光纤传输距离远，而多模光纤传输距离近**光导纤维作为传输介质，其优点是很多的。首先是它具有很高的数据速率、极宽的频带、低误码率和低延迟。典型数据 速率是100 Mb/s，甚至可达1000 Mb/s，而误码率比同轴电缆可低两个数量级，只有10 。其次是光传输不受电磁于扰，不可能被偷听，因而安全和保密性能好。最后，光纤重 量轻、体积小、铺设容易。



光缆
光缆一般由多根光纤和塑料保护套管及塑料外皮构成。通常看到工人敷设的黑色线缆叫做光缆，里面包含了多组光纤。

#### 无源光网络 (PON)

无源光网络 (PON)是一种纯介质网络，避免了外部设备的 电磁于扰和雷电影响， 减少了线路和外部设备的故障率， 提高了系统可靠性，同时节省了维护成本。 分光器就是连接OLT和ONU的无源设备， 它的功能是分发 下行数据，并集中上行数据。分光器带有一个上行光接口， 若干下行光接口,实现**点对多点的通讯（不适用点对点）**。

**上行是TDMA，下行是广播。**

#### 双绞线

双绞线的4、5线对为正极为PD设备供电，7、8线对为负极为PD设备供电，**3、6是用于传输数据的**。

双绞线可按其是否外加金属网丝套的屏蔽层而区分为**屏蔽双绞线（STP）和非屏蔽双绞线（UTP）**。从性价比和可维护性出发，大多数局域网使用非屏蔽双绞线（UTP -Unshielded Twisted pair） 作为布线的传输介质来组网。 UTP网线由一定长度的双绞线和RJ45水晶头组成 

双绞线由8根不同颜色的线分成4对绞合在一起，**成对扭绞的作用是尽可能减少电磁辐射与外部电磁干扰的影响。**

> **网线传输100m**

#### 无线传输介质

无线电波、微波、红外线、激光。

### 网络设备

#### Console接口

Console是典型的配置接口。使用Console线直接连接至计算机的串行接口，利用终端仿真程序或CRT等软件连接到设备进行设备调试。路由器的Console接口多为RJ-45标准（双绞线接口）。

#### RJ-45 接口

RJ-45是一种接口物理规范，也可以称网口，电口。通常使用在双绞线传输的以太网中

> RJ-45端口：这种端口**通过双绞线连接以太网**。
>
> - 10GBase-T的RJ-45端口标识为“ETH”
> - 100Base-TX的RJ-45端口标识为“10/100bTX”。

**百兆用4根，千兆用8根**

网线的线序又分为两种：568A与568B。

-   标准568A线序：1-绿白，2-绿，3-橙白，4-蓝，5-蓝白，6-橙，7-棕白，8-棕；
-   标准568B线序：1-橙白，2-橙，3-绿白，4-蓝，5-蓝白，6-绿，7-棕白，8-棕；

> 直连线，同一根网线的两端使用同样的线序；
>
> 交叉线，同一根网线的两段使用不同的线序。
>
> 即，网线的两端都使用568A或568B的是直连线；网线两端，一端用568A，一端用568B的是交叉线。在实际运用中一般都使用568B，通常认为568B对电磁干扰的屏蔽比较好。

计算机网络中直连电缆和交叉电缆的区别

以太网电缆中，收、发各由一对双绞线承当，对于所连接的两台设备，要做到收发对应才能正常工作。 

> 同种设备用交叉线，异种设备用直连线。

- 普通以太网电缆就是常用的直连线，两头是完全一样的。
  - 一般用于网络设备与终端设备之间的连接（比如交换机与电脑），因为它们的收发定义刚好是反过来的。

- 用于同类设备之间连接（比如电脑连电脑、交换机连交换机等），因为它们的收发定义是相同的，用交叉线使收发对应起来。 不过现在很多设备都有收发自动反转功能，在大多数情况下都可以用直连线。

#### 串行接口

串行接口是一种常用的工业用通信接口，通常使用RS-232规范，如25针连接器（DB-25）、15针连接器（DB-15）和9针连接器（DB-9）



RS-232-C的电气特性采用V.28标准电路，允许的数据速率是  （1）  ，传输距离不大于  （2）  20kb/s,15m

RS-232-C使用9或25针D型连接器

RS-232-C没有正式规定连机器的标准，只有在其附录中建议使用25针的D型连接器，也有很多使用其他连接器，特别是在微型机RS-232-C**串行接口**上，大多使用9针连接器。

#### SFP接口

光纤接口，需要使用光模块进行连接。

#### AUI接口

主要用于远程拨号连接配置。

AUI 端口是一种 D 型 15 针连接器，用在令牌环网或总线型以太网中。路由器经 AUI 端口通过粗同轴电缆收发器连接 10Base-5 网络，也可以通过外接的 AUI-to-RJ-45适配器连接 10Base-T以太网，还可以借助其他类型的适配器实现与10Base-2 细同轴电缆或10Base-F 光缆的连接。AUI 端口如图 10-9 所示，

#### DTE和DCE

https://mp.weixin.qq.com/s?__biz=MjM5NDQ0NjM5Mg==&mid=2650523585&idx=7&sn=3cb7ccc1add7f137c035d26c3763b35f&chksm=be88ca9689ff43803d2720a8bba76945362958a513c8dfbc9031a2d4c8777b9edd68ea42ff2e&scene=27

<img src="img/计算机/计算机网络/image-20240727222143494.png" alt="image-20240727222143494" style="zoom:67%;" />

- DTE:数据终端设备，所有具有作为[二进制](https://so.csdn.net/so/search?q=二进制&spm=1001.2101.3001.7020)数字数据源点或终点能力的单元。就是与我们直接接触的一些设备，如计算机、打印机、传真机等等，我们需要通信的信息都可以通过它转化为数字世界中的01信号。

  - **DTE代表数据终端设备**

    ● DTE作为信息源或信息接收器的设备

    ● DTE与数据的源或目标有关

    ● DTE它产生数据并将其传输到具有基本控制字符的DCE

    ● DTE它通过DCE网络连接

    ● 包括计算机、打印机和路由器等

- DTE产生了包含一定信息的二进制数字数据，但这种数据不适合**直接**在通信双方之间的介质(或网络)上传输，**因此引入了DCE来对二进制数字数据进行调制或转换等工作，使其适于远距离传输**

  DCE：它包括通过网络发送或接收模拟或数字信号形式的数据的任何功能单元。在**物理层，DCE获取DTE生成的数据，将其转换为适当的信号，然后将信号引入电信链路。**

  - **代表数据通信设备**

    ● 用作DTE之间接口的设备

    ● 与数据的通信方面有关

    ● 它将信号转换为适合传输介质的格式，并将其引入网络线路

    **● DCE网络充当两个DTE网络的媒介**

    ● 包括调制解调器、ISDN适配器、网络卡等

#### 高速同步串口

高速同步串口。在路由器与广域网的连接中，应用最多的是高速同步串行口（Synchronous Serial Port），这种端口**用于连接DDN、帧中继、X.25和PSTN等网络**。通过这种端口所连接的网络两端要求同步通信，以很高的速率进行数据传输。

> DDN专线是数字数据专线(Digital Data Network Leased Line)的简称，是利用数字信道提供永久性连接电路，用来传输数据信号的数据传输网。
>
> 能提供高性能的点到点通信；用户通过这条高速的国际互联网通道，可构筑自己的Internet、[E-mail](https://baike.sogou.com/lemma/ShowInnerLink.htm?lemmaId=41786&ss_c=ssc.citiao.link)等应用系统，它是随着数据通信业务的发展而迅速发展起来的一种新型网络。
>
> 它的传输媒介有光纤、数字微波、卫星信道以及用户端可用的普通电缆和双绞线。
>
> 利用数字信道传输数据信号与传统的模拟信道相比，具有传输质量高、速度快、带宽利用率高等一系列的为优点。

#### Console端口

Console端口：Console端口通过专用电缆连接至计算机串行口，利用终端仿真程序对路由器进行本地配置。路由器的Console端口为RJ-45口



## 数据链路层

数据链路层 data link layer 将「物理层对数据不做任何改动的传输通道」变成可靠的链路，这样可以将物理层的数据无差错地传递给上层（网络层）。基本数据单位为**帧**；

### 功能

#### 封装成帧

封装成帧：“帧”是数据链路层数据的基本单位,在数据报添加首部和尾部构成一个帧，**帧最少64**

![图片](https://mmbiz.qpic.cn/mmbiz_png/QqekpIUjYsPnvK8PhW33a8cX6m7O8iatS5GsjuaSqdgs1OfpTOtW1dxYB4G5cuTSWW9klKtCQOFAoicgMceo7pFA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

![图片](https://mmbiz.qpic.cn/mmbiz_png/QqekpIUjYsPnvK8PhW33a8cX6m7O8iatSL5Apq9cibxzMEh1iaYUdnLt4ficSKia5q4hu7OrLTGBAQQAEuJ2hh2le5Q/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

网络层的IP数据报传到数据链路层就成为帧的数据部分，首部和尾部包括许多必要的控制信息和进行帧定界的作用。**为了提高帧的传输效率，应尽量使帧的数据部分长度大于首部和尾部的长度**，而每一种链路层协议也都规定了帧的数据部分上限最大传送单元MTU

**最大传输单元MTU**

最大传输单元MTU(Maximum Transmission Unit)，数据链路层的数据帧不是无限大的，数据帧长度受MTU限制。

**路径MTU:由链路中MTU的最小值决定**

#### 物理寻址

**物理寻址**。如果帧是发送给网络中不同系统，则数据链路层在帧的头部添加发送方的物理地址与接收方的物理地址。如果帧要发往发送方网络之外的系统，那么接收方的地址就是「连接一个网络到下一个网络的设备的地址」。


#### 透明传输

“透明”是指即使**控制字符**在帧数据中，但是要当做不存在去处理。即在控制字符前加上转义字符ESC。![图片](https://mmbiz.qpic.cn/mmbiz_png/QqekpIUjYsPnvK8PhW33a8cX6m7O8iatSIts4DUr0olxbibAaAljneYvLtEh3QymanlbuhVKfpLDUpHkxicns5sbQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

#### 差错监测

由于**信道噪声**等各种原因，帧在传输过程中可能会出现错误。用以使发送方确定接收方是否正确收到由其发送的数据的方法称为差错控制。通常，错误可分为位错和帧错：

- 位错指帧中某些位出现了差错。
- 帧错指帧的丢失、重复或失序等错误

差错检测：奇偶校验码、循环冗余校验码CRC、海明码

- 奇偶校验码
  - 局限性：当出错两位时，检测不到错误。

- 循环冗余检验码：根据传输或保存的数据而产生固定位数校验码。

- 海明码

##### 奇偶校验码

在待发送的数据后面添加1位奇偶校验位，使整个数据(包括所添加的校验位在内)中"1"的个数为奇数(奇校验)或偶数(偶校验)

若有奇数个位发生误码，奇偶性发生变化，可检查出误码；

若有偶数个位发生误码，奇偶性不发生变化，则不能检查出误码

![img](https://img-blog.csdnimg.cn/9bd2f62012674b229a27e11850cdc2e3.png)

##### 循环冗余校验码CRC

收发双方约定好一个生成多项式G(x)；

- 1001多项式为x^3 + x^0

**发送方基于待发送的数据和生成多项式计算出差错检测码(冗余码)**，将其添加到待传输数据的后面一起传输；接收方通过生成多项式来计算收到的数据是否产生了误码

![img](https://img-blog.csdnimg.cn/d87b00cffe674c52970cfeaf62cce102.png)

<img src="https://pic1.zhimg.com/80/v2-b001898a1eba986a956998dd9758a268_1440w.webp" alt="img" style="zoom:50%;" />

- **模二除法**，数据加0后除以多项式G（x），余数为冗余码

  10011的阶r为4，加4个0

![image-20230329230051455](img/计算机/计算机网络/image-20230329230051455.png)

##### 海明码

> 检测和纠正差错的编码方式。
>
> 码距定义为两个码组中对应码位上不同二进制码的个数，则10101和00110的码距为3

原理：是在m个数据位之外加上k个校验位，从而形成一个m+k位的新的码字，使新的码字的码距比较均匀地拉大。**当某一位出错后，就会引起相关的几个校验位的值发生变化，这不但可以发现出错，还能指出是哪一位出错，为进一步自动纠错提供了依据。**

海明不等式：**假设校验位有k位，那么校验码最多有2^k个，显然其中有一个校验码是正确的，那么就能校验出 $2^k-1$个错位。所以，如果能满足一个则n和k的关系必须满足以下关系：** **2^k -1 >= n+k**

<img src="img/计算机/计算机通信/image-20240727170152574.png" alt="image-20240727170152574" style="zoom:50%;" />

第一位为1，因为3，5，7，9，11中只有3个1，为了满足偶校验，第一位为1

第二位为0，因为3，6，7，10，11中有4个1，为了满足偶校验，第二位为0

<img src="img/计算机/计算机网络/image-20240727170740720.png" alt="image-20240727170740720" style="zoom:50%;" />

https://blog.csdn.net/konley233/article/details/108134466

### 局域网和城域网体系架构IEEE

局域网（Local Area Network）：简称LAN，是指在某一区域内由多台计算机，外部设备（例如打印机）互联成的网络，使用广播信道。在这个网络之间，每个设备都可以完成文件管理、资源共享。

- 覆盖的地理范围较小，只在一个相对独立的局部范围内联，如一座或几种的建筑群内

- 使用专门铺设的传输介质（双绞线、同轴电缆）进行联网，数据传输速率高（10Mb/s~10Gb/s）

- 通信延迟时间短，误码率低，可靠性较高

- 各站为平等关系，共享传输信道

- 多采用分布式控制和广播式信道，能进行广播和组播
- **星型和总线形**是局域网最常用的拓扑结构。

**决定局域网的主要要素为：网络拓扑，协议类型与介质访问控制方法**

#### 局域网的分类

- 以太网

- 令牌环网。物理上采用了环形拓扑结构
- FDDI网（Fiber Distributed Data Interface）。物理上采用了双环拓扑结构，逻辑上是环形拓扑结构
- ATM网（Asynchronous Transfer Mode）。较新型的单元交换技术，使用53字节固定长度的单元进行交换
- 无线局域网（Wireless Local Area Network, WLAN）采用了IEEE802.11标准



#### 虚拟局域网vlan

作用：根据管理功能、组织机构或应用类型对交换局域网进行分段而形成的逻辑网络。

- 控制网络流量。一个VLAN 内部的通信（包括广播通信）不会转发到其他VLAN 中去，从而有助于控制广播风暴，**减小冲突域，提高网络带宽的利用率。**
- 提高网络的安全性。可以通过配置VLAN之间的路由来提供广播过滤、安全和流量控制等功能。不同VLAN之间的通信受到限制，**提高了企业网络的安全性。**
- 灵活的网络管理。VLAN机制使得工作组可以**突破地理位置的限制而根据管理功能来划分**。如果根据MAC地址划分VLAN，用户可以在任何地方接入交换网络，实现移动办公。

原理：VLAN是指在一个物理网段内，进行**逻辑的划分**，划分成若干个虚拟局域网（**广播域**）

特性是：**不受物理位置的限制，可以进行灵活的划分**

不同VLAN通信必须经过三层设备：路由器、三层交换机、防火墙等，任何交换端口都可以分配给某个VLAN，属于同一VLAN的所有端口构成一个广播域。相同VLAN内的主机可以相互直接通信，不同VLAN间的主机之间互相访问必须经由路由设备进行转发。广播数据包只可以在本VLAN内进行广播，不能传输到其他VLAN中



##### 交换机VLAN划分

静态划分VLAN：基于交换机端口。

动态划分VLAN：基于MAC地址、基于策略、基于网络层协议、基于网络层地址。

##### VLAN 作用 

(1)控制网络流量。一个 VLAN 内部的通信(包括广播通信)不会转发到其他 VLAN 中去，从而

有助于控制广播风暴，减小冲突域，提是高网络带宽的利用率。 

(2)提高网络的安全性。可以通过配置 VLAN 之间的路由来提供广播过滤、安全和流量控制等

功能。不同 VLAN 之间的通信受到限制，提高了企业网络的安全性。 

(3)灵活的网络管理。VLAN 机制使得工作组可以突破地理位置的限制而根据管理功能来划分。

如果根据 MAC 地址划分 VLAN，用户可以在任何地方接入交换网络，实现移动办公

##### vlan帧结构

**以太网帧长度最大为：1518b**。 **vlan帧会在源mac地址后增加4b的标记字段，长度范围最大为1522b。最小64b** 

其中4字节标记字段包括： 

（1）类型tpid，叫做标记协议id值。占16位，对于以太网，设置为十六进制0x8100。 

（2）**帧优先级PRI**

（3）规范格式标识符cfi：指出mac地址为以太网还是令牌环格式。在以太网交换机中，规范格式指示器总是设置为0。 

（4）vlan id（VID 12位）：即VLAN标识符，最多可以表示2^12=4096个VLAN，其中VID 0用于识别优先级，VID 4095保留未用，所以**最多可配置4094 个VLAN。默认管理VLAN是1，不能删除。**



**VLAN帧的最小帧长是(1)字节，其中表示帧优先级的字段是(2)。 64，PRI**



#### IEEE802标准(背)

> IEEE于1980年2月成立了局域网标准委员会（简称IEEE802委员会），专门从事局域网标准化工作，并制定了IEEE802标准。
>
> 802标准所描述的局域网参考模型只对应OSI参考模型的数据链路层与物理层，它将数据链路层划分为逻辑链路层LLC子层和介质访问控制MAC子层。
>
> **其中IEEE802.2LAN标准定义了逻辑链路控制LLC子层的功能与服务，并且是基标准。**

<img src="img/计算机/计算机网络/image-20240321235829134.png" alt="image-20240321235829134" style="zoom: 50%;" />

IEEE 802委员会的任务是制定局域网和城域网标准，目前有20多个分委员会，如下。

- 802.1研究局域网体系结构、寻址、网络互联和网络管理
  - **IEEE802.1d 冗余链路stp协议**
  - **IEEE802.1W 快速stp协议**
  - **IEEE802.1q 虚拟局域网VLAN**
    - **最多可以配置4049个 VLAN**
    - GVRP协议所支持的VLANID范围为1-4094，而VTP协议只支持1-1001号的VLAN。
  - **IEEE802.1x 认证系统**
  - **IEEE802.1p Qos**
  - **IEEE802.1g 网桥**
- 802.2研究**逻辑链路控制子层（LLC）**的定义。
- 802.3研究**以太网介质访问控制协议CSMA/CD及物理层技术规范。**
- 802.4研究**令牌总线网**（Token-Bus）的介质访问控制协议及物理层技术规范。
- 802.5研究**令牌环网**（Token-Ring）的介质访问控制协议及物理层技术规范。
- 802.6研究城域网介质访问控制协议DQDB及物理层技术规范。
- 802.7宽带技术咨询组，提供有关宽带联网的技术咨询。
- 802.8光纤技术咨询组，提供有关光纤联网的技术咨询。
- 802.9研究综合声音数据的局域网（IVDLAN）介质访问控制协议及物理层技术规范.
- 802.10**局域网安全机制**，网络安全技术咨询组，定义了网络互操作的认证和加密方法。
- 802.11研究**无线局域网（WLAN）的介质访问控制协议及物理层技术规范。**
  
- 802.12研究需求优先的介质访问控制协议（100VG-AnyLAN）。
- 802.14研究采用线缆调制解调器（Cable Modem）的交互式电视介质访问控制协议及物理层技术规范。
- 802.15 研究采用**蓝牙技术**的无线个人网（Wireless Personal Area Network,WPAN)技术规范。
- 802.16 **无线城域网**，宽带无线接入工作组，开发2~66GHz的无线接入系统空中接口。
- 802.17弹性分组环（RPR）工作组，制定了弹性分组环网访问控制协议及有关标准。
- 802.18宽带无线局域网技术咨询组（Radio Regulatory）。
- 802.19多重虚拟局域网共存（Coexistence）技术咨询组。
- 802.20移动宽带无线接入（MBWA)工作组，正在制定宽带无线接入网的解决方案。（20)802.21研究各种无线网络之间的切换问题，正在制定与介质无关的切换业务（MIH)标准。
- 802.22无线区域网（Wireless Regional Area Network，WRAN）工作组，正在制定利用感知无线电技术，在广播电视频段的空白频道进行无干扰无线广播的技术标准。

##### IEEE 802.11

IEEE802.11定义了无线局域网的两种工作模式，其中的  （1）  模式是一种点对点连接的网络，不需要s无线接入点和有线网络的支持。IEEE802.11g的物理层采用了扩频技术，工作在  （2）  频段。AD HOC,2.4GHZ



无线局域网的新标准IEEE802.11n提供的最高数据速率可达到（67）Mb/S。300



在802.11中采用优先级来进行不同业务的区分，优先级最低的是（）。分布式协调功能竞争访问



未在IEEE802.11无线局域网中使用的是 CDMA



802.11g最高速率 54MB/s

802.11n最高速率 300MB/s

### MAC和LLC

> 与物理介质相关的部分叫作介质访问控制（Medium Access Control，MAC）子层，与物理介质无关的部分叫作逻辑链路控制（Logical Link Control，LLC）子层。
>
> - LLC子层负责识别网络层协议，然后进行封装。
> - MAC子层负责把物理层的“0” 、 “1”比特流组建成帧，并通过帧尾部的错误校验信息进行错误校验；提供对共享介质的访问方法。

一、实现不同

1、MAC子层：MAC子层是由网络接口卡（NIC:网卡）来实现。

2、LLC子层：LLC子层是由传输驱动程序实现的。



二、依赖体不同

1、MAC子层：MAC子层依赖于各自的物理层。

2、LLC子层：LLC子层在IEEE802.2标准中定义，为802标准系列共用。



三、主要功能不同

1、MAC子层：MAC子层的的主要功能为数据帧的封装/卸装，帧的寻址和识别，帧的接收与发送，链路的管理，帧的差错控制。MAC子层的存在屏蔽了不同物理链路种类的差异性

2、LLC子层：LLC子层的主要功能为负责识别网络层协议，传输可靠性保障和控制，数据包的分段与重组，数据包的顺序传输。



#### LLC层

**逻辑链路控制**（logical link control，LLC）层位于OSI网络模型的数据链路层，**由IEEE802.2标准定义**，用户的数据链路服务通过LLC子层为上层（IP层）提供统一的接口，提供给其他802协议（e.g. 802.3, 802.11,etc）使用。MAC可以在LLC层的支持下执行寻址方式和网络层协议识别功能，然后进行封装。

LLC定义了三种数据通信操作类型：

- 类型1：无连接。该方式对信息的发送通常无法保证接收。
- 类型2：面向连接。该方式提供了四种服务：连接的建立、确认和承认响应、差错恢复（通过请求重发接收到的错误数据实现）以及**滑动窗口（系数：128）**。通过改变滑动窗口可以提高数据传输速率。
- 类型3：无连接承认响应服务。

#### 介质访问控制MAC层

csma/cd 介质访问控制方法，即冲突检测的载波监听多路访问的方法

##### CSMA/CD

> **IEEE802.3**的MAC子层协议，CSMA/CD用于**总线式以太网，星型和树型拓扑**

CSMA/CD即多路访问/载波监听/碰撞检测

- 多路访问（multiple access)，意思就是以太网络上的各个工作站在发送数据时，共同使用一条总线，且发送数据是广播式的。

- 载波监听（carrier sense），意思就是以太网络上的各个工作站在**发送数据前**，都要监听总线上有没有数据正在传输。若有数据传输 （称总线为忙），则不发送数据，需要等待；若无数据传输（称总线为空），可以立即发送准备好的数据。

  只能减小冲突的概率，不能完全避免冲突。

- 碰撞检测，即边发送边监听，**碰撞检测适配器边发送数据边检测信道上的信号电压变化情况，若发现信号电压变化幅度增大超过某个阈值，则认为发生碰撞**。若没有检测到电压，即信道为“空闲”状态，可以发送数据。若检测到极大或极小的电压，就说明有两个及以上主机的信号发生了碰撞(电磁波相遇)，此时适配器就会立即停止发送。

CSMA基本原理：发送数据之前，先监听信道上是否有人在发送。若有，说明信道正忙，否则说明信道是空闲的，然后根据预定的策略决定：

（1）若信道空闲，是否立即发送。

（2）若信道忙，是否继续监听。

如果连续发生16次碰撞后，认为网络繁忙或故障，不再尝试发送。

##### 监听算法

CSMA/CD是一种介质访问控制的方法， 一般分为3种模式：

（1）1-坚持CSMA：先侦听，有空闲，再发送，如果忙，再监听，有空闲，再发送。信道利用率高，但是冲突率也高。

（2）非坚持CSMA：先侦听，有空闲，再发送，如果忙，不监听，随机等，再监听，有空闲，再发送。信道利用率低，但是冲突率也低。

（3）p-坚持CSMA：先监听，有空闲，p概率发送，1-p概率把数据推迟到下一个时间片，如果有冲突，随机等待一段时间，再检测，空闲再发送。介于前两种检测机制。

如果检测到冲突并发完阻塞信号后，为了降低再次冲突的概率，需要等待一个随机时间，然后使用CSMA方法试图再次传输。

再次发生冲突时概率为2^n（n从1递增），以太网规定最多重传输16次，超过该次数，则不再重传，并报告出错

##### 二进制指数退避算法

二进制指数退避算法工作原理如下：

检测到冲突后，马上停止发送数据，并等待随机时间再发送数据。不是等待信道变为空闲后就立即再发送数据，而是推迟一个随机的时间。这样做是为了使的重传时再次发生冲突的概率减少

- 等待的随机时间=t\*Random[0，1，...2^k-1]

  - 其中Random表示随机函数（每次站点等待的时间都是随机数，故后一次退避时间不一定比前一次长）。
  - 其中t是基本退避时间，可以看作固定值。
  - k=min[重传次数，10]（重传次数不超过10时，但当重传次数超过10时，k就不再增大而一直等于10。）

  根据公式，如果重传12次后，k=min[12，10]=10，那么可能等待的时间是t*Random[0，1023]，一共有1024种可能。

- 当重传次数达**16次**仍不能成功时，则表明网络拥塞或信道故障，以至连续发生冲突，则丢弃该帧，并向高层报告。


<img src="img/计算机/计算机网络/image-20240731221649852.png" alt="image-20240731221649852" style="zoom:50%;" />

##### 最小帧长问题

```
为什么先监听后发数据还是会发生冲突呢？
答：因为电磁波在总线上总是以有限的速率传播的，加上传输数据的信道可能很长(出现传播时延)，因而会发生冲突。
```

最小帧长公式：Lmin=2R x d/v

R为网络数据速率，d为最大距离，为传播速度

不冲突条件：发送时间(L/R)>传送时间(d/v)+确认时间(d/v，因为确认帧只有64b，所以不考虑)

### 协议

#### 异步传输模式ATM

ATM的英文全称为“asynchronous transfer mode”，中文名为“异步传输模式”，它的开发始于70年代后期。ATM是一种较新型的单元交换技术，同[以太网](https://baike.baidu.com/item/以太网/99684?fromModule=lemma_inlink)、[令牌环网](https://baike.baidu.com/item/令牌环网/2076446?fromModule=lemma_inlink)、[FDDI网络](https://baike.baidu.com/item/FDDI网络/22251305?fromModule=lemma_inlink)等使用可变长度包技术不同，ATM使用53[字节](https://baike.baidu.com/item/字节/1096318?fromModule=lemma_inlink)固定长度的单元进行交换。它是一种为了多种业务设计的通用的面向连接的[传输模式](https://baike.baidu.com/item/传输模式/22291422?fromModule=lemma_inlink)。它没有共享介质或包传递带来的延时，非常适合音频和视频数据的传输。



如果网络需求对QoS要求很高，应考虑采用 （ ） 网络。ATM

#### 以太网

以太网。以太网是应用最为广泛的局域网，包括标准以太网（10Mbps）、快速以太网（100Mbps）、千兆以太网（1000Mbps）和10G以太网，它们都符合**IEEE802.3**系列标准规范。

- 以太网第一个广泛部署的高速局域网；


- 以太网数据速率快；


- 以太网硬件价格便宜，网络造价成本低。

- 拓扑结构
  - 逻辑拓扑总线型
  - 物理拓扑是星型或拓展星型

- 特点
  - 造价低廉（以太网网卡不到100块）
  - 是应用最广泛的局域网技术
  - 比令牌环网、ATM网更便宜，简单
  - 满足网络速率要求：10Mb/s~10Gb/s
- 以太网两个标准：
  1. DIX Ethernet V2：第一个局域网产品（以太网）规约
  2. **IEEE 802.3：IEEE 802委员会802.3工作组制定的第一个IEEE的以太网标准。802.3局域网即以太网**

#### 令牌

**在重负载时，令牌环网比以太网的利用率高**，令牌每经过一站，都有数据帧发送，网络充分忙碌。



#### HDLC协议

> 高级数据链路控制（High-Level Data Link Control或简称HDLC），是一个在同步网上传输数据、**面向比特**的[数据链路层](https://so.csdn.net/so/search?q=数据链路层&spm=1001.2101.3001.7020)协议

**HDLC特点**

- **1** HDLC协议不依赖于任何一种字符编码集；

- **2** 数据报文可透明传输，用于实现透明传输的“0比特插入法”易于硬件实现；

- **3**全双工通信，有较高的数据链路传输效率；

- **4**所有帧采用CRC检验，对信息帧进行顺序编号，可防止漏收或重份，传输可靠性高；

- **5**传输控制功能与处理功能分离，具有较大灵活性。

##### 封包格式

HDLC协议的全称是高级链路控制协议（High Level Data Link Control），是一种在网上同步传输数据，面向比特的数据链路层协议，广泛用于公用数据网，支持全双工或半双工传输，使用后退N帧ARQ流控方案。HDLC定义了3种类型的站（主站、从站、复合站），两种链路配置（不平衡配置、平衡配置），3种数据传输方式（NRM、ABM、ARM）

![img](img/计算机/计算机网络/wps1.png)

- **帧标志F：**HDLC用一种特殊的位模式**01111110**作为标志以确定帧的边界，采用位填充技术来区分是标志字段还是数据字段，发送站的数据比特序列一旦发现0后有5个1，则在第7位插入0。

- **地址字段A:**地址字段用于标识从站的地址，用在点对多点的链路中，地址通常是8位长。

- **控制字段C（8位）：**帧编号N(S),捎带的肯定应答序号N(R),PF位，P询问、F终止 

- **帧类型**

  <img src="img/计算机/计算机网络/image-20240730005734400.png" alt="image-20240730005734400" style="zoom:50%;" />

  - I帧：信息帧，第一位为0，**用于承载数据和控制**。

    - **N（S）表示发送帧序号，N（R）表示下一个预期要接收帧的序号**，N（R）=5，表示下一帧要接收5号帧。N（S）和N（R）均为3位二进制编码，可取值**0~7**。

  - S帧：监控帧，前两位为10，监控帧用于**差错控制和流量控制**。

    <img src="img/计算机/计算机网络/image-20240730005751494.png" alt="image-20240730005751494" style="zoom:50%;" />

     **00--接受就绪（RR)**

     **01--拒绝（REJ)**

     **10--接收未就绪（RNR)**

     **11--选择拒绝（SREJ)**

    -  下一个接收的帧编号应为5，但接收器末准备好，暂停接收，对应的是RNR5

    -  **后退N帧重传编号为5的帧，对应的是REJ5**

  - 无编号帧（U帧）：控制字段中不包含编号N（S）和N（R），U帧用于提供**对链路的建立、拆除以及多种控制功能**，但是当要求提供不可靠的无连接服务时，它有时**也可以承载数据。**

  - 比特序号

- **帧校验序列FCS：**含有除标志字段之外的所有其他字段的校验和。

  - 通常使用16比特的**CRC-16**标准产生校验序列

  - 也采用**CRC-32**产生32位的校验序列。

#### PPP

> PPP协议是一种点到点的链路层协议，它提供了点到点的一种封装、传递数据的一种方法。PPP协议一般包括三个协商阶段：**LCP（链路控制协议）阶段**，认证阶段，NCP（网络层控制协议）阶段。拨号后，用户计算机和接入服务器在LCP阶段协商底层链路参数，然后在认证阶段进行用户计算机将用户名和密码发送给接入服务器认证，接入服务器可以进行本地认证，可以通过RADIUS协议将用户名和密码发送给AAA服务器进行认证。认证通过后，在NCP（IPCP）协商阶段，接入服务器给用户计算机分配网络层参数如IP地址等。

PPP可以用于同步传输也可以用于异步传输，而HDLC只能用在同步网上；

PPP是面向字节的，而HDLC是面向比特位的。

可以说**HDLC是PPP的前身**。PPP，可以在多种链路上支持点对点的通信，而且支持多种网络层协议，并且**PPP和以太网相结合产生的PPPoE**

#### vtp协议

> 是VLAN中继协议，也被称为虚拟局域网干道协议。**它是思科私有协议**。作用是十几台交换机在企业网中，配置VLAN工作量大，可以使用VTP协议，把一台交换机配置成VTP Server, 其余交换机配置成VTP Client,这样他们可以自动学习到Server 上的VLAN 信息。

**VLAN中继协议**（VLAN Trunking Protocol，VTP）是Cisco公司的专利协议。VTP在交换网络中建立了多个管理域，同以管理域中的所有交换机共享VLAN信息。一台交换机只能参加一个管理域，不同管理域中的交换机不共享VLAN信息。通过VTP协议，可以在一台交换机上配置所有的VLAN，配置信息**通过VTP报文可以传播到管理域中的所有交换机。**
按照VTP协议，交换机的运行模式分为3种：

- 服务器模式（Server）：交换机在此模式下**创建、添加、删除和修改VLAN配置**，并从中继端口发出VTP组播帧，把配置信息分发到整个管理域中的所有交换机。一个管理域中可以有多个服务器。
- 客户机模式（Client）：在此模式下**不允许**创建、修改或删除VLAN，但**可以监听**本管理域中其他交换机的VTP组播信息，并据此修改自己的VLAN配置。
- 透明模式（Transparent）：在此模式下可以进行VLAN配置，但配置信息不会传播到其他交换机，在透明模式下，可以**接收和转发VTP帧**，但是并不能据此更新自己的VLAN配置，只起到通路的作用。

#### 帧中继协议FR(虚电路)

https://zhuanlan.zhihu.com/p/392346480

**帧中继Frame Relay，简称FR，可以将它看做X.25协议的简化版本**，帧中继可提供面向连接的服务，**帧中继网络中只做检错和拥塞控制，没有流控和重传机制，开销很少，其中的结点只做帧的转发操作**，不需要执行接收确认和请求重发等操作；帧中继是一种严格意义上的二层协议。

在帧中继网络中使用VC（Virtual Circuit，虚电路）来互连各个分支，并不需要两个分支之间有单独的物理链路。

> VC（Virtual Circuit，虚电路）帧中继网络中两台DTE设备之间的连接称为虚电路，现在常用的虚电路为PVC（Permanent Virtual Circuit，永久虚电路），PVC由运营商预先配置。
>
> 帧中继是一种面向连接的技术，在通信之前必须建立连接，DTE之间建立的连接称为虚电路。帧中继虚电路有两种类型：PVC和SVC。
>
> **永久虚电路PVC**：是指给用户提供的固定的虚电路，该虚电路一旦建立，则永久生效，除非管理员手动删除。
>
> PVC一般用于两端之间频繁的、流量稳定的数据传输。目前在帧中继中使用最多的方式是永久虚电路方式
>
> **交换虚电路SVC**：是指通过协议自动分配的虚电路。在通信结束后，该虚电路会被自动取消
>
> 由于帧中继收敛速度慢，链路初始建立时间较长，因此使用的很少。

使用虚电路的最主要好处就是配置方便，建立和拆除虚电路只需要使用命令配置即可，所以虚电路并非真正的物理链路，只是在现有网络的基础上添加的一系列转发规则，就好像在源和目的间存在一条专线一样；相比之下专线则需要综合布线施工，建立和拆除难度较大。

- 工作原理

  帧中继能够在单一物理传输线路上提供多条虚电路，**每条虚电路采用数据链路连接标识符DLCI来进行标识。**

  DLCI只在本地接口和与之直接相连的对端DCE接口有效，不具有全局有效性，实现的是一种逻辑的点到点连接

- 帧中继的工作范围

  在DTE设备和帧中继交换机之间

- 特点

  价格昂贵、传输带宽低、响应速度慢、配置复杂、部署难度大、排错困难；只支持单播流量通行。


![img](img/计算机/计算机网络/v2-a1df47e4b6b01da6d463a5c3fd137d57_1440w.webp)



##### 封包格式

![img](img/计算机/计算机网络/wps255.png)

![img](img/计算机/计算机网络/wps407.png)



- **标志字段：**LAPD的帧头和帧尾都是一个字节的帧标志字段，**编码为01111110，与HDLC一样。**

- 地址字段：

  - EA：地址扩展比特。该比特为0时表示地址向后扩展一个字节，为1时表示最后一个字节。

  - **·C/R：**命令/响应比特。协议本身不使用这个比特，用户可以用这个比特区分不同的帧。
  - **·FECN：**向前拥塞比特。若网络置该位为1，则表示在帧的传送方向上出现了拥塞，该帧到达接收端后，接收方可根据此调整发送方的数据率。
  - **·BECN：**向后拥塞比特。若网络置该位为1，则表示在帧传送相反的方向上出现了拥塞，该帧到达发送端后，发送方可据此调整发送数据速率。
  - **·DE：**优先丢弃比特。当网络发生拥塞时，DE位置1的帧会优先丢弃。
  - **·DLCI：**数据链路连接标识符。帧中继使用虚拟电路的方式提供面向连接的服务，在帧头中包括DLCI字段，每个DLCI都标识一个虚电路，其中DLCI0用于信令传输。
  - **信息字段：**信息字段长度可变，1600是默认最大长度。

- 帧校验序列：与HDLC相同。



**帧中继网络没有采用流量控制机制，只有拥塞控制功能**。采用显式信令控制时，如果LAP-D帧中的FECN比特置1，则表示 （ ） 。

FECN（Forward Explicit Congestion Notification，**前向**显式拥塞通知）：当一台帧中继交换机意识到网络上发生拥塞的时候，会向**目的设备发送FECN分组**，此时FECN比特置为1，告知网络上发生了拥塞。

BECN（Backward Explicit Congestion Notification，后向显式拥塞通知）：当一台帧中继交换机意识到网络上发生拥塞的时候，**会向源路由器发送BECN分组**，此时BECN比特置为 1，指示路由器降低分组的发送速率。如果路由器在当前的时间间隔内接收到任何BECN，它会按照25%的比例降低分组的发送速率。所以A是正确的。

### 以太网帧

![image-20240731224031378](img/计算机/计算机网络/image-20240731224031378.png)

前面7+1字节用于时钟同步，不算入帧长。**以太网帧的长度范围64字节—1518字节**

- 以太网帧中的数据长度范围46-1500, 最大数据部分（MTU）是1500字节，不够填充到46字节。

  数据帧的数据部分最大长度为1500字节。其中IP和TCP头部各占20字节，udp只有8字节

  -  IP数据报中的最大数据部分是1480字节
  -  TCP数据段中的最大数据部分是1460字节


## 网络层

![图片](https://mmbiz.qpic.cn/mmbiz_png/QqekpIUjYsPnvK8PhW33a8cX6m7O8iatSibMOyJ0PXMZKsQ1EXK68yiaFHnWxQsLk9XiciaJDhA5KFV2uic3bSNNU6Vg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

- 基本数据单位为**IP数据报**；
- iP协议（Internet Protocol，因特网互联协议）提供不可靠、无连接的传送服务。
- IP协议的主要功能有：无连接数据报传输、数据报路由选择和差错控制。

### IP协议的转发流程

![图片](https://mmbiz.qpic.cn/mmbiz_png/QqekpIUjYsPnvK8PhW33a8cX6m7O8iatSXCzDk0nQTv7LsiaabCTibVcNXl8P9epXIgps8PVibPt91Uy0UNuacibckA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

### 网络地址转换NAT技术

用于多个主机通过一个公有IP访问访问互联网的私有网络中，减缓了IP地址的消耗，但是增加了网络通信的复杂度。
**NAT工作原理：**从内网出去的IP数据报，将其IP地址替换为NAT服务器拥有的合法的公共IP地址，并将替换关系记录到NAT转换表中；
从公共互联网返回的IP数据报，依据其目的的IP地址检索NAT转换表，并利用检索到的内部私有IP地址替换目的IP地址，然后将IP数据报转发到内部网络。

### ARP协议与RARP协议-**广播**

地址解析协议 ARP（Address Resolution Protocol）：ARP协议建立了主机IP地址和MAC地址的映射关系。**为网卡（网络适配器）的IP地址找到对应的硬件地址提供动态映射**。可以把网络层32位地址映射为数据链路层MAC48位地址。
RARP(Reverse Address Resolution Protocol)协议指**逆地址解析协议**，可以把数据链路层MAC48位地址转化为网络层32位地址。

#### ARP地址解析五步曲

<img src="img/计算机/计算机网络/image-20240809140527389.png" alt="image-20240809140527389" style="zoom: 67%;" />

①主机 A 查询自己的 ARP 缓存（`arp -a`），发现没有主机 B 对应的 MAC 地址 

②主机 A 发送 ARP Request 报文(广播); **arp是封装在以太网帧上的**

③更新本地ARP缓存：主机 B 把主机 A 的 IP、MAC 对应信息填入自己的 ARP 缓存中 

④ARP响应：主机 B 向主机 A 回送包含主机 B 的 MAC 地址的 ARP Reply 报文(单播)

⑤更新本地ARP缓存：主机 A 收到主机 B 的 ARP Replay 报文，将主机 B 的 IP 和 MAC 对应关系填入自己的 ARP 

****

<img src="img/计算机/计算机网络/image-20240809135438929.png" alt="image-20240809135438929" style="zoom: 33%;" />



#### 代理arp

![image-20240812205337797](img/计算机/计算机网络/image-20240812205337797.png)



代理ARP是指（）。由一个路由器**代替远端目标**回答ARP请求

所谓“代理ARP"是指由（）假装目标主机回答源主机的ARP请求。离源主机最近的路由器

#### ARP协议格式

![image-20230321152216876](img/计算机/计算机网络/image-20230321152216876.png)

1.Dest MAC:目的MAC地址 2.Src MAC：源MAC地址 3.帧类型：0x0806 4.硬件类型：1（以太网） 5.协议类型：0x0800（IP地址） 6.硬件地址长度：6 7.协议地址长度：4 8.OP：1（ARP请求），2（ARP应答），3（RARP请求），4（RARP应答）

### IGMP-**组播**

IGMP因特网组管理协议。通过IGMP协议去申请加入或者离开这个组

- 普遍组查询报文（General Query）:组播查询网络上所有主机，路由器，用于了解哪些组播组存在成员。
- 成员报告报文（Report）：主机向查询器发送IGMP报告，申请加组或应答
- 成员离开报文（Leave）：成员离开组播组时主动向查询器发送的报文，宣告自己离开了某个组播组。

### ICMP协议

ICMP（Internet Control Message Protocol）**封装在IP数据报中传输**，是一种面向无连接的协议，是TCP/[IP协议](https://so.csdn.net/so/search?q=IP协议&spm=1001.2101.3001.7020)簇中的一个重要子协议，**传送有关网络层通信问题的信息**。ICMP常见应用有：

- 报告访问失效（报告源主机网络不可达）；
- 报告网络拥塞（**发送源抑制**报文给源主机，降低发送速率）；
- 帮助排错（利用ICMP回声功能，ping工具）；
- 声明报文超时（TraceRoute工具，利用较小的TTL值发现中间设备）。

**ICMP报文封装在IP数据报当中。**

![图片](https://mmbiz.qpic.cn/mmbiz_png/QqekpIUjYsPnvK8PhW33a8cX6m7O8iatSxJ0WwicaX3xAnlFK7U99gr4Zw6z3FtcfLtxIBUBaIDPCeEpZBPfMG4g/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)



ICMP协议的应用

- Ping应用：网络故障的排查；


- Tracert应用： **Tracert程序主要用于查看数据包从源端到目的端的路径信息，从而检查网络连接是否可用**。当网络出现故障时，用户可以使用该命令定位故障点。

  tracert是利用ICMP和TTL进行工作的。首先，tracert会发出TTL为1的ICMP数据包(包含40字节数据，包括源地址、目标地址和发出的时间标签)。当到达路径上的第一个路由器时，路由器会将**TTL减1，**此时TTL为0，该路由器会将此数据包丢弃，并返回一个超时回应数据包(包括数据包的源地址、内容和路由器的IP地址)。当tracert收到该数据包时，它便获得了这个路径上的第一个路由器。接着tracert在发送另一个TTL为2的数据包，第一个路由器会将此数据包转发给第二个路由器，而第二个路由器收到数据包时，TTL为0。第二个路由器便会返回一个超时回应数据包，从而tracert便发现了第二个路由器。tIacert每次发出数据包时便将TTL加1，来发现下一个路由器。这个动作一直重复，直到到达目的地或者确定目标主机不可到达为止。当数据包到达目的地后，目标主机并不会返回超时回应数据包。tracert在发送数据包时，会选择一个一般应用程序不会使用的号码(3000以上)来作为接收端口号，所以当到达目的地后，目标主机会返回一个IcMP port un-reachable(端口不可到达)的消息。当tracert收到这个消息后，就知道目的地已经到达了。
  
  

![image-20240812210211405](img/计算机/计算机网络/image-20240812210211405.png)

### IPV6

#### ipv4和ipv6

- 网络地址短缺：IPv4为32位，只能提供43亿个地址，IPv6为**128位**。
- 地址分配不合理：IPv4中1/3被美国占用，IBM等大型企业地址比很多国家都多。
- 路由速度慢：随着网络规模扩大，**路由表越来越庞大，路由查找速度越来越慢。**
  - IPv4头部多达13个字段IPv6只有8个字段。
- 缺乏安全功能：IPv4没有加密、认证等机制，**IPv6集成IPSec功能**。
- 不支持新的业务模式：IPv4没有扩展字段，**IPv6支持多报头嵌套**。
- IPv6只能由源发节点进行分段，中间路由器不能分段，目的是简化路由处理，MTU发现。

<img src="img/计算机/计算机网络/image-20240818172611604.png" alt="image-20240818172611604" style="zoom:67%;" />

#### 地址压缩方式

IPv6地址128位，采用冒号分隔的十六进制数（8组）表示。中间0可用::压缩；前导0可以压缩；两者可以同时使用；::只能出现一次

- 例：2001:0410:0000:0001:0000:0000:0000:45ff

  可表示为：

  ①2001:0410:0000:0001::45ff------中间0全压缩

  ②2001:410:0:1:0:0:0:45ff--------压缩前导的0 

  ③2001:410:0:1::45ff-------------中间0全压缩和压缩前导0同时使用

- 例如：8000：0000：0000：0000：0123：4567：89AB:CDEF

  以上地址可简写为8000::123:4567:89AB:CDEF

  - 每个字段**前面的0**可以省去，例如0123可以简写为123。

  - 一个或多个全0字段，可以用一对冒号":"代替
  - 有效0位不可以简写，双冒号只能出现一次。



#### ipv6地址分类

- 单播地址：助记 :1 聚2 恋 3 占
  
  - 可聚合**全球单播**地址：这种地址在全球范围内有效，相当于IPv4公用地址**（前缀为001）**。
  - **链路**本地地址：用于同一链路的相邻节点间的通信**（前缀为1111 1110 10）结合MAC地址**自动生成。
  - **站点**本地地址：相当于IPv4 中的私网地址（前缀为1111 1110 11）。
  
- 组播地址
  
  IPv6中没有广播地址，广播功能被组播代替。
  
  **IPv6组播地址的格式前缀为1111 1111，即FF00开头**。
  
- 任意播地址
  表示一组接口的标识符，**通常是路由距离最近的接口。任意播地址不能用作源地址，而只能作为目标地址。**
  任意播地址不能指定给IPv6主机，只能指定给IPv6路由器。

#### IPv4向IPv6过渡技术

IPv4和IPv6的过渡期间，主要采用三种基本技术。

- 双协议栈（dual stack）：主机同时运行IPv4和IPv6两套协议栈，同时支持两套协议

  > 是指在完全过渡到IPv6之前，使一部分主机（或路由器）装有两个协议栈，一个IPv4和一个IPv6。因此双协议栈主机（或路由器）既能够和IPv6的系统通信，又能够和IPv4的系统进行通信。双协议栈的主机（或路由器）记为IPv6/ IPv4，表明它具有两种IP地址：一个IPv6地址和一个IPv4地址。

- 隧道技术（tunneling）：解决IPv6节点之间通过IPv4网络进行通信。

  > 这种方法的要点就是在IPv6数据报要进入IPv4网络时，将IPv6数据报封装成为IPv4数据报（整个的IPv6数据变成了IPv4数据报的数据部分）。然后IPv6数据报就在IPv4网络的隧道中传输。当IPv4的数据报离开IPv4网络中的隧道时再将其数据部分（即原来的IPv6数据报）交给主机的IPv6协议栈。

  自动隧道技术是（）。6to4隧道、6over4隧道和ISATAP隧道

- 翻译NAT-PT：解决纯IPv6节点与纯IPv4节点之间通进行通信。

  > 利用转换网关来在IPv4和IPv6网络之间转换IP报头的地址，同时根据协议不同对分组做相应的语义翻译，从而使**<u>纯</u>IPv4和纯IPv6站点之间能够透明通信。**

### IP报文封装

#### IPV4

<img src="img/计算机/计算机网络/image-20240807220139108.png" alt="image-20240807220139108" style="zoom:67%;" />

**总共2^16=65535=65515+20字节（为啥以太网MTU为1500字节，ip报文比以太网字节大，这里会采用ip分片）**

![image-20231101150844131](img/计算机/计算机网络/image-20231101150844131.png)

- 版本号

  0100=ipv4 0110=ipv6

- 首部长度（网际报头长度IHL）

  **以4字节为单位，最小值5（20Byte），最大值15（60Byte）**。这个字段所表示数的单位是 32 位字长（1 个 32 位字长是 4 字节）。因此，当 IP 的首部长度为 1111 时（即十进制的 15），首部长度就达到 60 字节。当 IP 分组的首部长度不是 4 字节的整数倍时，必须利用最后的填充字段加以填充。

- **生存时间（TTL）**：用于设置一个数据包可经过的路由器数量的上限，每经过一台路由器减1。

- 协议字段：包含一个数字，标识数据报有效载荷部分的数据类型。**最常用的值为1（ICMP）17（UDP）和6（TCP）**





#### IPv6报文格式

![在这里插入图片描述](https://img-blog.csdnimg.cn/fd754855a51d407db662a459f9e1ef42.png)

- **基本首部长度是40字节**

- 扩展首部

  默认第一个是逐条选项

  <img src="img/计算机/计算机网络/image-20240817223311453.png" alt="image-20240817223311453" style="zoom: 50%;" />

 

**IPv6数据报的格式**

![image-20231101150752100](img/计算机/计算机网络/image-20231101150752100.png)



### IPV4-IP分片

IP报文最大65535字节，而以太网MTU为1500字节。
相当于货轮能载重65535，而火车载重1500，那么必须把货轮上的货物分装给多个火车运输。

<img src="img/计算机/计算机网络/image-20240808225909799.png" alt="image-20240808225909799" style="zoom:67%;" />

<img src="img/计算机/计算机网络/image-20240808230310576.png" alt="image-20240808230310576" style="zoom:50%;" />

## 传输层

- 负责向两台主机**进程之间**的通信提供通用的数据传输服务
- 数据单元称为**段或报文**

![图片](https://mmbiz.qpic.cn/mmbiz_png/QqekpIUjYsPnvK8PhW33a8cX6m7O8iatSbbZ8zclxaPPdk7VzOOebRMlEcOIBmibIlRrRZeUtJVmClhz8yDXmuGg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)![图片](https://mmbiz.qpic.cn/mmbiz_png/QqekpIUjYsPnvK8PhW33a8cX6m7O8iatShJAYqYSYwSriaR8UAJzqSDwwFDeHg8XccGvmQk7KLGJzX5TEKoKRicDg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

### TCP

TCP(Transmission Control Protocol: 传输控制协议)，是计算机网络中非常复杂的一个协议。

![图片](https://mmbiz.qpic.cn/mmbiz_png/QqekpIUjYsPnvK8PhW33a8cX6m7O8iatSM15YwnRuWpq4lDQ9aP9laSQ5UcMLn1q97bLUSibiaJEGMrFVlxAg0SKw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

#### TCP协议的特点

TCP是面向连接的协议,一个连接有两端，即点对点通信；；

TCP是面向字节流的协议；

TCP提供可靠的传输服务；

TCP协议提供全双工通信（**每条TCP连接只能一对一**）。

流控及窗口机制

#### TCP协议的功能


- 实现端到端的**流量控制**


- **拥塞控制**
- **重传机制**


- 对收到的报文进行差错检测（首部和数据部分都检错）；

https://blog.csdn.net/zhb523zhang/article/details/126817979

##### 可靠传输

**基本原理：**

不可靠传输信道在数据传输中可能发生的情况：比特差错、乱序、重传、丢失；

基于不可靠信道实现可靠数据传输采取的措施。

- 差错检测：利用编码实现数据包传输过程中的比特差错检测。
- 确认：接收方向发送方反馈接收状态。
- 重传：发送方重新发送接收方没有正确接收的数据。 
- 序号：确保数据按序提交。 
- 计时器：解决数据丢失问题。
- 停止等待协议：是最简单的可靠传输协议，但是该协议对信道的利用率不高。
- 连续ARQ(Automatic Repeat reQuest：自动重传请求)协议：滑动窗口+累计确认，大幅提高了信道的利用率。

**TCP协议的可靠传输：**

基于连续ARQ协议，在某些情况下，重传的效率并不高，会重复传输部分已经成功接收的字节。



#### 通信流程

##### 名词解释

![640](./img/计算机/计算机网络/640.png)

- SYN 同步号，连接请求/接收报文段。**TCP建立连接时将这个置1，连接成功后就不用传了**

- seq 发送的第一个字节的序号

- ACK 确认号， 用它来告诉发送端这个序列号之前的数据段都收到了。

- ack：确认序列号，希望收到的下一个数据的第一个字节的序号。比如确认号为X，则表示前X-1个数据段都收到了，只有当ACK=1时,确认号才有效，当ACK=0时，确认号无效，这时会要求重传数据，保证数据的完整性。

- FIN 发送端完成发送任务位，当TCP完成数据传输需要断开时,提出断开连接的一方将这位置1。
- rst：在建立tcp连接过程中，**出现错误连接时，rst标志字段置1** 

**RST表示拒绝连接，FIN表示释放连接。**

##### 三次握手

![d5b2eba7e0eb4de0b2a6f4a7b6ba4595](./img/计算机/计算机网络/d5b2eba7e0eb4de0b2a6f4a7b6ba4595.png)

同步SYN：在连接建立时同步需要。SYN=1，ACK=0，表明是连接请求，如果SYN=1，ACK=1，表示同意建立连接。

- 第一次握手：客户向服务器发送连接请求段
  - SYN=1，**ACK=0**表示该报文段为连接请求报文
  - seq=x表示客户端传输的报文段的第一个数据字节的序列号是x，此序列号代表整个报文段的序号；
  - 客户端进入 **SYN_SEND （同步发送状态）**
- 第二次握手：服务器发回确认报文段
  - SYN=1，ACK=1表示该报文段为连接同意的应答报文
  - seq=y表示服务端作为发送者时，发送字节流中的第一个字节序号；
  - ack=x+1表示服务端希望客户端发送的下一个数据报初始序号是从x+1开始
  - 服务器由LISTEN进入**SYN_RCVD （同步收到状态）;**
- 第三次握手：客户对服务器的连接进行确认。
  - ACK=1确认序号字段有效
  - seq=x+1表示传输的报文段的第一个数据字节的序列号是x+1
  - ack=y+1表示客户端作为发送者时希望服务端发送的下一个数据报初始序号是从y+1开始
  - 客户端进入**ESTABLISHED** 状态;当服务收到客户发送的ack后，也进入ESTABLISHED状态;第三次握手可携带数据。

**3次握手的特点**
没有应用层的数据 ,SYN这个标志位只有在TCP建立连接时才会被置1 ,握手完成后SYN标志位被置0。

##### 4次挥手

![img](img/计算机/计算机网络/v2-27a1dae8b0d45a61542f9e99164ad968_720w.webp)

**1、第一次挥手：向服务端发送连接中断请求**

 客户端发送一个 FIN 报文（请求连接终止：FIN = 1），报文中会指定一个序列号 seq = u。并停止再发送数据，主动关闭 TCP 连接。此时客户端进入 FIN_WAIT_1 状态，等待服务端的确认。

 **FIN=1表示该报文段是一个连接释放请求**

 **seq=u，u-1是客户端向服务端发送的最后一个字节的序号**

**2、第二次挥手：向客户端发送确认接收到中断请求报文**

 服务端收到 FIN 之后，会发送 ACK 报文，且把客户端的序号值 +1 作为 ack报文的序列号值，**表明已经收到客户端的报文了**，此时服务端进入 CLOSE_WAIT状态。

 **ACK=1：除TCP连接请求报文段以外，TCP通信过程中所有数据报的ACK都为1，表示应答**

 **seq=v，v是服务端释放应答报文段第一个字节序号**

 **ack=u+1表示希望收到从第u+1个字节开始的报文段，并且已经成功接收了前u个字节**

第二次挥手完成后，客户端到服务端方向的连接已经释放，服务端不会再接收客户端的数据，客户端也没有数据要发送了。**但服务端到客户端方向的连接仍然存在**，服务器若发送数据，客户端依然要接受。这个状态还要持续一段时间，也就是整个CLOSE-WAIT状态持续的时间。

**3、第三次挥手：向客户端发送连接释放报文**

**服务端将最后的数据发送完毕后，就向客户端发送连接释放报文**，其报文头包含：FIN=1，ack=u+1，由于在CLOS-WAIT状态，服务端很可能又发送了一些数据，假定此时的序列号为seq=w，此时，服务器进入LAST-ACK状态。

**4、第四次挥手：向服务端发送确认接收到连接中断请求**

 客户端收到 FIN 之后，一样发送一个 ACK 报文作为应答（ack = w+1），且把服务端的序列值 +1 作为自己 ack报文的序号值（seq=u+1），此时客户端进入TIME_WAIT状态。

该状态会持续2MSL（最长报文段寿命）时间，这个期间TCP连接还未释放，若该时间段内没有服务端的重发请求的话，客户端就进入CLOSED状态，撤销TCP。

服务端只要收到了客户端发出的确认，立即进入CLOSED状态。同样，撤销TCB后，就结束了这次的TCP连接。可以看到，服务器结束TCP连接的时间要比客户端早一些。

#### **TCP报文段结构**

最大报文段长度：报文段中封装的应用层数据的最大长度。
![image-20240812211541386](img/计算机/计算机网络/image-20240812211541386.png)
**TCP首部：TCP段的首部长度最短是20B ，最长为60字节。但是长度必须为4B的整数倍。**

**TCP标记的作用：**

![图片](img/计算机/计算机网络/640)

### UDP

UDP(User Datagram Protocol: 用户数据报协议)

![图片](https://mmbiz.qpic.cn/mmbiz_png/QqekpIUjYsPnvK8PhW33a8cX6m7O8iatSD31ib9SYBwTtY6fNjV65tGISicIsb97VApKrtd4zSPlo9ecOO0KWibPicQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

**UDP协议的特点：**

- UDP是无连接协议；

- UDP不能保证可靠的交付数据；

- UDP是面向报文传输的；

- **UDP没有拥塞控制，流量控制；**

- **UDP首部开销很小，8个字节**。





### 区别

- **TCP是面向连接的、可靠的、基于字节流**的传输层协议；**UDP是一个面向无连接**的传输层协议，即发送数据前不需要先建立链接。
- **可靠性：TCP是基于连接的，无差错，不丢失，不重复，且按序到达，可靠性高**（TCP的可靠体现在TCP在传递数据之前，会有三次握手来建立连接，而且在数据传递时，有确认、窗口、重传、拥塞控制机制，在数据传完后，还会断开连接用来节约系统资源）；**UDP是基于无连接的，尽最大努力交付，即不保证可靠交付，可靠性较低**；
- **安全性：**由于TCP是连接的通信，需要有三次握手、重新确认等连接过程，会有延时，实时性差，由于协议所致，安全性较高；而UDP无连接，无建立连接的过程，因而实时性较强，安全略差；**如果对实时性要求高和高速传输的场景下需要使用UDP；如果需要传输大量数据且对数据可靠性要求高的场景使用TCP；**
- **开销方面：**在传输相同大小的数据时，**TCP首部开销20字节；UDP首部开销只有8个字节**，TCP报头比UDP复杂，故实际包含的用户数据较少。TCP无丢包，而UDP有丢包，故TCP开销大，UDP开销较小；
- **连接数：**每条tcp连接只能是点到点的；udp支持一对一、一对多、多对一、多对多的交互通信。

## 应用层

- **应用层：直接面向用户和应用程序，提供文件下载、电子邮件等方面的服务。**

- **表示层：提供数据格式翻译、数据加密与解密、数据压缩与解压缩的服务。**

- **会话层：提供增强会话服务。**

应用层(application-layer）**为用户**提供各种服务，例如文件传输、网络管理等，甚至包括路由选择。应用层协议定义的是应用进程（进程：主机中正在运行的程序）间的通信和交互的规则。

数据传输基本单位为报文

应用层包括:

- **FTP（文件传输协议、File Transfer Protocol）**

是用于文件传输的Internet标准。FTP支持一些文本文件（例如ASCII、二进制等等）和面向字节流的文件结构。

FTP使用传输层协议TCP在支持FTP的终端系统间执行文件传输，因此，FTP被认为提供了可靠的面向连接的服务，

适合于远距离、可靠性较差线路上的文件传输。

- **TFTP（Trivial File Transfer Protocol，简单文件传输协议）**

是用于文件传输，但TFTP使用UDP提供服务，被认为是不可靠的，无连接的。TFTP通常用于可靠的局域网内部的文件传输。

- **SMTP（Simple Mail Transfer Protocol。简单邮件传输协议）**

支持文本邮件的Internet传输。

- **Telnet**

客户机使用的与远端服务器建立连接的标准终端仿真协议。

- **SNMP（Simple Network Management Protocol。简单网络管理协议）**

负责网络设备监控和维护，支持安全管理、性能管理等。

- **DCAP（Data Link Switching Client Access Protocol数据转接客户访问协议）**

用于在工作站与路由器之间的TCP会话上传输SNA/NetBIOS通信。

- **Ping命令**

一个诊断网络设备是否正确连接的有效工具。

- **Tracert命令**

和Ping命令类似，Tracert命令可以显示数据包经过的每一台网络设备信息，是一个很好的诊断命令。

- **DNS（Domain Name System，域名系统）**

把网络节点的易于记忆的名字转化为网络地址。

### DHCP

Dynamic Configuration Protocol动态主机设置协议：是应用UDP协议的应用层协议。

**作用：为临时接入局域网的用户自动分配IP地址。**

DHCP有三种机制分配IP地址：

```
1) 自动分配方式(Automatic Allocation)，DHCP服务器为主机指定一个永久性的IP地址，一旦DHCP客户端第一次成功从DHCP服务器端租用到IP地址后，就可以永久性的使用该地址。
2) 动态分配方式(Dynamic Allocation)，DHCP服务器给主机指定一个具有时间限制的IP地址，时间到期或主机明确表示放弃该地址时，该地址可以被其他主机使用。
3) 手工分配方式(Manual Allocation)，客户端的IP地址是由网络管理员指定的，DHCP服务器只是将指定的IP地址告诉客户端主机。
```

Discover广播报文源目地址和端口是0.0.0.0：68-> 255.255.255.255：67

<img src="img/计算机/计算机网络/image-20230521095541370.png" alt="image-20230521095541370" style="zoom:67%;" />

<img src="img/计算机/计算机网络/image-20230521095904408.png" alt="image-20230521095904408" style="zoom:67%;" />

- 50%：DHCP客户端和DHCP服务器将更新租约
- 87.5%：在50%租期时客户端未得到原服务器端的回应，则客户端在87.5%租期时会停止租约，并**广播**发送DHCP Request，任意一台DHCP服务器端都可回应，该过程称为重绑定。
- 100%租期，重新DHCP Discover。

dhcp服务器的租约默认的有线网络8天，无线网络8小时（datacenter版为6小时）

> 当**DHCP客户机**第一次登录网络的时候（也就是客户机上没有任何IP地址数据时），它会通过**UDP 67端口**向网络上发出一个**DHCPDISCOVER**数据包（包中包含客户机的MAC地址和计算机名等信息）。因为客户机还不知道自己属于哪一个网络，所以**封包的源地址为0.0.0.0，目标地址为255.255.255.255**，然后再附上DHCP discover的信息，向网络进行广播。
>
> DHCP discover的等待时间预设为1秒，也就是当客户机将第一个DHCP discover封包送出去之后，在1秒之内没有得到回应的话，就会进行第二次DHCP discover广播。若一直没有得到回应，客户机会将这一广播包重新发送四次（以2，4，8，16秒为间隔，加上1-1000毫秒之间随机长度的时间）。**如果都没有得到DHCP服务器端的回应**，客户机会从**169.254.0.0/16**这个自动保留的私有IP地址中选用一个IP地址，并且每隔5分钟重新广播一次，如果收到某个服务器的响应，则继续IP租用过程。



##### DHCP中继

HCP Relay即DHCP中继，它是为解决DHCP服务器和DHCP客户端不在同一个广播域而提出的，提供了对DHCP广播报的中继转发功能，能够把DHCP客户端的广播报文“透明地”传送到其它广播域的DHCP服务器上，同样也能够把DHCP务器端的应答报文“透明地”传送到其它广播域的DHCP客户端。

配置

[R2-GigabitEthernet0/0/0] DHCP select relay
[R2-GigabitEthernet0/0/0] DHCP relay server-select HW 指定DHCP服务器

### HTTP

HTTP协议是Hyper Text Transfer Protocol（超文本传输协议）的缩写,是用于从万维网（WWW:World Wide Web ）服务器传输超文本到本地浏览器的传送协议。。
HTTP是一个基于TCP/IP通信协议来传递数据（HTML 文件, 图片文件, 查询结果等）。

HTTP三点注意事项：

- HTTP是无连接：无连接的含义是限制每次连接只处理一个请求。服务器处理完客户的请求，并收到客户的应答后，即断开连接。采用这种方式可以节省传输时间。
- HTTP是媒体独立的：这意味着，只要客户端和服务器知道如何处理的数据内容，任何类型的数据都可以通过HTTP发送。客户端以及服务器指定使用适合的MIME-type内容类型。
- HTTP是无状态：HTTP协议是无状态协议。无状态是指协议对于事务处理没有记忆能力。缺少状态意味着如果后续处理需要前面的信息，则它必须重传，这样可能导致每次连接传送的数据量增大。另一方面，在服务器不需要先前信息时它的应答就较快。无状态协议，即：服务器不需要知道客户端是谁,只认请求（一次请求request,一次相应response）

![img](https://img-blog.csdn.net/20140610210038140?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvamF2YW5kcm9pZA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)

![img](https://img-blog.csdnimg.cn/2019022420515851.png)

#### HTTP请求响应报文

HTTP 请求报文由3部分组成(请求行+请求头+请求体)

<img src="https://upload-images.jianshu.io/upload_images/12603307-27e3bf8fde18f443.png?imageMogr2/auto-orient/strip|imageView2/2/w/897/format/webp" alt="img" style="zoom:50%;" />



响应报文与请求报文一样,由三个部分组成(响应行,响应头,响应体)

<img src="https://upload-images.jianshu.io/upload_images/12603307-cf75b41f632499a3.png?imageMogr2/auto-orient/strip|imageView2/2/w/629/format/webp" alt="img" style="zoom: 67%;" />



#### 状态码

- 1XX：信息状态码

  - `100 Continue` 继续，一般在发送`post`请求时，已发送了`http header`之后服务端将返回此信息，表示确认，之后发送具体参数信息
  - 101，websocket

- 2XX：成功状态码

  | 200  | OK                            | 请求成功。一般用于GET与POST请求                              |
  | ---- | ----------------------------- | ------------------------------------------------------------ |
  | 201  | Created                       | 已创建。成功请求并创建了新的资源                             |
  | 202  | Accepted                      | 已接受。已经接受请求，但未处理完成                           |
  | 203  | Non-Authoritative Information | 非授权信息。请求成功。但返回的meta信息不在原始的服务器，而是一个副本 |
  | 204  | No Content                    | 无内容。服务器成功处理，但未返回内容。在未更新网页的情况下，可确保浏览器继续显示当前文档 |
  | 205  | Reset Content                 | 重置内容。服务器处理成功，用户终端（例如：浏览器）应重置文档视图。可通过此返回码清除浏览器的表单域 |
  | 206  | Partial Content               | 部分内容。服务器成功处理了部分GET请求                        |

- 3XX：重定向

  | 300  | Multiple Choices   | 多种选择。请求的资源可包括多个位置，相应可返回一个资源特征与地址的列表用于用户终端（例如：浏览器）选择 |
  | ---- | ------------------ | ------------------------------------------------------------ |
  | 301  | Moved Permanently  | 永久移动。请求的资源已被永久的移动到新URI，返回信息会包括新的URI，浏览器会自动定向到新URI。今后任何新的请求都应使用新的URI代替 |
  | 302  | Found              | 临时移动。与301类似。但资源只是临时被移动。客户端应继续使用原有URI |
  | 303  | See Other          | 查看其它地址。与301类似。使用GET和POST请求查看               |
  | 304  | Not Modified       | 未修改。所请求的资源未修改，服务器返回此状态码时，不会返回任何资源。客户端通常会缓存访问过的资源，通过提供一个头信息指出客户端希望只返回在指定日期之后修改的资源 |
  | 305  | Use Proxy          | 使用代理。所请求的资源必须通过代理访问                       |
  | 306  | Unused             | 已经被废弃的HTTP状态码                                       |
  | 307  | Temporary Redirect | 临时重定向。与302类似。使用GET请求重定向                     |

- 4XX：客户端错误

  | 400  | Bad Request      | 客户端请求的语法错误，服务器无法理解                         |
  | ---- | ---------------- | ------------------------------------------------------------ |
  | 401  | Unauthorized     | 请求要求用户的身份认证                                       |
  | 402  | Payment Required | 保留，将来使用                                               |
  | 403  | Forbidden        | 服务器理解请求客户端的请求，但是拒绝执行此请求               |
  | 404  | Not Found        | 服务器无法根据客户端的请求找到资源（网页）。通过此代码，网站设计人员可设置"您所请求的资源无法找到"的个性页面 |

- 5XX:服务器错误

  | 500  | Internal Server Error      | 服务器内部错误，无法完成请求                                 |
  | ---- | -------------------------- | ------------------------------------------------------------ |
  | 501  | Not Implemented            | 服务器不支持请求的功能，无法完成请求                         |
  | 502  | Bad Gateway                | 作为网关或者代理工作的服务器尝试执行请求时，从远程服务器接收到了一个无效的响应 |
  | 503  | Service Unavailable        | 由于超载或系统维护，服务器暂时的无法处理客户端的请求。延时的长度可包含在服务器的Retry-After头信息中。服务器的问题，找网管 |
  | 504  | Gateway Time-out           | 充当网关或代理的服务器，未及时从远端服务器获取请求           |
  | 505  | HTTP Version not supported | 服务器不支持请求的HTTP协议的版本，无法完成处理               |

#### 请求头和响应头



![img](https://img2018.cnblogs.com/blog/1301998/201906/1301998-20190621104932351-2057147169.png)

##### HTTP消息头

`HTTP消息头`是指，在超文本传输协议（ Hypertext Transfer Protocol ，HTTP）的请求和响应消息中，协议头部分的那些组件。HTTP消息头用来准确描述正在获取的资源、服务器或者客户端的行为，定义了HTTP事务中的具体操作参数。

Query Params：常用是**get**方式请求，query是指**请求行**中请求的参数，一般是指URL中？后面的参数

Body Params：常用是**post**方式请求，body是指**请求体**中的数据

##### 请求头

**HTTP协议使用TCP协议进行传输，在应用层协议发起交互之前，首先是TCP的三次握手。完成了TCP三次握手后，客户端会向服务器发出一个请求报文**

- #### keep-alive

  由于TCP的可靠性，每条独立的TCP连接都会进行一次三次握手，从上面的Network的分析中可以得到握手往往会消耗大部分时间，真正的数据传输反而会少一些(当然取决于内容多少)。HTTP1.0和HTTP1.1为了解决这个问题在header中加入了`Connection: Keep-Alive`，`keep-alive`的连接会保持一段时间不断开，后续的请求都会复用这一条TCP，不过由于管道化的原因也会发生**队头阻塞**的问题。HTTP1.1默认开启Keep-Alive，HTTP1.0可能现在不多见了，如果你还在用，可以升级一下版本，或者带上这个header。connection keep-alive

| 协议头              | 说明                                                         | 示例                                                         | 状态       |
| ------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ---------- |
| Accept              | 可接受的响应内容类型（`Content-Types`）。                    | `Accept: text/plain`                                         | 固定       |
| Accept-Charset      | 可接受的字符集                                               | `Accept-Charset: utf-8`                                      | 固定       |
| Accept-Encoding     | 可接受的响应内容的编码方式。                                 | `Accept-Encoding: gzip, deflate`                             | 固定       |
| Accept-Language     | 可接受的响应内容语言列表。                                   | `Accept-Language: en-US`                                     | 固定       |
| Accept-Datetime     | 可接受的按照时间来表示的响应内容版本                         | Accept-Datetime: Sat, 26 Dec 2015 17:30:00 GMT               | 临时       |
| Authorization       | 用于表示HTTP协议中需要认证资源的认证信息                     | Authorization: Basic OSdjJGRpbjpvcGVuIANlc2SdDE==            | 固定       |
| Cache-Control       | 用来指定当前的请求/回复中的，是否使用缓存机制。              | `Cache-Control: no-cache`              max-age：缓存无法返回缓存时间长于max-age规定秒的文档 | 固定       |
| Connection          | 客户端（浏览器）想要优先使用的连接类型                       | `Connection: keep-alive``Connection: Upgrade`                | 固定       |
| Cookie              | 由之前服务器通过`Set-Cookie`（见下文）设置的一个HTTP协议Cookie | `Cookie: $Version=1; Skin=new;`                              | 固定：标准 |
| Content-Length      | 以8进制表示的请求体的长度                                    | `Content-Length: 348`                                        | 固定       |
| Content-MD5         | 请求体的内容的二进制 MD5 散列值（数字签名），以 Base64 编码的结果 | Content-MD5: oD8dH2sgSW50ZWdyaIEd9D==                        | 废弃       |
| Content-Type        | 请求体的MIME类型 （用于POST和PUT请求中）                     | Content-Type: application/x-www-form-urlencoded              | 固定       |
| Date                | 发送该消息的日期和时间（以[RFC 7231](http://tools.ietf.org/html/rfc7231#section-7.1.1.1)中定义的"HTTP日期"格式来发送） | Date: Dec, 26 Dec 2015 17:30:00 GMT                          | 固定       |
| Expect              | 表示客户端要求服务器做出特定的行为                           | `Expect: 100-continue`                                       | 固定       |
| From                | 发起此请求的用户的邮件地址                                   | `From: user@itbilu.com`                                      | 固定       |
| Host                | 表示服务器的域名以及服务器所监听的端口号。如果所请求的端口是对应的服务的标准端口（80），则端口号可以省略。 | `Host: www.itbilu.com:80``Host: www.itbilu.com`              | 固定       |
| If-Match            | 仅当客户端提供的实体与服务器上对应的实体相匹配时，才进行对应的操作。主要用于像 PUT 这样的方法中，仅当从用户上次更新某个资源后，该资源未被修改的情况下，才更新该资源。 | If-Match: "9jd00cdj34pss9ejqiw39d82f20d0ikd"                 | 固定       |
| If-Modified-Since   | 把浏览器端缓存页面的最后修改时间发送到服务器去，服务器会把这个时间与服务器上实际文件的最后修改时间进行对比。如果时间一致，那么返回304，客户端就直接使用本地缓存文件。如果时间不一致，就会返回200和新的文件内容。客户端接到之后，会丢弃旧文件，把新文件缓存起来，并显示在浏览器中. | If-Modified-Since: Dec, 26 Dec 2015 17:30:00 GMT             | **固定**   |
| **If-None-Match**   | If-None-Match和ETag一起工作，工作原理是在HTTP Response中添加ETag信息。 当用户再次请求该资源时，将在HTTP Request 中加入If-None-Match信息(ETag的值)。如果服务器验证资源的ETag没有改变（该资源没有更新），将返回一个304状态告诉客户端使用本地缓存文件。否则将返回200状态和新的资源和Etag. 使用这样的机制将提高网站的性能 | If-None-Match: "9jd00cdj34pss9ejqiw39d82f20d0ikd"            | 固定       |
| If-Range            | 如果该实体未被修改过，则向返回所缺少的那一个或多个部分。否则，返回整个新的实体 | If-Range: "9jd00cdj34pss9ejqiw39d82f20d0ikd"                 | 固定       |
| If-Unmodified-Since | 仅当该实体自某个特定时间以来未被修改的情况下，才发送回应。   | If-Unmodified-Since: Dec, 26 Dec 2015 17:30:00 GMT           | 固定       |
| Max-Forwards        | 限制该消息可被代理及网关转发的次数。                         | `Max-Forwards: 10`                                           | 固定       |
| Origin              | 发起一个针对[跨域资源共享](http://itbilu.com/javascript/js/VkiXuUcC.html)的请求（该请求要求服务器在响应中加入一个`Access-Control-Allow-Origin`的消息头，表示访问控制所允许的来源）。 | `Origin: http://www.itbilu.com`                              | 固定: 标准 |
| Pragma              | 与具体的实现相关，这些字段可能在请求/回应链中的任何时候产生。 | `Pragma: no-cache`                                           | 固定       |
| Proxy-Authorization | 用于向代理进行认证的认证信息。                               | Proxy-Authorization: Basic IOoDZRgDOi0vcGVuIHNlNidJi2==      | 固定       |
| Range               | 表示请求某个实体的一部分，字节偏移以0开始。                  | `Range: bytes=500-999`                                       | 固定       |
| Referer             | 表示浏览器所访问的前一个页面，可以认为是之前访问页面的链接将浏览器带到了当前页面。`Referer`其实是`Referrer`这个单词，但RFC制作标准时给拼错了，后来也就将错就错使用`Referer`了。 | Referer: http://itbilu.com/nodejs                            | 固定       |
| TE                  | 浏览器预期接受的传输时的编码方式：可使用回应协议头`Transfer-Encoding`中的值（还可以使用"trailers"表示数据传输时的分块方式）用来表示浏览器希望在最后一个大小为0的块之后还接收到一些额外的字段。 | `TE: trailers,deflate`                                       | 固定       |
| User-Agent          | 浏览器的身份标识字符串                                       | `User-Agent: Mozilla/……`                                     | 固定       |
| Upgrade             | 要求服务器升级到一个高版本协议。                             | Upgrade: HTTP/2.0, SHTTP/1.3, IRC/6.9, RTA/x11               | 固定       |
| Via                 | 告诉服务器，这个请求是由哪些代理发出的。                     | Via: 1.0 fred, 1.1 itbilu.com.com (Apache/1.1)               | 固定       |
| Warning             | 一个一般性的警告，表示在实体内容体中可能存在错误。           | Warning: 199 Miscellaneous warning                           | 固定       |

##### 响应头

**响应报文**：**当收到get或post等方法发来的请求后，服务器就要对报文进行响应。**

| 响应头                      | 说明                                                         | 示例                                                         | 状态       |
| :-------------------------- | :----------------------------------------------------------- | :----------------------------------------------------------- | :--------- |
| Access-Control-Allow-Origin | 指定哪些网站可以`跨域源资源共享`                             | `Access-Control-Allow-Origin: *`                             | 临时       |
| Accept-Patch                | 指定服务器所支持的文档补丁格式                               | Accept-Patch: text/example;charset=utf-8                     | 固定       |
| Accept-Ranges               | 服务器所支持的内容范围                                       | `Accept-Ranges: bytes`                                       | 固定       |
| Age                         | 响应对象在代理缓存中存在的时间，以秒为单位                   | `Age: 12`                                                    | 固定       |
| Allow                       | 对于特定资源的有效动作;                                      | `Allow: GET, HEAD`                                           | 固定       |
| Cache-Control               | 通知从服务器到客户端内的所有缓存机制，表示它们是否可以缓存这个对象及缓存有效时间。其单位为秒 | `Cache-Control: max-age=3600`                                | 固定       |
| Connection                  | 针对该连接所预期的选项                                       | `Connection: close`                                          | 固定       |
| Content-Disposition         | 对已知MIME类型资源的描述，浏览器可以根据这个响应头决定是对返回资源的动作，如：将其下载或是打开。 | Content-Disposition: attachment; filename="fname.ext"        | 固定       |
| Content-Encoding            | 响应资源所使用的编码类型。                                   | `Content-Encoding: gzip`                                     | 固定       |
| Content-Language            | 响就内容所使用的语言                                         | `Content-Language: zh-cn`                                    | 固定       |
| Content-Length              | 响应消息体的长度，用8进制字节表示                            | `Content-Length: 348`                                        | 固定       |
| Content-Location            | 所返回的数据的一个候选位置                                   | `Content-Location: /index.htm`                               | 固定       |
| Content-MD5                 | 响应内容的二进制 MD5 散列值，以 Base64 方式编码              | Content-MD5: IDK0iSsgSW50ZWd0DiJUi==                         | 已淘汰     |
| Content-Range               | 如果是响应部分消息，表示属于完整消息的哪个部分               | Content-Range: bytes 21010-47021/47022                       | 固定       |
| Content-Type                | 当前内容的`MIME`类型                                         | Content-Type: text/html; charset=utf-8                       | 固定       |
| Date                        | 此条消息被发送时的日期和时间(以[RFC 7231](http://tools.ietf.org/html/rfc7231#section-7.1.1.1)中定义的"HTTP日期"格式来表示) | Date: Tue, 15 Nov 1994 08:12:31 GMT                          | 固定       |
| ETag                        | 对于某个资源的某个特定版本的一个标识符，通常是一个 消息散列  | ETag: "737060cd8c284d8af7ad3082f209582d"                     | 固定       |
| Expires                     | 指定一个日期/时间，超过该时间则认为此回应已经过期            | Expires: Thu, 01 Dec 1994 16:00:00 GMT                       | 固定: 标准 |
| Last-Modified               | 所请求的对象的最后修改日期(按照 RFC 7231 中定义的“超文本传输协议日期”格式来表示) | Last-Modified: Dec, 26 Dec 2015 17:30:00 GMT                 | 固定       |
| Link                        | 用来表示与另一个资源之间的类型关系，此类型关系是在[RFC 5988](https://tools.ietf.org/html/rfc5988)中定义 | `Link: `; rel="alternate"                                    | 固定       |
| Location                    | 用于在进行重定向，或在创建了某个新资源时使用。               | Location: http://www.itbilu.com/nodejs                       | 固定       |
| P3P                         | P3P策略相关设置                                              | P3P: CP="This is not a P3P policy!                           | 固定       |
| Pragma                      | 与具体的实现相关，这些响应头可能在请求/回应链中的不同时候产生不同的效果 | `Pragma: no-cache`                                           | 固定       |
| Proxy-Authenticate          | 要求在访问代理时提供身份认证信息。                           | `Proxy-Authenticate: Basic`                                  | 固定       |
| Public-Key-Pins             | 用于防止中间攻击，声明网站认证中传输层安全协议的证书散列值   | Public-Key-Pins: max-age=2592000; pin-sha256="……";           | 固定       |
| Refresh                     | 用于重定向，或者当一个新的资源被创建时。默认会在5秒后刷新重定向。 | Refresh: 5; url=http://itbilu.com                            |            |
| Retry-After                 | 如果某个实体临时不可用，那么此协议头用于告知客户端稍后重试。其值可以是一个特定的时间段(以秒为单位)或一个超文本传输协议日期。 | 示例1:Retry-After: 120示例2: Retry-After: Dec, 26 Dec 2015 17:30:00 GMT | 固定       |
| Server                      | 服务器的名称                                                 | `Server: nginx/1.6.3`                                        | 固定       |
| Set-Cookie                  | 设置`HTTP cookie`                                            | Set-Cookie: UserID=itbilu; Max-Age=3600; Version=1           | 固定标准   |
| Status                      | 通用网关接口的响应头字段，用来说明当前HTTP连接的响应状态。   | `Status: 200 OK`                                             |            |
| Trailer                     | `Trailer`用户说明传输中分块编码的编码信息                    | `Trailer: Max-Forwards`                                      | 固定       |
| Transfer-Encoding           | 用表示实体传输给用户的编码形式。包括：`chunked`、`compress`、 `deflate`、`gzip`、`identity`。 | Transfer-Encoding: chunked                                   | 固定       |
| Upgrade                     | 要求客户端升级到另一个高版本协议。                           | Upgrade: HTTP/2.0, SHTTP/1.3, IRC/6.9, RTA/x11               | 固定       |
| Vary                        | 告知下游的代理服务器，应当如何对以后的请求协议头进行匹配，以决定是否可使用已缓存的响应内容而不是重新从原服务器请求新的内容。 | `Vary: *`                                                    | 固定       |
| Via                         | 告知代理服务器的客户端，当前响应是通过什么途径发送的。       | Via: 1.0 fred, 1.1 itbilu.com (nginx/1.6.3)                  | 固定       |
| Warning                     | 一般性警告，告知在实体内容体中可能存在错误。                 | Warning: 199 Miscellaneous warning                           | 固定       |
| WWW-Authenticate            | 表示在请求获取这个实体时应当使用的认证模式。                 | `WWW-Authenticate: Basic`                                    | 固定       |

#### HTTP2

##### 多路复用

HTTP1.1 如果要同时发起多个请求，就得建立多个 TCP 连接，因为一个 TCP 连接同时只能处理一个 HTTP1.1 的请求。

在 HTTP2 上，多个请求可以共用一个 TCP 连接，这称为多路复用。同一个请求和响应用一个流来表示，并有唯一的流 ID 来标识。 多个请求和响应在 TCP 连接中可以乱序发送，到达目的地后再通过流 ID 重新组建。多路复用通过更小的二进制帧构成多条数据流，交错的请求和响应可以**并行传输**而不被阻塞，这样就解决了HTTP1.1时复用会产生的**队头阻塞**的问题

> 队头堵塞：
>
> 队头阻塞是由 HTTP 基本的“请求 - 应答”模型所导致的。HTTP 规定报文必须是“一发一收”，这就形成了一个先进先出的“串行”队列。队列里的请求是没有优先级的，只有入队的先后顺序，排在最前面的请求会被最优先处理。如果队首的请求因为处理的太慢耽误了时间，那么队列里后面的所有请求也不得不跟着一起等待，结果就是其他的请求承担了不应有的时间成本，造成了队头堵塞的现象。

##### 首部压缩

HTTP2有首部压缩的功能，如果两个请求首部(headers)相同，那么会省去这一部分，只传输不同的首部字段，进一步减少请求的体积。

```
// 请求1
:authority: unpkg.zhimg.com
:method: GET
:path: /za-js-sdk@2.16.0/dist/zap.js
:scheme: https
accept: */*
accept-encoding: gzip, deflate, br
accept-language: zh-CN,zh;q=0.9
cache-control: no-cache
pragma: no-cache
referer: https://www.zhihu.com/
sec-fetch-dest: script
sec-fetch-mode: no-cors
sec-fetch-site: cross-site
user-agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.122 Safari/537.36

// 请求2
:authority: zz.bdstatic.com
:method: GET
:path: /linksubmit/push.js
:scheme: https
accept: */*
accept-encoding: gzip, deflate, br
accept-language: zh-CN,zh;q=0.9
cache-control: no-cache
pragma: no-cache
referer: https://www.zhihu.com/
sec-fetch-dest: script
sec-fetch-mode: no-cors
sec-fetch-site: cross-site
user-agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.122 Safari/537.36
```

从上面两个请求可以看出来，有很多数据都是重复的。如果可以把相同的首部存储起来，仅发送它们之间不同的部分，就可以节省不少的流量，加快请求的时间。

HTTP/2 在客户端和服务器端使用“首部表”来跟踪和存储之前发送的键－值对，对于相同的数据，不再通过每次请求和响应发送。

下面再来看一个简化的例子，假设客户端按顺序发送如下请求首部：

```text
Header1:foo
Header2:bar
Header3:bat
```

当客户端发送请求时，它会根据首部值创建一张表：

![img](https://pic2.zhimg.com/80/v2-be170562d69da5c67cfc40aa591a722d_1440w.jpg)

如果服务器收到了请求，它会照样创建一张表。 当客户端发送下一个请求的时候，如果首部相同，它可以直接发送这样的首部块：

```text
62 63 64
```

服务器会查找先前建立的表格，并把这些数字还原成索引对应的完整首部。

##### 优先级

HTTP2 可以对比较紧急的请求设置一个较高的优先级，服务器在收到这样的请求后，可以优先处理。

##### 流量控制

由于一个 TCP 连接流量带宽（根据客户端到服务器的网络带宽而定）是固定的，当有多个请求并发时，一个请求占的流量多，另一个请求占的流量就会少。流量控制可以对不同的流的流量进行精确控制。

##### 服务器推送

HTTP2 新增的一个强大的新功能，就是服务器可以对一个客户端请求发送多个响应。换句话说，除了对最初请求的响应外，服务器还可以额外向客户端推送资源，而无需客户端明确地请求。

例如当浏览器请求一个网站时，除了返回 HTML 页面外，服务器还可以根据 HTML 页面中的资源的 URL，来提前推送资源。

#### HTTPS协议

超文本传输安全协议（Hypertext Transfer Protocol Secure，简称：HTTPS）是一种通过计算机网络进行安全通信的传输协议。HTTPS经由HTTP进行通信，利用SSL/TLS来加密数据包。HTTPS的主要目的是提供对网站服务器的身份认证，保护交换数据的隐私与完整性。
<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/10885a9d4d574d7caf3fee1416f623ca~tplv-k3u1fbpfcp-zoom-1.image" alt="img" style="zoom:33%;" />

HTTP协议采用**明文传输**信息，存在**信息窃听**、**信息篡改**和**信息劫持**的风险，而协议TLS/SSL具有**身份验证**、**信息加密**和**完整性校验**的功能，可以避免此类问题发生。

#### 不同HTTP的协议

**HTTP和HTTPS协议的区别**

- HTTS协议需要CA证书，费用较高；而HTTP协议不需要；
- HTTP协议是超文本传输协议，信息是明文传输的，HTTPS则是具有安全性的SSL加密传输协议；
- 使用不同的连接方式，端口也不同，HTTP协议端口是80，HTTPS协议端口是443；
- HTTP协议连接很简单，是无状态的；HTTPS协议是有SSL和HTTP协议构建的可进行加密传输、身份认证的网络协议，比HTTP更加安全。

**HTTP 1.0和 HTTP 1.1 有以下区别**

- 连接方面，http1.0 默认使用非持久连接，而 http1.1 默认使用持久连接。http1.1 通过使用持久连接来使多个 http 请求复用同一个 TCP 连接，以此来避免使用非持久连接时每次需要建立连接的时延。
- 资源请求方面，在 http1.0 中，存在一些浪费带宽的现象，例如客户端只是需要某个对象的一部分，而服务器却将整个对象送过来了，并且不支持断点续传功能，http1.1 则在请求头引入了 range 头域，它允许只请求资源的某个部分，即返回码是 206（Partial Content），这样就方便了开发者自由的选择以便于充分利用带宽和连接。
- 缓存方面，在 http1.0 中主要使用 header 里的 If-Modified-Since、Expires 来做为缓存判断的标准，http1.1 则引入了更多的缓存控制策略，例如 Etag、If-Unmodified-Since、If-Match、If-None-Match 等更多可供选择的缓存头来控制缓存策略。
- http1.1 中新增了 host 字段，用来指定服务器的域名。http1.0 中认为每台服务器都绑定一个唯一的 IP 地址，因此，请求消息中的 URL 并没有传递主机名（hostname）。但随着虚拟主机技术的发展，在一台物理服务器上可以存在多个虚拟主机，并且它们共享一个IP地址。因此有了 host 字段，这样就可以将请求发往到同一台服务器上的不同网站。
- http1.1 相对于 http1.0 还新增了很多请求方法，如 PUT、HEAD、OPTIONS 等。 

**HTTP 1.1 和 HTTP 2.0 的区别**

- 二进制协议：HTTP/2 是一个二进制协议。在 HTTP/1.1 版中，报文的头信息必须是文本（ASCII 编码），数据体可以是文本，也可以是二进制。HTTP/2 则是一个彻底的二进制协议，头信息和数据体都是二进制，并且统称为"帧"，可以分为头信息帧和数据帧。 帧的概念是它实现多路复用的基础。
- 多路复用： HTTP/2 实现了多路复用，HTTP/2 仍然复用 TCP 连接，但是在一个连接里，客户端和服务器都可以同时发送多个请求或回应，而且不用按照顺序一一发送，这样就避免了"队头堵塞"【1】的问题。
- 数据流： HTTP/2 使用了数据流的概念，因为 HTTP/2 的数据包是不按顺序发送的，同一个连接里面连续的数据包，可能属于不同的请求。因此，必须要对数据包做标记，指出它属于哪个请求。HTTP/2 将每个请求或回应的所有数据包，称为一个数据流。每个数据流都有一个独一无二的编号。数据包发送时，都必须标记数据流 ID ，用来区分它属于哪个数据流。
- 头信息压缩： HTTP/2 实现了头信息压缩，由于 HTTP 1.1 协议不带状态，每次请求都必须附上所有信息。所以，请求的很多字段都是重复的，比如 Cookie 和 User Agent ，一模一样的内容，每次请求都必须附带，这会浪费很多带宽，也影响速度。HTTP/2 对这一点做了优化，引入了头信息压缩机制。一方面，头信息使用 gzip 或 compress 压缩后再发送；另一方面，客户端和服务器同时维护一张头信息表，所有字段都会存入这个表，生成一个索引号，以后就不发送同样字段了，只发送索引号，这样就能提高速度了。
- 服务器推送： HTTP/2 允许服务器未经请求，主动向客户端发送资源，这叫做服务器推送。使用服务器推送提前给客户端推送必要的资源，这样就可以相对减少一些延迟时间。这里需要注意的是 http2 下服务器主动推送的是静态资源，和 WebSocket 以及使用 SSE 等方式向客户端发送即时数据的推送是不同的。

### DNS

域名系统（DNS），主机的域名到 IP 地址的映射

**域名解析的顺序：**

- 浏览器缓存；

- 找本机的hosts文件；

- 路由缓存；

- 找DNS服务器（本地域名、顶级域名、根域名）->迭代解析、递归查询。

- 顶级域（com，cn，net，gov，org）、二级域（baidu,taobao,qq,alibaba）、三级域（www）。

  ![图片](https://mmbiz.qpic.cn/mmbiz_png/QqekpIUjYsPnvK8PhW33a8cX6m7O8iatSQYoX1g3iboXfSY2oPtU9libeqiaFnebwhZCt93cStJibZJ4tLCP2ZWjKVQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)





## 各数据封包格式

- -  


### 链路层封包格式

由图：**一帧为1518B，数据字段的最大长度为1500字节**

<img src="img/计算机/计算机网络/链路层封包格式" alt="image-20230112104429870" style="zoom:67%;" />



- DMAC（DestinationMAC）是目的MAC地址。DMAC字段长度为6个字节，标识帧的接收者。

- SMAC（SourceMAC）是源MAC地址。SMAC字段长度为6个字节，标识帧的发送者。

- 类型字段（Type）用于标识数据字段中包含的高层协议，该字段长度为2个字节。类型字段取值为0x0800的帧代表IP协议帧；类型字段取值为0806的帧代表ARP协议帧。

  - 类型：确定以太网头后面跟的是哪个协议

    0x0800 ip协议

    0x0806 arp协议

    0x0835 rarp协议

- 数据字段(Data)是网络层数据，最小长度必须为46字节以保证**帧长至少为64字节**（46+18），数据字段的最大长度为1500字节。

- **循环冗余校验字段（CRC）提供了一种错误检测机制。该字段长度为4个字节**。

**注意**

1、IEEE802.2/802.3封装常用在无线

2、以太网封装常用在有线局域网

#### X．25

![img](img/计算机/计算机网络/wps165.png)

X.25是CCITT公布的用于连接数据终端至分组交换数据网络的推荐标准，X.25是一个面向连接的接口，采用虚电路传递数据分组至网络上的适当终点处。在X.25的网络中，用户的计算机终端设备将与分组/拆装设备（PAD）连接，负责完成分割分组、寻址、重组装分组的工作，而不同的X.25网络之间则要使用X.75协议互联。X.25是一个基于分组交换技术构建的网络，分组交换本身是适于无连接业务的，要为用户提供面向连接的接口服务，则必须借助虚拟电路技术（VC），虚电路服务具有两种形式，一种是交换虚电路SVC，一种是永久虚电路PVC。最常见的X.25协议支持的最大传输速率为**64Kb/s**。

**X.25的三层结构**

| **X.25层次结构** | **对应OSI层** | **相应标准**                                                 |
| ---------------- | ------------- | ------------------------------------------------------------ |
| 分组层           | 网络层        | X.25 PLP 通过建立虚拟连接，提供点对点、面向连接服务。X.25 PLP 层采用后退N帧 ARQ流控协议。PLP协议把用户数据分成一定大小的块 ，一般为128字节，再加上24位或32的分组头组成数据分组 |
| 链路访问层       | 数据链路层    | 使用平衡式链路访问规程LAPB，LAPB是源于HDLC的一种面向位的协议，实际上是平衡的异步方式类别下的HDLC。LAPB是HDLC的一个子集 |
| 物理层           | 物理层        | X.21，但可以使用RS-232C和V.35代替                            |

#### ATM的分层体系结构

![img](img/计算机/计算机网络/wps457.png)

| **层 次**        | **子 层**           | **功 能**                                                    | **与OSI对应** |
| ---------------- | ------------------- | ------------------------------------------------------------ | ------------- |
| 高  层           |                     | 对用户数据的控制                                             | 高  层        |
| ATM适配层（AAL） | 汇聚子层（CS）      | 为高层数据提供统一接口                                       | 第四层        |
| 拆装子层（SAR）  | 分割和合并用户数据  |                                                              | 第四层        |
| ATM层            |                     | VPI和VCI的管理；信元头的组装和拆分；信元的多路复用；流量控制 | 第三层        |
| 物理层           | 传输汇聚子层（TC）  | 信元校验和速率控制；数据帧的组装和拆分                       | 第二层        |
| 物理层           | 物理介质子层（PMD） | 比特定时；物理网络接入                                       | 第一层        |

**ATM信元头结构**

![img](img/计算机/计算机网络/wps510.png)

**流控标志（GFC）：**用于主机和网络之间的流控或优先级控制。

**·虚通路标识符（VPI）：**8位（UNI）或12位（NNI），常用是8位，因此一个主机上的虚通路数256个。

**·虚信道标识符（VCI）：**16位，理论上每个主机上的虚通路可以包含65536个虚信道，不过部分信道是用于控制的，并不传送用户数据。

*****在ATM中，虚电路有两级：虚通路（VP）和虚信道（VC），虚通路是由多条虚信道捆绑在一起形成的。在ATM逻辑通道中，是使用VPI+VCI的组合来标识连接的，在做VP交换或交叉连接时，只需交换VP，无需改变VCI的值。

**·负载类型（PTI）：**区分不同的拥塞信息。

**·信元丢失优先级（CLP）：**这一位用于区分信息的优先级，如果出现拥塞，交换机优先丢弃CLP被置1的信元。

**·头校验和（HEC）：**它支队信元头进行校验，采用的是X8+X2+X+1的8位CRC校验。

#### PPP的帧格式

![img](img/计算机/计算机网络/wps511.png)

#### 局域网的帧格式

![img](img/计算机/计算机网络/wps512.jpg) 





## 名词解释

### 广播多址‌网络

一条路由信息可以广播给所有的路由器

> **非广播多址网络**：不支持广播，通过单播方式发布路由信息。如X2.5网络。

在广播多址中，数据包被发送到一个特殊的IP地址（如255.255.255.255），网络中的所有设备都会接收到这个数据包。然后，只有那些需要处理该数据的设备才会响应。例如，在网络游戏中，同一本地网络的玩家可以通过广播地址交流状态信息。虽然广播地址允许网络中的所有设备接收数据，但只有特定的设备会响应和处理这些数据。

### mac地址

> **网卡**又称为网络适配器或网络接口卡NIC，但是现在更多的人愿意使用更为简单的名称“网卡”。通过网卡能够使不同的计算机之间连接，从而完成数据通信等功能

每个网卡或三层网口都有一个 **MAC 地址**， MAC 地址是烧录到硬件上，因此也称为**硬件地址**。MAC 地址作为数据链路设备的地址标识符，需要保证网络中的每个 MAC 地址都是**唯一**的，才能正确识别到数据链路上的设备。

每一个网卡在出厂时，都会给分配一个编号，这个编号就称之为mac地址。MAC地址,用于标识网络设备,类似于身份证号，且唯一

**组成：**以太网内的MAC地址是一个48bit（**6** 个字节）的值，前 3 个字节表示**厂商识别码**，每个网卡厂商都有特定唯一的识别数字。后 3 个字节由厂商给每个网卡进行分配。厂商可以保证生产出来的网卡不会有相同 MAC 地址的网卡。

![img](https://pic3.zhimg.com/80/v2-d584588e213aaa731cb5ba545a14e43e_720w.webp)

### 广播域和冲突域

![img](https://www.cnitpm.com/upload/image/20131127/20131127143938_1250.png)

冲突域

【概念】连接在同一导线上的所有工作站的集合，或者说是同一物理网段（共享介质）上所有节点的集合或**以太网上竞争同一带宽的节点集合**。

【设备】第二层设备能划分冲突域。即**交换机的每一个端口就是一个冲突域。**

　　　　集线器Hub是物理层设备，不能划分冲突域。所以Hub下面连接的所有主机组成一个冲突域

广播域

【概念】接收同样广播消息的节点的集合。简单的说如果站点发出一个广播信号，所有能接收收到这个信号的设备范围称为一个广播域。

【设备】第三层设备能划分广播域。即**路由器的每一个端口就是一个广播域。**

**冲突域和广播域，一个中继器和集线器是一个冲突域，交换机的一个接口为一个冲突域，一个VLAN为一个广播域**



### 单播、组播、广播

单播：在同一网络内，两个设备点对点的通信就是单播通信。

组播：在同一网络可达范围内，一个网络设备与关心其数据的部分设备进行通信就是组播。通过**IGMP协议**去申请加入或者离开这个组

广播：在同一网络可达范围内，一个网络设备向本网络内所有设备进行通信就是广播。

<img src="./img/计算机/计算机网络/20210131152237152.png" alt="20210131152237152" style="zoom: 67%;" />



众所周知，TCP是可靠传输（先与另一个通信端点建立可靠连接，再传输数据），因此TCP一般只支持单播这种通信方式，而UDP通信不需要建立连接就可以发送数据



IP地址由主机号和网络号组成，主机号全为“0”的是**网络地址/网段**，**主机号全为“1”的是广播地址** 

**组播的地址是保留的D类地址从 224.0.0.0—239.255.255.255** 

![wlgcs-201405-55](./img/计算机/计算机网络/wlgcs-201405-55.jpg)




### IP地址

![图片](https://mmbiz.qpic.cn/mmbiz_png/QqekpIUjYsPnvK8PhW33a8cX6m7O8iatSwPRtszVezacBN9SojUia54Tfw66g9IdVSgViaoCmeF0p9ruwnhiaV9LnQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

- A类（8网络号+24主机号)

- B类（16网络号+16主机号）
- C类（24网络号+8主机号）可以用于标识网络中的主机或路由器
- **D类地址作为组播地址**
- E类是地址保留

![图片](https://mmbiz.qpic.cn/mmbiz_png/QqekpIUjYsPnvK8PhW33a8cX6m7O8iatS5CzKR4JN7J9Fz0xeVTyF32Bc9WWLU1n3ETzkN8icutqWLAPH6iczrN7Q/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

网络号+主机号

A类：默认8bit子网ID，第一位为0，最大为127，0-127。前面一个字节做网络号/网段

B类：默认16bit子网ID，前两位为10，最大为191，128-191。前面两个字节做网络号/网段

C类：默认24bit子网ID，前三位为110，最大为224，192-224。前面三个字节做网络号/网段



- **公有IP**

  公有IP（可直接连接Internet）,经由InterNIC所统一规划的IP

- **私有ip地址**

  私有IP（不可直接连接Internet ）,主要用于局域网络内的主机联机规划
  
  A类：10.0.0.0/**8**（10.0.0.1-10.255.255.255）1个A类网络
  
  B类：172.16.0.0/**12**（172.16.0.1-172.31.255.255）16个B类网络
  
  C类：192.168.0.0/**16**（192.168.0.1-192.168.255.255）256个C类网络

![image-20230112103800179](img/计算机/计算机网络/私有ip地址)

### 特殊ip地址

- 0.0.0.0

  主机端：DHCP分配过程中，用0.0.0.0表示本机，比如主机DHCP。**Discover广播报文源目地址和端口是0.0.0.0：68-> 255.255.255.255：67**

  服务器端：0.0.0.0本机所有IPv4地址，如果某主机有两个IP地址，该主机一个服务监听的地址是0.0.0.0，那么通过两个IP地址都能够访问该服务。

  路由：0.0.0.0表示默认路由，即当路由表中没有找到完全匹配路由的时候所对应的路由。

- 255.255.255.255

  受限广播地址，表示3层广播的目标地址，在同一个广播域范围内所有主机都会接收这个包，广播域的范围可变，跟子网划分相关。

- 169.254.0.0/16

  使用DHCP自动获取IP地址，当DHCP服务器发生故障，或响应时间超时，系统会为你分配这样一个地址，不能正常上网。

- 127.0.0.0/8（127.0.0.1-127.255.255.255）
  本地环回地址，能ping通127地址，证明TCP/IP协议栈正常。

  - **通常 127.0.0.1 称为回环地址。**回环地址主要用于本地网络接口的测试和诊断。通过将网络数据包发送到本地回环地址，可以测试网络协议栈的正常运行，以及确保计算机网络接口卡的驱动程序和硬件设备都能够正常工作。在实际应用中，回环地址可以用于各种网络诊断和测试工具，例如ping、traceroute、telnet等
  - 回环地址可以在不需要其他计算机或网络连接的情况下进行测试，使其成为网络接口测试和网络应用程序开发的有用工具。可以用于模拟一些网络服务，例如Web服务器、FTP服务器、邮件服务器等。

- 常见组播：
  224.0.0.1 所有主机
  224.0.0.2 所有路由器
  224.0.0.5 所有运行OSPF的路由器
  224.0.0.6 OSPF DR和BDR的组播接收地址
  224.0.0.9 RIPv2组播更新地址
  224.0.0.18 VRRP组播地址（虚拟路由器冗余协议）

### 子网掩码

子网掩码又叫网络掩码、地址掩码、子网络遮罩。它是一种用来指明一个IP地址的哪些位 标识的是主机所在的子网，以及哪些位标识的是主机的位掩码。

子网掩码（subnet mask，又叫网络掩码、地址掩码）是一个32bit由1和0组成的数值，**并且1和0分别连续**

> 子网划分，在主机号上按位进行子网络的划分，主机号=子网号+子网主机号
>
> **子网掩码划分最多30位**，因为一个规定**子网里最少容纳2台主机**，30位的掩码就是2个主机位

子网掩码的分类

- 缺省子网掩码

  也叫默认子网掩码，即未划分子网，对应的网络号的位都置 1 ，主机号都置 0 。

  **未做子网划分的IP地址**：网络号＋主机号，则：

  A类网络缺省子网掩码： 255.0.0.0，用CIDR表示为/8
  B类网络缺省子网掩码： 255.255.0.0，用CIDR表示为/16
  C类网络缺省子网掩码： 255.255.255.0，用CIDR表示为/24

- 自定义子网掩码

  将一个网络**划分子网后**，把原本的主机号位置的一部分给了子网号，余下的才是给了子网的主机号。其形式如下：

  做子网划分后的IP地址：网络号＋子网号＋子网主机号，举个例子：

  192.168.1.100/25，其子网掩码表示：255.255.255.128，意思就是将192.168.1.0这个网段的主机位的最高1位划分为了子网。

**子网掩码，与ip地址相与，得到对应的网络号**

子网ID:IP地址中由子网掩码中1覆盖的**连续位**

主机ID:IP地址中由子网掩码中0覆盖的**连续位**

![image-20230112103453592](img/计算机/计算机网络/IP地址)



### 网关

**网关地址就是一个IP地址，是分配给路由器/vlan一个接口的IP地址，通过指定网关来转发信息给接口指定的其他网络段**

> 网关地址就是一个IP地址，是分配给路由器一个接口的IP地址
>
> 比方说：我有一个电脑，IP是192.168.1.1，子网掩码是24位的，那么他的网络号就是192.168.1.0，我在给他指定一个网关是192.168.1.254
>
> 这个时候，我的这台电脑想要和同网的192.168.1.2 通信，那么他就不用网关了，直接发到局域网上就可以了。
>
> 但是如果我想要发给远程的主机，比方说IP是192.168.2.1 同样24位的， 他的网络号就是192.168.2.0 这时网关就起
>
> 作用了，我的电脑就会把数据发给网关由网关再转发一直到达目的地也就是IP 是192.168.2.1的主机上。

网关的作用就是对两个网络段中的使用不同传输协议的数据进行互相的翻译转换。

在如下拓扑图示例中，A与B，C与D，都可以直接相互通信（都是属于各自同一网段，不用经过路由器），但是A与C，A与D，B与C，B与D它们之间不属于同一网段，所以它们通信是要经过本地网关，然后路由器根据对方IP地址，在路由表中查找恰好有匹配到对方IP地址的直连路由，于是从另一边网关接口转发出去实现互连。

<img src="https://img-blog.csdnimg.cn/3c24c76df3814341add247b842adbedf.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAVEFCRV8=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述" style="zoom:50%;" />

### 自治系统AS

自治系统AS：自治系统的存在是为了实现互联网的分布式管理和自治，每个自治系统都有自己的网络策略和管理规则，可以根据自身的需求和目标来配置和管理网络。不同的自治系统可以通过互联网互相连接，形成一个庞大的网络。

- 类型

  - **自治系统内部**的路由协议为内部网关协议，如RIP、OSPF等；

  - **自治系统外部**的路由协议为外部网关协议，如BGP


- 算法

  - 链路状态路由选择算法LS：向所有隔壁路由发送信息，每个路由器计算路由时，需构建整个网络拓扑图；利用Dijkstra(迪杰斯特拉)算法求源端到目的端网络的最短路径；

    收敛快；
    
  - 距离-向量路由选择算法DV：向所有隔壁路由发送信息，基础是Bellman-Ford方程（简称B-F方程）
  
    收敛慢、会存在回路；


<img src="../../考试/网络工程师/img/image-20230518211049074.png" alt="image-20230518211049074" style="zoom: 67%;" />

#### 内部网关路由协议IGP

##### RIP协议

<img src="img/计算机/计算机网络/image-20230518211516272.png" alt="image-20230518211516272" style="zoom:67%;" />

路由信息协议 RIP(Routing Information Protocol)【应用层】，**基于距离矢量的路由选择算法**，较小的AS（自治系统），**适合小型网络；RIP报文，封装进UDP数据报（端口520）。**

<img src="img/计算机/计算机网络/image-20240816164723486.png" alt="image-20240816164723486" style="zoom:50%;" />

- RIPv1属于**有类路由协议**，不携带子网掩码，不支持VLSM，以**广播**形式进行路由信息的更新，**周期性更新（30秒）**；

- RIPv2属于**无类路由协议(CIDR)**，携带子网掩码，支持VLSM，以**组播（组播地址224.0.0.9）**形式进行路由更新，**触发更新**（有更改即可更新）来加速路由收敛。

##### OSPF协议

开放最短路径优先协议 OSPF(Open Shortest Path First)，**基于链路状态的路由选择算法（即Dijkstra算法/SPF），通过触发更新路由**。较大规模的AS ，**适合中大型网络，直接封装在IP数据报传输(端口89)。**

- 功能特性

  OSPF是基于链路状态的路由协议，以COST开销作为其度量值，并采用SPF算法计算出最佳路由，支持[*VLSM*(可变长子网掩码)](http://www.baidu.com/link?url=f8FmShs5p5eh0SsmppFxi3g13qVY5MuxVFbyHfIkOi-JKFP7OzBcfc4S1OoOtJ8s-8f_shKbOeQNnXV_v67Mldjn8jI4wd7CHYyfN83UxB_)，支持触发更新，收敛速度快，路由协议优先级为10，可信任度高。

- 区域划分

  **允许网络被划分成区域来管理，减小对路由器内存和CPU的消耗。同时区域间传送的路由信息减小，降低网络带宽占用**

  - 标准区域： 标准区域也被称为非主干区域，它是主干区域之外的其他区域。**在标准区域中，路由器之间只能通过主干区域进行通信，无法直接相互通信。**标准区域的作用是将网络划分为较小的子网络，减少网络中的路由器数量和通信负担，提高网络的性能和可管理性。标准区域可以接收任何链路更新 信息和路由汇总信息。 

  - 主干区域（骨干区域）：主干区域是OSPF网络中最重要的区域之一。主干区域也被称为**区域0**/单域0SPF ，标识符可表示为0.0.0.0，它连接了所有其他区域，是整个OSPF网络的核心。

    **骨干区域负责区域之间的路由，非骨干区域之间的路由信息必须通过骨干区域来转发**

  - 根区域： **不接受本地自治系统以外的路由信息， 对自治系统以外的目标采用默认路由 0.0.0.0。** 

  - 完全存根区域： 不接受自治系统以外的路由 信息，也不接受自治系统内其他区域的路由汇总 信息， 发送到本地区域外的报文使用默认路由 0.0.0.0。完全存根区域是Cisco定义的，是非标 准的。 

  - 不完全存根区域（NSAA） :类似于存根区 域， 但是允许接收以类型7的链路状态公告发送 的外部路由信息。

- 路由器选举

  > 为什么选举DR和BDR:
  >
  > 当一个OSPF区域内有多个路由器连接到同一个多播网络（如以太网）时，每个路由器都会发送链路状态更新到该网络上的所有其他OSPF路由器。造成其他路由器接收到大量的OSPF重复报文浪费带宽资源和设备CPU计算资源
  >
  > 为减小多路访问网络中的OSPF流量，OSPF会在每一个Ma网络（多路访问网络）选举一个指定路由器（DR）和一个备用指定路由器（BDR），它们负责将链路状态更新转发给其他路由器，而其他普通路由器只需向DR或BDR发送链路状态更新。
  
  - 指定路由器功能（DR）：当多路访问网络发生变化时，DR负责更新其他所有OSPF路由器，发送链路状态公告**，作用范围是一个网段。DR具有非抢占性。**
  
  - 备用指定路由器（BDR）：监控DR状态，并在当前DR发生故障后接替其角色。
  
  选举规则
  
  - **运行ospf的路由器在选举DR/BDR之前，DR是路由器本身**
  
  - **接口的DR优先级越大越优先[优先级0不参与选举]，优先级最高的路由器成为DR，次高的成为BDR。**
  
  - **Router ID越大越优先**
  
  - **DR没有抢占性，当BDR变为老大时，DR无法自动再次成为老大**
  
  - **DR和BDR的选举过程是先选BDR再选DR。从宏观角度来说，一开始先选择BDR出来，然后BDR判断网络中有没有DR，没有DR，则BDR升级为DR，再选择一个BDR出来**
  
    

在OSPF的广播网络中，有4台路由器Router A、Router B、Router C和Router D，其优先级分别为2、1、1和0，Router ID分别为192.168.1.1、192.168.2.1、192.168.3.1和192.168.4.1、若在此4台路由器上同时启用OSPF协议，OSPF选出的BDR为（47）。C 

A.Router A 

B.Router B 

C.Router C 

D.Router D



> **点对点**网络上每10秒发送一次**hello**，在NBMA网络每30秒发送一次，Deadtime为hello时间4倍。


运行 OSPF 协议的路由器每 10 秒钟向它的各个接口**发送 Hello 分组**，接收到 Hello 分组的路由器就知道了邻居的存在。如果在 （ ） 秒内没有从特定的邻居接收到这种分组，路由器就认为那个邻居不存在了。

**40。OSPF规定路由器失效时间是Hello分组间隔时间的4倍**

##### IS-IS协议

IS-IS（Intermediate system to intermediate system，中间系统到中间系统）是内部网关协议，是电信运营商普遍采用的内部网关协议之一，也是一个**分级的链路状态路由协议**

与OSPF相似，它也使用**Hello协议寻找毗邻节点**。

**和ospf不同的是一个路由器只属于一个区域。ospf路由器的不同端口属于不同区域**

IS-IS具有层次性，分为两层Level-1和Level-2

- **Level-1（L1）是普通区域（Area），Level-2（L2）是骨干区（Backbone）。**

  <img src="img/计算机/计算机网络/image-20240817213707582.png" alt="image-20240817213707582" style="zoom:50%;" />

- 骨干区Backbone是连续的Level-2路由器的集合，由所有的L2（含L1/L2）路由器组成，L1和L2运行相同的SPF算法，一个路由器可能同时参与L1和L2。

#### 外部网关路由协议EGP

##### BGP

**BGP用于不同自治系统AS之间，交换路由信息，寻找最佳路由。主要功能是控制路由策略**

AS边界路由相连称为EBGP对等体，AS内部路由只有建立IBGP对等体才可以传递和接收BGP路由条目。EBGP对等体和IBGP对等体都需要通过TCP：179端口建立邻居关系。BGP通过发送open报文建立邻居，然后通过updata报文传递路由信息，网络收敛完成后，周期性（60s）发送keepalive探测邻居存活。当BGP出现错误时，会发送notification报文。BGP起初交换整个BGP路由表，后续只更新变化和增量BGP路由

- 特点
  - **BGP通过TCP 179端口建立连接，支持VLSM和CIDR。**
  - 支持增量更新，支持认证，支持无类、支持聚合（优先级：手动聚合 >自动聚合> network > import）。
  - 是一种路径矢量协议，可以检测路由环路，支持大型网络。
  - 目前最新版本是BGP4，而BGP4+**支持IPv6**.

- 报文类型![image-20230518221206018](img/计算机/计算机网络/image-20230518221206018.png)

- 选路规则 
  - 优选手动聚合 > 自动聚合> network > import>从对等体学到的
    - 优选手动聚合 
    - 自动聚合
    - **network路由逐条精确匹配路由，属于内部路由**
    - **import按协议类型引入外部路由**
  

### VLSM和CIDR

**VLSM可变长子网掩码**： 主要应用于内部网络设计，特别是在大型组织或企业中。VLSM允许在一个网络中使用不同大小的子网，以更灵活地利用IP地址。

CIDR无类别域间路由

/8掩码是A类，/16掩码是B类,/24掩码是C类。这种划分方式在地址分配-方面存在很多浪费，因为每个类别都有固定数量的地址，不一定适用于所有的网络规模。CIDR的作用就是支持IP地址的无类规划，把IP的网段规划成更细的方式来表示，这样可以有效的节约IP地址的使用和方便管理。

**区别**
VLSM： 主要关注在局域网（LAN）内部，允许对内部网络进行更灵活的子网划分，以满足各个子网的不同需求。

CIDR： 主要关注在互联网上对大量网络进行聚合和路由汇总，以减小路由表的大小。

### 端口

TCP/IP协议采用端口标识通信的进程，用于区分一个系统里的多个进程

**特点**

1、对于同一个端口，在不同系统中对应着不同的进程

2、对于同一个系统，一个端口只能被一个进程拥有

3、一个进程拥有一个端口后，传输层送到该端口的数据全部被该进程接收，同样，进程送交传输层的数据也通过该端口被送出



### QoS

QoS（Quality of Service）要求，QoS通常用带宽、时延、时延抖动和分组丢失率来衡量。**QoS的关键指标包括可用性、吞吐量、时延、时延变化（包括抖动和漂移）和丢失**

## 考点

### 背

https://zhuanlan.zhihu.com/p/515239767

1. **帧经过交换机时，其源、目标MAC是不会变的（数据帧在交换机之间转发）**

   **原因：**交换机内部的CPU会在每个端口成功连接时，通过将MAC地址和端口对应，形成一张MAC表。在今后的通讯中，发往该MAC地址的数据包将仅送往其对应的端口，而不是所有的端口。**因此，交换机可用于划分数据链路层广播，即冲突域；但它不能划分网络层广播，即广播域。**

   **这种情况只需要坚持一个原则，数据帧在交换机之间转发不更改源MAC地址和目标MAC地址；**

   就好比主机A和主机B通过若干个交换机相连（并没有路由器在中间），那么此时的MAC地址是什么？源MAC地址自然是主机A的网卡所对应的MAC地址，目标MAC地址则是主机B的网卡所对应的MAC地址；

   ![img](https://pic3.zhimg.com/80/v2-50c80a463d5afe918bef9b3a82011b46_1440w.webp)

2. **帧经过路由器时，进行路由转发，IP地址不会变的，但MAC地址一定会变（数据帧在路由器之间转发）；**

   - 当主机A发向主机B的数据流在网络层封装成IP数据包，IP数据包的首部包含了源地址和⽬标地址。主机A会⽤本机配置的24位IP网络掩码255.255.255.0与目标地址进⾏与运算，得出⽬标网络地址与本机的⽹络地址是不是在同⼀个⽹段中。如果不是将IP数据包转发到网关。
   - 在发往⽹关前主机A还会通过ARP的请求获得默认⽹关的MAC地址。在主机A数据链路层IP数据包封装成以太网数据帧，然后才发住到网关……也就是路由器上的⼀个端⼝。
   - 当网关路由器接收到以太网数据帧时，发现数据帧中的目标MAC地址是自己的某⼀个端⼝的物理地址，这时**路由器会把以太网数据帧的封装去掉**。路由器认为这个IP数据包是要通过自己进行转发，接着它就在匹配路由表。匹配到路由项后，它就将包发往下⼀条地址。

   路由器转发数据包就是这样，**所以它始终是不会改IP地址的。只会改MAC。**





![image-20230523164516189](img/计算机/计算机网络/image-20230523164516189.png)

对于CSMA/CD，线路利用率越高，冲突越高，平均传输延迟就越大；而且**平均传输延迟的增加速度远高于线路利用率的提高速度。**

对于令牌环，线路利用率的提高虽然也会造成平均传输延迟的提高，但对平均传输延迟的提高影响不太大。



在重负载时，令牌环网比以太网的利用率高

![image-20230523164516189](img/计算机/计算机网络/image-20230523164516189.png)



以太网帧结构中**填充式保持最小帧长**



采用以太网链路聚合技术将  （ ）  

在局域网应用中，由于数据通信量的快速增长，交换机带宽往往不够用，于是出现了将**多条物理链路当作一条逻辑链路**使用的链路聚合技术，这时网络通信由聚合到逻辑链路中的所有物理链路共同承担。

在局域网应用中，由于数据通信量的快速增长，交换机**带宽**往往不够用，于是出现了将多条物理链路当作一条逻辑链路使用的**链路聚合技术**，这时网络通信由聚合到逻辑链路中的所有物理链路共同承担。



不同vlan之间必须通过**中继端口**连接



①非坚持型监听算法：若信道忙，则放弃监听， 后退一段随机时间后再试图重新发送。 这种方法 重新冲突的概率低， 但可能引入过多的信道延 迟，浪费信道的带宽。 

②坚持型监听算法：若信道忙，则继续监听，直 到信道空闲就可发送。 这种方法发生冲突的概率 高，但可以减少发送延迟。 

③P坚持型监听算法：若信道忙，则以概率P继 续监听，或以概率1-P放弃监听并后退一段随机 时间， 再试图重新发送。 这种方法具有以上两种 方法的优点，但是算法复杂，P值的大小对网络 的性能有较大影响。







HDLC是一种 （ ） 协议。面向比特的同步链路控制



路由器通过光纤连接广域网的是**SFP端口**



五类、六类网线的标准是由（）制定的。ISO/IEC JTC1 SC25委员会





IS-IS 路由协议中的路由器的不同接口可以属于不同的区域（×）ospf才是



所谓移动IP是指（1）；实现移动IP的关键技术是（2）。

- 移动主机在离开家乡网络的远程站点可以联网工作

- 移动主机具有一个家乡网络地址并获取一个外地转交地址



在以太网中发生冲突时采用退避机制，（）优先传输数据。冲突域中**重传计时器首先过期的设备**







**选择重发ARQ协议**（有噪声环境双工）：滑动窗口协议与自动请求重发技术的结合，当收到否定应答（NAK）时，只重发出错的帧。$W发=W收≤2^{K-1}$



**ARP 协议数据单元封装在(  )中传送。以太网数据帧**



web浏览器向web服务器发送一个报文，其tcp不可能出现端口组合；目标端口要是80或者其他，源端口要1024以上







可以发出SNMP GetRequest的网络实体是()。Manager



**SNMP报文中不包括()。优先级**







**路由收敛是指网络设备路由表和网络拓扑结构一致**



HDLC用一种特殊的位模式**01111110**作为标志以确定帧的边界







以太网协议中使用了二进制指数后退算法，其冲突后最大的尝试次数为（）次。16

两个站点采用二进制指数后退算法进行避让，3次冲突之后再次冲突的概率是（ ）。0.125

两个站点采用二进制指数后退算法进行避让，1次冲突之后两个站点均在{0，1}中去选择一个数来确定避让的时间，再次冲突的概率是0.5，2次冲突之后两个站点均在{0，1,2，3]中去选择一个数来确定避让的时间，再次冲突的概率是0.25，3次冲突之后两个站点均在{0.1.,2,3,4.5,6,7}中去选择一个数来确定避让的时间，再次冲突的概率是0.125。





windows操作系统中**dhcp服务器的租约默认的有线网络8天，无线网络8小时（datacenter版为6小时）**



代理服务器为局城网用户提供Internet访问时，不提供（ ）服务。**数据加密**

**通过代理服务器访问internet功能不包括，避免来自internet上病毒入侵**







Telnet工作过程使用Telnet协议进行远程登录时 需要满足以下条件：

在本地计算机上必须装有包 含Telnet协议的客户程序；

必须知道远程主机的 Ip地址或域名；

必须知道登录标识与口令。

不包括：本地计算机防火墙入站规则设置允许 Telnet访问



在BGP4协议中，路由器通过发送（ ）报文将正常工作信息告知邻居。当出现路由信息的新增或删除时，采用（/）报文告知对方。

KEEPALIVE,UPDATE

1. OPEN报文：建立邻居关系。 2. KEEPALIVE报文：保持活动状态，周期性确认邻居关系，对OPEN报文回应。 3. UPDATE报文：发送新的路由信息。 4. NOTIFICATION报文：报告检测到的错误。



端口号的作用是对应用层进程进行寻址。

#### 特殊

 在Web Services中，客户与服务之间的标准通信协议是**简单对象访问协议（SOAP）**。

MIB-2的系统组中，（ ）对象以7位二进制数表示，每一位对应OSI/RM 7层协议中的一层。sysservices

#### IEEE





在下面的标准中，定义快速生成树协议的是（1） ，支持端口认证的协议是 （2） 。

- IEEE802.1w
- IEEE802.1x





无线局域网的新标准IEEE802.IIn提供的最高数据速率可达到（67）Mb/S **300**



MPLS根据标记对分组进行交换，其标记中包含（ ）。IP

### 网络

如果网络需求对**QoS**要求很高，应考虑采用 （ ） 网络。ATM

ATM 适配层的功能是 （ ） 。分割和合并用户数据 

### 协议

RSVP协议通过（）来预留资源。接收方请求路由器

#### HDLC

**路由器出厂时**，默认的串口封装协议是HDLC



#### IP

下面的地址中，可以分配给某台主机接口的地址是（）。
A.224.0.0.23
B.220.168.124.127/30
C.61.10.191.255/18
D.192.114.207.78/27

有效的主机地址为主机位非全0或非全1即可。



地址192.168.37.192/25是(1)  ，地址172.17.17.255/23是(2)。

IP地址由主机号和网络号组成，主机号全为“0”的是网络地址，主机号全为“1”的是广播地址 

192.168.37.192/25  =  192.168.37.1|1000000 

主机号非全“0”，也非全“1”，所以是一主机地址 

172.17.17.255/23  =  172.17.0001000|1.11111111 

主机号全为“1”，此地址为广播地址



给定一个C类网络192.168.1.0/24，要在其中划分出3个60台主机的网段和2个30台主机的网段，则采用的子网掩码应该分别为（ ）。255.255.255.192和255.255.255.224 

 24位网络号，还剩8位主机号，可以有2的8次方个主机地址，也就是256个，如果要求每个子网60台，那么是不是要分配6位（2的6次方=64，可以满足），所以子网掩码就是255.255.255.192，同样2个30台，就要分配5位（2的5次方=32），所以子网掩码就是255.255.255.224



设IP地址为18.250.31.14，子网掩码为255.240.0.0，则子网地址是  ( )

子网掩码，与ip地址相与，得到对应的网络号。 IP地址18.250.31.14/255.240.0.0的二进制形式为：

 11111111.11110000.00000000.00000000

 00010010.11111010.00011111.00001110

 则子网地址是00010010.11110000.00000000.00000000,即18.240.0.0



一个局域网中某台主机的IP地址为176.68.160.12，使用22位作为网络地址，那么该局域网的子网掩码为 （1） ，最多可以连接的主机数为 （2） 

由于22位作为网络地址，因此该局域网的网络地址为176.68.160.0。在子网掩码中，网络地址部分全部置为1，主机地址部分全部置为0。因此，该局域网的子网掩码为255.255.252.0。 （2） 由于该局域网的子网掩码为255.255.252.0，主机地址有10位，因此最多可以连接2^10-2=1022台主机。其中，**减去2是因为网络地址和广播地址不能被分配给主机使用**。 



将地址段172.16.32.0/24，172.16.33.0/24，172.16.34.0/24，172.16.35.0/24进行聚合后得到的地址是（）。

将IP地址转换为二进制：

172.16.32.0/24=172.16.00100000.00000000

172.16.33.0/24=172.16.00100001.00000000

172.16.34.0/24=172.16.00100010.00000000

172.16.35.0/24=172.16.00100011.00000000

最长相同网络位为22位，故聚合地址为172.16.00100000.00000000=172.16.32.0/22

#### ipv6

IPv6地址的格式前缀用于表达地址类型或子网地址，例如60位地址12AB 0000 0000 CD3有多种合法的表示形式，下面的选项中，不合法的是（ ）。c

A.12AB:0000:0000:CD30:0000:0000:0000:0000/60
B.12AB::CD30:0:0:0:0/60
C.12AB:0:0:CD3/60
D.12AB:0:0:CD30::/60

IPv6地址的格式前缀用于表达地址类型或子网地址，例如60位地址。但是后面的主机号不能省略

> IPv6将整个地址分为8节来表示，每节含16个地址位，以4个十六进制数书写，节与节之间用冒号分隔。
>
> - 如果在4位的十六进数中，如其高位为0，则可省略。
> - 连续的一个或者多个全零组可用重叠的冒号“::”表示。
> - 若以零开头零可以省略，全段为0可以用一个0表示，连续的全零的段可用“**::**”表示（**只能出现一次**） 。
>
>
> 同一个地址不同表示法的例子：
>
> 20**20**:0410:0000:0001:0000:0000:0000:abcd
>
> 20**20**:410:0:1:0:0:0:abcd
>
> 20**20**:410:0:1**::**abcd



IPv6地址分为3种类型，单播地址、組播地址、任意播地址



ipv6定义了很多可选的扩展首部。可提供比ipv4更多的功能。**基本首部长度是40字节。**

IPv6协议数据单元由一个固定头部和若干个扩展头部以及上层协议提供的负载组成，其中用于标识松散源路由功能的扩展头是 （1） 。如果有多个扩展头部，**第一个扩展头部**为 （2） 。路由选择头部 ,逐跳头部 



ipv6地址的格式前缀（fp）用于表示**地址类型或子网地址**。为了实现ip地址的自动配置，ipv6主机将**mac地址**附加在地址前缀**1111 1110 10**之后，产生一个链路本地地址，如果通过了邻居发现协议的验证，则表明自我配置的链路本地地址是有效的。



**IPv6中没有“校验和”字段。**		





在IPv4和IPv6混合网络中，协议翻译技术用于（）。C.纯IPv4主机和纯IPv6主机之间通信



IPv6站点通过IPv4网络通信需要使用隧道技术，常用的3种自动隧道技术是（）。6to4隧道、6over4隧道和ISATAP隧道



在IPv6的单播地址中有两种特殊地址，其中地址0：0：0：0：0：0：0：0表示（/），地址0：0：0：0：0：0：0：1 表示（）。

- 不确定地址，不能分配给任何结点
- 回环地址，结点用这种地址向自身发送IPv6分组

#### OSPF

OSPF协议适用于4种网络。下面选项中，属于广播多址网络的是  (1)  ，属于非广播多址网络的是  (2)  。

- Ethernet 
- Frame Relay 

#### DHCP

- 



> 当**DHCP客户机**第一次登录网络的时候（也就是客户机上没有任何IP地址数据时），它会通过UDP 67端口向网络上发出一个**DHCPDISCOVER**数据包（包中包含客户机的MAC地址和计算机名等信息）。因为客户机还不知道自己属于哪一个网络，所以**封包的源地址为0.0.0.0，目标地址为255.255.255.255**，然后再附上DHCP discover的信息，向网络进行广播。
>
> DHCP discover的等待时间预设为1秒，也就是当客户机将第一个DHCP discover封包送出去之后，在1秒之内没有得到回应的话，就会进行第二次DHCP discover广播。若一直没有得到回应，客户机会将这一广播包重新发送四次（以2，4，8，16秒为间隔，加上1-1000毫秒之间随机长度的时间）。如果都没有得到**DHCP服务器端**的回应，客户机会从**169.254.0.0/16**这个自动保留的私有IP地址中选用一个IP地址，并且每隔5分钟重新广播一次，如果收到某个服务器的响应，则继续IP租用过程。

**DhcpDiscover**。当主机启动时需要自动分配IP地址，又不知道DHCP服务器地址，故请求报文DhcpDiscover中目的IP地址为 **255.255.255.255**。



客户机会在租期过去50%的时候，直接向为其提供IP地址的DHCP Server发送DHCP REQUEST消息包。满了是发DHCP DISCOVER。

#### ftp

许多网络通信需要进行组播，以下选项中不采用组播协议的应用是 （1） 。在IPv4中把 （2） 类地址作为组播地址。**FTP,D**

ftp 数据20控制21 

FTP客户上传文件时，通过服务器20端口建立的连接是（/），客户端应用进程的端口可以为（**端口号大于1024**）。

匿名 FTP 访问通常使用 （ ） 作为用户名。anonymous

#### SNMP

SNMP 是专门设计用于在 IP 网络管理网络节点（服务器、工作站、路由器、交换机及HUBS等）的一种标准协议，它是一种应用层协议。 SNMP 使网络管理员能够管理网络效能，发现并解决网络问题以及规划网络增长。通过 SNMP 接收随机消息（及事件报告）网络管理系统获知网络出现问题



SNMP协议实体发送请求和应答报文的默认端口号是161，SNMP代理发送陷阱报文(Trap) 的默认端口号是162。



 在SNMP v2中，一个实体发送一个报文一般要经过下面4个步骤。

 （1）根据要实现的协议操作构造PDU； 

（2）把PDU、源和目标端口地址以及团体名传送给认证服务，认证服务产生认证码或对数据进行加密，返回结果； 

（3）加入版本号和团体名，构造报文； 

（4）进行BER编码，产生0/1比特串，发送出去。



#### TCP

telnet协议是一种()的远程登录协议。TCP



#### 邮件

**PGP**是支持**电子邮件加密**的协议

### 计算

假设一个IP数据报总长度为3000B，要经过一段MTU为1500B的链路，该IP数据报必须经过分片才能通过该链路。该原始IP数据报需被分成（）个片，若IP首部没有可选字段，则最后一个片首部中offset字段为（）。

一个IP数据报总长度为3000B（20B的首部和2980的数据），MTU为1500B，需要进行分片第一片长度是20B+1480B，第二片长度是20B+1480B，第三片长度是20B+20B，其中第三片的片偏移字段是2960/8=370.



某局域网采用CSMA/CD协议实现介质访问控制，数据传输速率为10Mbps，主机甲和主机乙之间的距离为2km，信号传播速度是200m/μs。若主机甲和主机乙发送数据时发生冲突。从开始发送数据起，到两台主机均检测到冲突时刻为止，**最短**需经过的时间是（ ）μs。

> 基带CSMA/CD:传输时延>=2倍于传播时延
>
> 宽带CSMA/CA:传输时延>=4倍于传播时延

在以太网中为了确保发送数据站点在传输时能检测到可能存在的冲突，数据帧的**传输时延至少要两倍与传播时延**（因为宽带CSMA/CD是单向传输）。由此可以算出传输时延≥2*2000/200=20μs。当冲突刚好发生在链路中间的时候，时间是最短的，所以是20μs/2=10μs。



12，设信道带宽为4000Hz，采用PCM编码，采样周期为125供，每个样本量化为128个等级，则信道的数据速率为（）。

PCM通过周期性扫描将时间连续幅度连续的模拟信号变换为时间离散、幅度连续的采样信号，量化过程将采样信号变为时间离散、幅度离散的数字信号，编码过程将量化后的离散信号编码为二进制码组。采样的频率决定了可恢复的模拟信号的质量。根据尼奎斯特采样定理，为了恢复原来的模拟信号，采样频率必须大于模拟信号最高频率的二倍。所以对带宽为4000Hz的信号的采样频率必须大于8000Hz，即125us。量化为128个等级，即用7位二进制编码来表示一个采样值，这样，7×8000=56Kb/s。



以100Mb/s以太网连接的站点A和B相距2000m，通过停等机制进行数据传输，传播速度为200m/us，最高的有效传输速率为（14）Mb/s。82.9

解析：**以太网数据帧最大1518字节，最小64字节**。**停等机制**说的就是，发送方把数据发过去，要停下来不能再发了，要等接收方发确认帧，收到之后再发。这里需要**计算两个时间，一个是发送时间，一个是传输时间**。

以太网数据帧最大为1518字节，姑且按最大帧计算，则**帧发送时间**：

1518*8/100mb/s=121.44us

数据**帧传播时间**=2000m/(200m/us)=10us

**题目指出采用停等传输机制，即收到确认帧后再发下一帧，确认帧是64B，则确认帧发送时间：**64*8/100Mb/s=5.12us

总时间：121.44us+5.12us+10us+10us=146.56us

则有效速率为：1518*8/146.56=82.9Mb/s（直接用1518，不用考虑MTU静载荷1500），故选B



海明码构造办法是:在数据位之间插入k个校验位,通过扩大码距来实现检错和纠错。设数据位是n位,校验位是k位,则n和k必要满足如下关系。

$2^k-1>=n+k$

数据为16位时,至少需要5位校验位

# 通信



![4311d3b6b5c5d1dba959ef3322f29d45](img/嵌入式/通信/4311d3b6b5c5d1dba959ef3322f29d45.png)

通信的目的就是传递信息。

![image-20240724151011615](img/计算机/计算机网络/image-20240724151011615.png)

**通信中产生和发送信息的一端叫作信源，接收信息的一端叫作信宿，信源和信宿之间的通信线路称为信道。**

## 通信方式和交换方式

- 按通信方向分

  - 单工通信：信息只能在一个方向传送，发送方不能接收，接收方不能发送（电视/广播）。
  - 半双工通信：通信的双方可以交替发送和接收信息，但不能同时接收或发送（对讲机/Wi-Fi/Hub）。
  - 全双工通信：通信双方可同时进行双向的信息传送（电话/交换机）。

- 同步方式

  <img src="img/计算机/计算机通信/image-20240726163150481.png" alt="image-20240726163150481" style="zoom: 50%;" />





## 信道特性

![image-20240724155740013](img/计算机/计算机网络/image-20240724155740013.png)

### 信道带宽

**带宽**

- 模拟信道：信号的带宽是所占据的频率范围。带宽按照信号频带范围公式W=f2-f1计算。f2和f1，分别表示：信道能通过的最高/最低频率，单位赫兹Hz 
- 数字信道。数字信道的带宽为信道能够达到的最大数据速率，传输速度的单位是每秒比特（**bit/s**）或每秒字节（**Byte/s**）

### 码元

- 码元传输速率：又称波特率，单位是Baud，单位时间内信道传送的码元个数

  如果**码元宽度（脉冲周期）为T**，则码元速率为B=1/T，单位是波特Baud。

- 一个码元携带信息量n（位）与码元种类数（N）的关系 n=log2N

- 数据传输速率：又称比特率，单位是bps或b/s，表示单位时间内传输的bit位数量。

**数据速率=码元速率x每个码元携带信息量**

### 信噪比

SNR（Signal-Noise Radio)，信号与噪声的功率之比。信噪比越高越好。

线性单位：
 ![SNR = \frac{P_s}{P_n} = (\frac{V_s}{V_n})^2](https://math.jianshu.com/math?formula=SNR%20%3D%20%5Cfrac%7BP_s%7D%7BP_n%7D%20%3D%20(%5Cfrac%7BV_s%7D%7BV_n%7D)%5E2)

以dB为单位：

$SNR (dB) = 10*log_{10}{\frac{P_s}{P_n}} \\ = 20*log_{10}{\frac{V_s}{V_n}}$

 ![P_s](https://math.jianshu.com/math?formula=P_s)表示信号的有效功率，![P_n](https://math.jianshu.com/math?formula=P_n)表示噪声的有效功率。

 ![V_s](https://math.jianshu.com/math?formula=V_s)表示信号的电压幅值（有效值），![V_n](https://math.jianshu.com/math?formula=V_n)表示噪声的电压幅值（有效值)。

### 香农 (Shanon) 定律（有噪声）

香农定理指出：在一条带宽为W（HZ），信噪比为S/N的有噪声极限数据速率

C=W*$log_2(1+S/N)$

C数据传输速率，W带宽，S为信号功率,N为噪声功率,S/N为信噪比,通常把信噪比表示成10lg(S/N)分贝(dB)



信道带宽为3kHz,信噪比为20dB,它的最大数据传输率是多少?（$log_{10}101$=2.004,log102=0.301）

信噪比：由10lg(S/N) = 20db ，可得 S/N = 100

香农定理：C=W * log2(1+S/N)， 可得3000*log2(1+100)≈20100b/s



设信道带宽为1000Hz，信噪比为30dB，则信道的最大数据速率约为( )b/s。

$C=W\times\log_2(1+\frac{s}{n})=1000\times10 = 10000bps$

dB=10 * lg(S/N),当S/N为1000时dB为30

速率为C = w * log(1 + S/N) = 1000 * 10 = 10000b/s

### 尼奎斯特定理（无噪声）

> C=W*$log_2(1+S/N)$ = $V_{max}=Blog_{2}N=2Wlog_{2}N$ 

尼奎斯特定理：**有限带宽无噪声信道**的**极限波特率**，若信道带宽为W（HZ）,则**最大码元速率B（波特率**）为：B=2W（baud）**(码元速率是带宽的两倍)**

由尼奎斯特定理可得：

$V_{max}=Blog_{2}N=2Wlog_{2}N$  单位（b/s），V是数据的速率，B是码元速率，N是波形的种类

> **采用四相位调制,表示有四种波形,为了标识这四种波形,至少需要2位,也就是用2位来表示一个码元**



某信道带宽为1MHz，采用4幅度8相位调制最大可以组成（14）种码元。若此信道信号的码元宽度为10微秒，则数据速率为（15）kb/s。
（14）A.5B.10C.16D.32
（15）A.50B.100C.500D.1000
【参考答案】（14）D（15）C
【summer解析】4幅度8相位调制最大可以组成32种码元。码元速率=1/码元宽度=1/10us=1/（10^-6s）=100000 baud，数据速率是R=Blog2N=10^5*log232=105\*5bit/s=500kb/s



设信道带宽为4kHz，采用4相调制技术，则信道支持的最大数据速率是 （ ） 。

$2H\log_2{k}=8000\log_24$



设信道带宽为4000Hz，采用PCM编码，采样周期为125供，每个样本量化为128个等级，则信道的数据速率为（）。

PCM通过周期性扫描将时间连续幅度连续的模拟信号变换为时间离散、幅度连续的采样信号，量化过程将采样信号变为时间离散、幅度离散的数字信号，编码过程将量化后的离散信号编码为二进制码组。采样的频率决定了可恢复的模拟信号的质量。根据尼奎斯特采样定理，为了恢复原来的模拟信号，采样频率必须大于模拟信号最高频率的二倍。所以对**带宽为4000Hz的信号的采样频率必须大于8000Hz，量化为128个等级，即用7位二进制编码来表示一个采样值，这样，7×8000=56Kb/s。**



例：设信道带宽为 3400Hz，调制为 4 种不同的码元，根据 Nyquist 定理，理想信道的数据速率为？

- 1，根据题意例出尼奎斯特定理算式：Vmax=2 W long 2N
- 2, 直接套入数字：Vmax=2x3400x$log_24$
- 3, Vmax=2x3400x2=13600b/S=13.6kb/s



例1：设信道采用2DPSK调制，码元速率为300波特，则最大数据速率为

解：Vmax=B log2N=300x1=300b/s  



<img src="img/嵌入式/通信/image-20240407174236434.png" alt="image-20240407174236434" style="zoom: 80%;" />

 

**QPSK采用了4种相位（二位二进制表示一种码元）**

传输信道频率范围为10-16MHz，采用QPSK调制，支持的最大速率为（）Mbps。

根据B=2W、R=Blog2N，可以算出B=2（16-10）=12M波特。由于是QPSK调制，N=4，所以R=Blog2N=12log24=24。



例2：在异步通信中，每个字符包含1位起始位，7位数据位，1位奇偶效验位和两位终止位，若每秒传送100个字符，采用4DPSK调制，则码元速率为？有效数据速率为？

- 1，根据题意计算数据速率为 （1+7+1+2）*100=1100b/s
- 2，由尼奎斯特定理得出，1100b/s=B*$log_24$
- 3，B=1100/2=550baud
- 4, 有效数据速率，即单位时间内传输的数据位，即7*100=700b/S

## 信道时延

时延是指一个报文或分组从一个网络的一端传送到另一个端所需要的时间。它包括了发送时延，传播时延，处理时延，排队时延。

往返时间RTT：数据报文在端到端通信中的来回一次的时间。

- 发送时延是主机或路由器发送数据帧所需要的时间，也就是从发送数据的第一个比特算起，到该帧的最后一个比特发送完毕所需的时间。发送时延也称为传输时延。

  - 发送时延 = 数据帧长度（b） / 信道带宽（b/s）


- 传播时延是电磁波在信道中传播一定的距离需要花费的时间。

  传播时延 = 信道长度（m） / 电磁波在信道上的传播速率（m/s）

  - 电信号在电缆上传播的速度为光速的2/3，即**200km/ms，200m/us**
  
  
    - 卫星**传播延迟**恒定为**270ms与地面距离无关**
  


- 处理时延：主机路由器在收到分组需要花费一定事件处理如分析分组首部，分组中提取数据，差错检验，查找路由等


- 排队时延

例：在相隔2000km的两地间通过电缆以4800b/s的速率传送3000比特长的数据包，从开始发生到接收数据需要的时间是？如果用50Kb/s的卫星信道传送，则需要的时间

对于电缆：

传输延迟T1=2000km/(200km/ms)=10ms

发送延迟T2=3000b/(4800b/s)=625ms

T=T1+T2=625ms+10ms=635ms

对于卫星：

传输延迟 T1=270ms

发送延迟 T2=3000 b/(50kb/s)=60ms

T=T1+T2=270ms+60ms=330ms



以太网的最大帧长为1518字节，每个数据帧前面有8个字节的前导字段，帧间隔为9.6μs，在**100BASE-T**网络中发送1帧需要的时间为（64）。
A.123μsB.132μςC.12.3ms D.13.2ms
【参考答案】B
【summer解析】发送时间：（1518+8）*8/（100\*10^6）=122.08us，由于没有告诉距离，忽略传输延时，题目中有帧间间隔，需要加上，合计122.08+9.6=131.68us=132us。



## 信道复用DM

https://blog.csdn.net/qq_39583450/article/details/113064219

https://blog.csdn.net/qq_28602957/article/details/53467950

**多路复用技术是把多个低速信道组合成一个高速信道的技术。**

这种技术要用到两个设备，

- 多路复用器（Multiplexer）在发送端根据某种约定的规则把多个低带宽的信号复合成个高带宽的信号；
- 多路分配器（Demultiplexer）在接收端根据同一规则把高带宽信导分解成您个低带宽信号。*多路复用器和多路分配器统称多路器，简写为MUX*

<img src="img/嵌入式/通信/微信图片_20240407163903.png" style="zoom:67%;" />

### 频分复用FDM

> 频分多路复用典型应用：无线电广播、**ADSL，FDD-LTE**

是指载波带宽被划分为多种不同频带的子信道，每个子信道可以并行传送一路信号的一种多路复用技术（共享时间）。
用户在分配到一定的频带后，在通信过程中始终都占用这个频带，例如下图中四个不同颜色代表四个用户所占用的频带。

![图示](https://img-blog.csdn.net/20161205173011359)

- 是按频率分割多路信号的方法，即将信道的可用频带分成若干互不交叠的频段，每路信号占据其中的一个频段。
- 在一般情况下可以通过正弦波调制的方法实现频分复用。
- 在接收端用适当的滤波器将多路信号分开，分别进行解调和终端处理。
- 当采用频分复用技术时，所有用户在同样的时间占用不同的带宽资源。

#### OFDM

OFDM(Orthogonal Frequency Division Multiplexing)即正交频分复用技术，实际上OFDM是MCM(Multi Carrier Modulation)，多载波调制的一种。**通过频分复用实现高速串行数据的并行传输**, 它具有较好的抗多径衰落的能力，能够支持多用户接入。 [1]

### 时分多路复用TDM

> 时分多路复用典型应用：**T1/E1、SONET/SDH，WIFI，TDD-LTE  **

- DM帧：将传输时间划分为多个等长的时间段-**时分复用帧**（TDM帧）
- 时隙：每个TDM帧划分成更小的时间段（时隙），每个用户在每个TDM帧中占用固定的时隙进行通信。类似分时OS的时间片概念。当采用时分复用时，所有用户在不同的时间占用同样的频带宽度（分时不分频）。

<img src="https://img-blog.csdn.net/20161205173553297" alt="图示" style="zoom:67%;" />

时分复用可能会造成线路资源的浪费

![图示](https://img-blog.csdn.net/20161205173702431)

### 码分复用CDM

码分复用是一种以**扩频技术**为基础的复用技术

码分复用CDM（Code Division Multiplexing）是各用户使用经过特殊挑选的**不同码型**，在同样的时间使用同样的频带进行通信，但彼此不会造成干扰。

这种系统发送的信号有很强的抗干扰能力，其频谱类似于白噪声，不易被敌人发现。

### 波分复用WDM

> 波分复用本质也是频分复用，就是光的频分复用。

光纤频率与波长关系：光速c=波长x频率

![图示](https://img-blog.csdn.net/20161205174225908)

使用在光纤通信中，不同的信道用不同的波长的光波承载。在同一根光纤中同时传输两个或众多不同波长光信号的技术，称为波分复用。

## 信号传输

### 数字信号的传输方式

[数字信号**](https://www.baidu.com/s?tn=62095104_41_oem_dg&wd=数字信号&usm=3&ie=utf-8&rsv_pq=c264619f0000a4ac&oq=数字信号是怎么传输的&rsv_t=0055B81v1Z35b%2FHFAdFaQ%2B2b2bgoxajOjhUxahd%2FaTwsxPxwiwFtJ2BG7%2F%2FNIQo28xWycKK5eQHz&sa=re_dqa_zy&icon=1)的传输方式主要有以下几种：

- [基带传输**](https://www.baidu.com/s?tn=62095104_41_oem_dg&wd=基带传输&usm=3&ie=utf-8&rsv_pq=c264619f0000a4ac&oq=数字信号是怎么传输的&rsv_t=2c69u3MSE1pdc%2F0SjrGx2AgXJFEkaYfpwvriEnkxAEODHtQ2AmLwYE%2FdToriS%2F3Zgn1kp2P%2F2hzp&sa=re_dqa_zy&icon=1)。这是最基本的**数字信号传输方式(PCM编码)**，它直接将数字信号在信道上进行传输，不包含任何调制。这种方式适用于短距离（如100米以内）的通信，因为它不需要将信号频谱搬移到高频处。基带传输系统中，数字信号通常经过编码和解码处理，以适应不同的传输介质和设备。

- [频带传输**](https://www.baidu.com/s?tn=62095104_41_oem_dg&wd=频带传输&usm=3&ie=utf-8&rsv_pq=c264619f0000a4ac&oq=数字信号是怎么传输的&rsv_t=291eGoP%2FFvmUzj%2ByvoJCdmpehCfSognkZ54yz25jNG9DAcLlhWDLxCKF%2BpEuhoiRX9xFRLZXDqbm&sa=re_dqa_zy&icon=1)。在这种方式中，数字信号首先被调制，以适应模拟信道，然后在接收端通过解调器进行解调，以恢复数字信号。常用的调制方法包括频率调制、振幅调制和相位调制。这种方式适用于远距离通信，因为它允许信号在有限的带宽内传输。1

- [载波传输**](https://www.baidu.com/s?tn=62095104_41_oem_dg&wd=载波传输&usm=3&ie=utf-8&rsv_pq=c264619f0000a4ac&oq=数字信号是怎么传输的&rsv_t=953aV%2FWeKDB3kGaEUFtwN4UmHjUJ3aWy2ogaR%2BYvKvxti0%2FNQRein2bp9oDL8CgATuZYj9rvEQGk&sa=re_dqa_zy&icon=1)。在这种方式中，数字信号被调制到载波（如正弦波）上，然后通过模拟信道进行传输。在接收端，信号被解调并还原为数字信号。这种方式适用于远距离或无线通信，因为它允许信号在高频频段内传输。
- [异步传输模式**](https://www.baidu.com/s?tn=62095104_41_oem_dg&wd=异步传输模式&usm=3&ie=utf-8&rsv_pq=c264619f0000a4ac&oq=数字信号是怎么传输的&rsv_t=953aV%2FWeKDB3kGaEUFtwN4UmHjUJ3aWy2ogaR%2BYvKvxti0%2FNQRein2bp9oDL8CgATuZYj9rvEQGk&sa=re_dqa_zy&icon=1)（[ATM**](https://www.baidu.com/s?tn=62095104_41_oem_dg&wd=ATM&usm=3&ie=utf-8&rsv_pq=c264619f0000a4ac&oq=数字信号是怎么传输的&rsv_t=953aV%2FWeKDB3kGaEUFtwN4UmHjUJ3aWy2ogaR%2BYvKvxti0%2FNQRein2bp9oDL8CgATuZYj9rvEQGk&sa=re_dqa_zy&icon=1)）。这是一种高速、面向连接的传输模式，它支持多种类型的数字化信息（如数据、语音和视频）的传输与交换。ATM采用固定长度的分组，并支持多种类型的服务质量（QoS）。

### 载波

载波是指被调制以传输[信号](https://www.elecfans.com/v/tag/106/)的波形，一般为正弦波，也可以是非正弦波（如周期性脉冲序列）。载波信号，**就是把普通信号（声音、图象）加载到一定频率的高频信号上**，在没有加载普通信号的高频信号时，高频信号的波幅是固定的，加载之后波幅就随着普通信号的变化而变化（调幅），还可以调相，调频。载波信号一般要求正弦载波的频率远远高于调制信号的带宽，否则会发生混叠，使传输信号失真

> 因为有用信息一般都是低频信号，不利于传播，所以要用一个高频的或者振幅更大的波（载波）来作为载体传播出去（频率越高越好传播）

作用包括：

1、减小传输中的噪声；

2、[频分复用](https://baike.baidu.com/item/频分复用/7626706?fromModule=lemma_inlink)，即同一频率之间同一信道传输多路信号而不[混叠](https://baike.baidu.com/item/混叠/6996184?fromModule=lemma_inlink)；

> 频分复用(FDM，Frequency Division Multiplexing)就是将用于传输信道的[总带宽](https://baike.baidu.com/item/总带宽/15660504?fromModule=lemma_inlink)划分成若干个子[频带](https://baike.baidu.com/item/频带/8872886?fromModule=lemma_inlink)（或称子信道），每一个子信道传输1路信号。频分复用要求总频率宽度大于各个子信道频率之和，同时为了保证各子信道中所传输的[信号](https://baike.baidu.com/item/信号/32683?fromModule=lemma_inlink)互不干扰，应在各子信道之间设立**隔离带**，这样就保证了各路信号互不[干扰](https://baike.baidu.com/item/干扰/33368?fromModule=lemma_inlink)（条件之一）。

3、可传播更远距离，有利于接收。

### 光波

**波行进一个周期所经过的距离称为“波长”**，用λ表示,以米为单位。　

f（频率）、T（周期）和λ（波长）存在如下关系:

c=λ/T=λ×f

其中,c是[电磁波](https://baike.baidu.com/item/电磁波/102449?fromModule=lemma_inlink)的[传播速度](https://baike.baidu.com/item/传播速度/5920231?fromModule=lemma_inlink),等于3x10^8米/秒。

### 信号调制编码

电(电压或电流),有直流和交流之分。在通信应用中,用作信号传输的一般都是[交流电](https://baike.baidu.com/item/交流电/1023508?fromModule=lemma_inlink)。呈正弦变化的交流[电信号](https://baike.baidu.com/item/电信号/1594125?fromModule=lemma_inlink),随着时间的变化,其幅度时正、时负以一定的能量和速度向前传播。

信号的“频率”：[正弦波](https://baike.baidu.com/item/正弦波/8995467?fromModule=lemma_inlink)幅度在1秒钟内的重复变化次数

周期：信号波形变化一次所需的时间,以秒为单位。



根据脉冲编码调制方案，**采样的频率决定了恢复的模拟信号的质量**。尼奎斯特采样定理说明，为了恢复原来的模拟信号，**采样领率必须大于模拟信号最高频率的二倍**

$f=\frac{1}{T}\geq2f_{max}$



### 数字调制

> **数字信号调制成模拟信号**

**数据的三种调制方法：**调幅、调频、调相，分别称为振幅键控ASK、移频键控FSK、移相键控PSK。

![](img/嵌入式/通信/a18bdd923a9699851c4e0013236bc8d4.png)



- ASK——幅移键控，通过调整振幅来表示不同数据；抗干扰性能较差

- FSK——频移键控，通过调整频率来表示不同数据；抗干扰性能好，但占用的带宽较大

- PSK——相移键控，通过调整相位来表示不同数据；

  > QPSK 是四相位调制技术，N=4；QPSK 中 N=4；8PSK 中 N=8；
  >
  > DPSK 中 N=2；
  >
  > BPSK 中N=2, 
  >
  > 4 幅度 8 相位调制最大可以组成 32 种码元

  - 绝对PSK（BPSK/2PSK，默认）

    绝对就是1，0相位固定

  - 相对PSK

    相对就是**自定义**如果和前面的相位相反为1，相同为0

    码元取两个相位值叫2相调制，码元取4个相位值叫4相调制，4相调制，一个码元代表两位二进制数

    - DPSK（相对）

      DPSK（Differential Phase Shift Keying，差分移相键控）是利用调制信号**前后码元之间载波相对相位的变化**来传递信息的。

      DPSK调制技术即差分相移键控，采用了**2种相位（一位二进制表示一种码元）**，通过前沿有无相位的改变来表示数据“0”和“1”。

    - QPSK

      采用了4种相位（二位二进制表示一种码元）

- 正交幅度调制（Quadrature AmplitudeModulation，QAM）是把两个**幅度相同**但相位相差**90**的模拟信号合成为一个载波信号

#### 4相调制

数据速率是码元速率的两倍(尼奎斯特)

### 脉冲编码调制PCM

> **模拟信号调制成数字信号**

> **属于基带传输**

PCM 即脉冲编码调制 (Pulse Code Modulation)。在PCM过程中，将输入的模拟信号进行采样、量化和编码，用二进制进行编码的数来代表模拟信号的幅度

抽样是把时间连续的模拟信号转换成**时间上离散、幅度连续的抽样信号**；

量化是把时间离散、幅度连续的抽样信号转换成**时间离散、幅度离散的数字信号**；

编码是将量化后的信号编码形成多位二进制码组成的码组表示抽样值，完成模拟信号到数字信号的转换。编码后的二进制码组经数字信道传输，在接收端，经过译码和滤波，还原为模拟信号。

#### 抽样

抽样是把[模拟信号](https://baike.baidu.com/item/模拟信号?fromModule=lemma_inlink)以其信号带宽2倍以上的频率提取样值，变为在时间轴上离散的抽样信号的过程。例如，话音信号带宽被限制**在0.3～3.4kHz内，用 8kHz的抽样频率（fs），最小抽样频率为8khz，不满8khz用8khz**，就可获得能取代原来连续话音信号的抽样信号。对一个正弦信号进行抽样获得的抽样信号是一个[脉冲幅度调制](https://baike.baidu.com/item/脉冲幅度调制/7878538?fromModule=lemma_inlink)（PAM）信号，对抽样信号进行检波和平滑滤波，即可还原出原来的模拟信号。

$f=\frac{1}{T}>=2f_{max}$

#### 量化

抽样信号虽然是时间轴上离散的信号，但仍然是[模拟信号](https://baike.baidu.com/item/模拟信号?fromModule=lemma_inlink)，其样值在一定的取值范围内，可有无限多个值。显然，对无限个样值一一给出数字码组来对应是不可能的。为了实现以数字码表示样值，必须采用“四舍五入”的方法把样值分级“取整”，使一定取值范围内的样值由无限多个值变为有限个值。这一过程称为量化。

<img src="img/嵌入式/通信/faedab64034f78f00a6b440077310a55b2191ce5.webp" style="zoom:50%;" />

量化后的抽样信号与量化前的抽样信号相比较，当然有所失真，且不再是模拟信号。这种量化失真在接收端还原模拟信号时表现为噪声，并称为量化噪声。量化噪声的大小取决于把样值分级“取整”的方式，分的级数越多，即量化级差或间隔越小，量化噪声也越小。

#### 编码

量化后的抽样信号在一定的取值范围内仅有有限个可取的样值，且信号正、负幅度分布的对称性使正、负样值的个数相等，正、负向的量化级对称分布。若将有限个 量化样值的绝对值从小到大依次排列，并对应地依次赋予一个十进制数字代码（例如，赋予样值0的十进制数字代码为0），在码前以“+”、“－”号为前缀，来 区分样值的正、负，则量化后的抽样信号就转化为按抽样时序排列的一串十进制数字码流，即十进制数字信号。简单高效的数据系统是二进制码系统，因此，应将十 进制数字代码变换成[二进制编码](https://baike.baidu.com/item/二进制编码?fromModule=lemma_inlink)。根据十进制数字代码的总个数，可以确定所需二进制编码的位数，即[字长](https://baike.baidu.com/item/字长?fromModule=lemma_inlink)。这种把量化的抽样信号变换成给定字长的二进制码流的 过程称为编码。

<img src="img/计算机/计算机通信/image-20241021000443799.png" alt="image-20241021000443799" style="zoom:50%;" />

- 极性编码

  - 单极性码：使用正极和零电平，正极表示0，零电平表示1。

  - 极性码：使用了两极，正极表示0，负极表示1。

  - 双极性码：使用了正负两极和零电平，典型的双极性码是信号交替反转编码AMI，它用零电平表示0；1则表示电平在正、负极间交替翻转。

    在双极型码中，0用0电平表示，1用电平翻转表示。由图可知第七位出错

    ![image-20240407164820759](img/嵌入式/通信/image-20240407164820759.png)

- 归零码  码元中间的信号回归到零电平，0表示由正极到零电平，1表示由负极到零电平。

- 不归零码NRZ：码元信号不回归零电平，出现1时电平翻转，0时不翻转，也称之为差分机制，是差分曼彻斯特编码的基础编码（仅翻转特性），不改变信号速率，编码效率最高。

  - 4B/5B编码（todo），效率80%。发送数据流每4bits，先转换成5bit，再转换为不归零码（NRZ-1）），**多1位用于解决同步问题。**

  > 4B/5B效率80%，用于百兆以太网
  >
  > 8B/10B效率80%，用于千兆以太网

- 双相码

  <img src="img/计算机/计算机通信/image-20241021000737642.png" alt="image-20241021000737642" style="zoom:67%;" />

  > - 特点：抗干扰性好，实现自同步。
  > - 显示：每一位都有一个电平转换，一高一低，必须翻转。每一个码元都要调制为两个不同的电平，因而**数据速率是码元速率的2倍**
  >
  > **数据速率=码元速率x每个码元携带信息量**

  - [曼彻斯特码Manchester ](https://baike.baidu.com/item/曼彻斯特码/8932867?fromModule=lemma_inlink)，又叫数字双相码
    
    用低到高的电平转换表示0，用高到低的电平转换表示1，**常用于以太网，编码效率50%（每一个比特由两个码元构成）。**
    
  - [差分曼彻斯特码](https://baike.baidu.com/item/差分曼彻斯特码/4010212?fromModule=lemma_inlink)，又叫条件双相码（CDP码）
    
    差分曼彻斯特编码是在曼彻斯特编码的基础上加上了翻转特性，遇1翻转，遇0不变，**常用于令牌环网。编码效率50%。**

## **考点**

### E1和T1

> 早期用在电话上

- 美国和日本使用T1标准，每路电话64k 

  T1=64k\*24 +开销与间隔=1.544M

  - T1载波的数据速率1.544mb/s，每个信道的数据速率是 （ ） kb/s。64

    - T3数据速率为**44.736Mb/s**

  - 在贝尔系统的T1载波中，每个信道的数据速率是（）kb/s。56

    - 整个贝尔T1系统的数据传输速率为24x56=1.344Mbps

- 中国，欧洲采用E1标准，每路电话64kb，传30路电话，2路开销。

  E1=64*30 + 64K\*2=2.048M。E1基本帧的传送时间**125us**，其中30个子信道用于**语音传送**，**2个子信道（CHO和CH16）用于控制信令。**E1载波的控制开销占 6.25% = 2/32\*100%，

  - E2由4个E1组成

  - E3由4个E2组成
    - E3数据速率是**34.368Mb/s** (约为34)

  - E1载波的基本帧由32个子信道组成，其中子信道（）用于传送控制信令。CH0和CH16

ITU V.90调制解调器（Modem）的下载速度为56kb/s，上传速率是33.6kb/s。

### 同步数字序列

SONET多路复用的速率

- oc-1速率，51.84

- 在光纤通信标准中，OC-3的数据速率是  （ ）  。155Mb/s


- 按照美国制定的光纤通信标准SONET，OC-48的线路速率是 （ ） Mb/s。oc-3 乘以16 = 2488.32



同步数字系列SDH (Synchronous Digital Hierarchy)中最常用的是

STM-1=OC-3(155.520 Mb/s、

STM-4(622.080 Mb/s、

STM-16（2488.320 Mb/s

STM-64（10Gb/s

利用SDH实现广域网互联，如果用户需要的数据传输速率较小，可以用准同步数字系列（PDH）兼容的传输方式在每个STM-1帧中封装　（ ）　个E1信道。63

### 背

总线复用可以减少总线中信号线的数量



POE (Power Over Ethernet)指的是在现有的以太网Cat.5布线基础架构不作任何改动的情况下，在为一些基于IP的终端（如IP电话机、无线局域网接入点AP、网络摄像机等）传输数据信号的同时，还能为此类设备提供直流供电的技术。 **POE也被称为基于局域网的供电系统。**

### 计算

8 个9600b/s 的信道按时分多路复用在一条线路上传输，在统计TDM 情况下，假定每个子信道有80%的时间忙，复用线路的控制开销为5%，那么复用线路的带宽为 （15） 。

（15）A．32kb/s B．64 kb/s C．72 kb/s D．96 kb/s

试题解析：

（8 * 9600）* 80% / （1-5%）≈ 64kb/s。



5个64kb/s 的信道按统计时分多路复用在一条主线路上传输，主线路的开销为4% ，假定每个子信道利用率为90% ，那么这些信道在主线路上占用的带宽为（）kb/s。

子信道利用率为90%,）因此复用后速率为： 5 * 64kbps * 90%=288kbps，又因为开销占了4%,t因此实际传送的数据只占96%，所以实际要占288/0.96=300kbps。



在PCM中，若对模拟信号的采样值使用64级量化，则至少需使用( )位二进制。

量化，就是把经过抽样得到的瞬时值将其幅度离散，即用一组规定的电平，把瞬时抽样值用最接近的电平值来表示，离散值的个数决定了量化的精度。64级量化，需要使用的二进制位数是6，因为2的6次方=64。



设信道带宽为3400HZ，采用PCM编码，采样周期为125μs，每个样本量化为256个等级，则信道的数据速率为( )。

采样周期125μs，f=1s/125us=8000Hz ,每秒采样8000次，256个量化级是8b，速率=8×8000=64Kb/s.





8条模拟信道采用TDM复用成1条数字信道，TDM帧的结构为8字节加1比特同步开销(每条模拟信道占1个字节)。若模拟信号频率范围为10~16kHz. 样本率至少为（ ）样本/秒，此时数字信道的数据速率为（ ） Mbps。 

采样频率应为信道最高频率的2倍，所以模拟信号频率范围为10~16kHz，那么样本率至少为16k * 2 =32kHz。 题干中声明，8条模拟信道采用TDM复用成1条数字信道，TDM帧的结构为8字节加1比特同步开销，其中1B为8 b，即一共有8 B * 8 b+1 b=65b。1个采样样本占65比特，则数据速率为32k*65b=2080kbps=2.08mbps 

点拨： 其中32kHz是每秒采样的样本数，即每秒采样32k个样本



若**8进制**信号的信号速率是4800Baud，则信道的数据速率为()kb/s。
A.9.6
B.14.4
C.19.2
D.38.4

8进制 ->3位二进制 4800*3



设信号的波特率为1000Baud，信道支持的最大数据速率为2000b/s，则信道采用的调制技术为
（11）。
A.BPSKB.QPSK D.BFSKD.4B5B
【参考答案】B
【summer解析】C=Blog2N 2000=1000log2N，N=4，只有QPSK是4项调制，N=4，

### 传输

在地面上相隔2000KM的两地之间通过卫星信道传送4000比特长的数据包，如果数据速率为64Kb/S，则从开始发送到接收完成需要的时间是 （ ） 

卫星信道的传输延迟为270ms，4000比特数据包 发送时间为4000b/64kb/s=62.5ms，二者相加 270+62.5=332.5ms。



在地面上相距2000公里的两地之间通过电缆传输4000比特长的数据包，数据速率为64Kb/s，从开始发送到接收完成需要的时间为（ ）。72.5ms

电缆传播速度200km/ms



两个部件的可靠度R均为0.8，由这两个部件串联构成的系统的可靠度为 （1） ；由这两个部件并联构成的系统的可靠度为 （2） 。 （1）

本题知识点：广域通信网 Cnitpm.com, 串联的可靠度=R*R=0.64。 并行的可靠度=1-(1-R)(1-R)=1-0.04=0.96



# 无线通信网

## 移动通信

![image-20240803172635736](img/计算机/计算机通信/image-20240803172635736.png)

我国自行研制的移动通信3G标准是 （ ） 。TD-SCDMA(TD和CDMA的结合)

**不属于4G标准的是WCDMA**

LTE、LTE-Advanced、WIMAXII、Wireless MAN、UMB等属于4G标准

4G无线通信采用的载波调制技术是OFDM， 5G采用改进的 F-OFDM

5G网络采用()可将5G网路分割成多张虚拟网路。网路切片技术

4G移动通信标准TDD-LTE与FDD-LTE的区别是（）。划分上下行信道的方式不同，前者用时分多路方式，而后者用频分多路方式

## WLAN通信技术

无线网主要使用三种通信技术：

- **红外线**

- **扩展频谱（扩频）**：将信号散步到更宽的带宽上以**减少发送阻塞和干扰**的机会。

  WLAN主要使用扩展频谱技术：**频率跳动扩频FHSS（蓝牙）和直接序列扩展频谱DSSS（Wi-Fi）**。

  **跳频扩频是在时间周期后跳到另一个载频上，减少了干扰，并不能扩大通信的范围，选项b错误。**

- **窄带微波技术。**



## WLAN网络分类

WLAN网络可以分为三类：基础无线网络、Ad Hoc网络和分布式无线系统。

- 基础无线网络（Infrastructure Networking）：用户通过无线接入点AP接入。

- 特殊网络（Ad Hoc Networking）：用于军用自组网或寝室局域网联机游戏。

  802.11定义AD Hoc网络是由无线移动节点组成的对等网，无需网络基础设施的支持，**每个节点既是主机，又是<u>路由器</u>**，是一种MANNET（Mobile Ad Hoc Network）网络。

  特点：

  - **网络拓扑结构动态变化的，不能使用传统路由协议。**
  - **无线信道提供的带宽较小，信号衰落和噪声干扰的影响却很大。**
  - 无线终端携带的电源能量有限。
  - **容易招致网络窃听、欺骗、拒绝服务等恶意攻击的威胁。**

  关于移动Ad Hoc网络MANET，（）不是MANET的特点。

  在移动ad hoc网络manet中，每一个结点既是主机又是路由器，而且无线终端所带的电源能量有限，所以必须以最节能的方式工作。由于无线终端的移动，使得网络拓扑结构随时变化，**传统的路由协议是不适用的**，必须釆用特别研制路由协议来支持最佳路由的选择。

- 分布式无线系统：通过AC控制大量AP组成的无线网络。

![image-20240804152044038](img/计算机/计算机通信/image-20240804152044038.png)





## AC无线控制器/AP节点

对于小型网络部署无线环境，AP可以使用Fat模式通过无线桥接的方式进行互联，但是这种部署方式会存在网络稳定性差，不能实现无缝漫游。所以在中大型的无线局域网部署中一般采用AC无线控制器和Fit模式的AP进行部署。AC是一种网络设备，用来集中化控制管理无线AP，对AP进行下发配置、修改相关配置参数、安全控制等

#### 知识点

无线漫游是由无线客户端而不是AP发起的(AP:**无线访问接入点**)

> AP就是传统有线网络中的HUB，也是组建小型[无线局域网](https://so.csdn.net/so/search?q=无线局域网&spm=1001.2101.3001.7020)时最常用的设备。AP相当于一个连接有线网和无线网的桥梁，其主要作用是将各个无线网络[客户端](https://baike.baidu.com/item/客户端/101081)连接到一起，然后将无线网络接入以太网。

1、AP：

无线AP即[无线接入点](https://zhidao.baidu.com/search?word=%CE%DE%CF%DF%BD%D3%C8%EB%B5%E3&fr=iknow_pc_qb_highlight)，它用于[无线网络](https://zhidao.baidu.com/search?word=%CE%DE%CF%DF%CD%F8%C2%E7&fr=iknow_pc_qb_highlight)的无线交换机，也是无线网络的核心，简单的说就是功能增强版无线路由器

2、AC：

AC是用来管理AP用的，可以对AP进行集中式管理

3、WIFI：

Wi-Fi是一种可以将个人电脑、手持设备等终端以无线方式互相连接的技术。Wi-Fi是一个无线网路通信技术的品牌，由Wi-Fi联盟所持有。

4、WLAN：

WLAN是Wireless Local Area Network的简称，指应用无线通信技术将计算机设备互联起来，构成可以互相通信和实现资源共享的网络体系。

#### 1.AC模式

（1）路由模式：部署在局域网边界。可以代替路由器，具备基本的路由转发及NAT功能。
（2）网桥模式：设备以网桥模式部署时对客户原有的网络基本没有改动，相当于透明串接在网络中，可以做行为管理，一般部署在边界路由器与交换机之间的链路。具体的部署位置根据网络需求而定。
（3）旁路模式：旁路模式主要用于实现监控功能，一般以旁挂的方式部署在核心交换机或汇聚交换机。

#### 无线控制器转发模式

（1）本地转发（直接转发）
管理数据和业务数据分开，业务数据从AP直接转发，无隧道封装，AC只负责管理AP，包括为AP下发控制器系统版本，管理模板等。
优势：减少AC的负载；AC故障不影响业务。
劣势：不易排查问题；功能实现不全；不利于收集和分析数据。

（2）集中转发
无线终端STA所有的上网业务数据到达AP后，由AP进行数据封装，由AP集中转发给AC，再由AC解
封装后将数据业务集中转发出去上网。
优势：便于管理，功能实现全面；网络规划更加灵活；便于扩展新功能。
劣势：单点故障；AC吞吐、负载高



##### AP的种类

**AP分为室内AP与室外AP**

**（1）室内AP分为吸顶式AP、面板式AP、桌面式AP， 一般功率小，覆盖范围小。**

**（2）室外AP一般功率大，覆盖范围大，抗干扰性能好，适应自然环境。**



##### AP的部署

无线网络覆盖要求AP部署时，AP之间覆盖范围要有一定重叠，且不同AP的工作信道要尽量分开，避免信道干扰。根据网络覆盖范围大小，环境中障碍物对无线信号的影响等因素，优化AP点位的部署。距离AP越远，或者障碍物越多，信号衰减越大。信号衰减一般由-db表示，值越小，证明信号衰减越小，信号质量越高



AP的供电方式：

（1）电源供电：成本高，灵活性差
（2）POE供电：通用方式，利用POE交换机供电。POE供电系统由供电端设备（PSE）
和受电端设备（PD）组成。POE供电遵循IEEE 802.3af和IEEE 802.3at标准，IEEE 
802.3af标准的受电设备功率上限13W，而IEEE 802.3at的受电设备功率提高至25W







## WLAN频谱和信道

### 频段

频段：**无线通信**使用的是电磁波，既然是波，那就有频率，通过将电磁波的频率划分为不同的 “段”，即是**频段（是指一个连续电磁波的频率范围）**

![img](https://pic2.zhimg.com/80/v2-5561011e61f9ea85c44e0e524615d289_720w.webp)

通常无线路由器都会有两个频段：2.4GHz和5GHz。之所以叫2.4G，是因为这个频段的频率范围为：2.4GHZ~2.4835GHZ。5G频率范围是5.15-5.825GHz

**波长=波速 \* 周期=波速/频率，所以频率越高，波长越短**

![img](https://pic4.zhimg.com/80/v2-e676b3d47ba6bbcd13e540194ccc27b7_720w.webp)

### 信道

信道就是在频段基础上的更进一步的划分。信道是指的通过时间、频率来切分出来的可以分配给不同终端使用的资源。目的是为了避免很多个设备之间的竞争

> **既然是避免冲突，为什么不多划分很多信道呢？**
>
> 首先，信道越多，那每个信道的宽度就很窄了，信道里边终端的冲突概率就变得更大了，如果想要避免或是减少冲突，那么则需要花费更多的时间来监测冲突，有问题的情况下，还需要重发数据包，那么速度肯定也提不上去。

2,4G频段一共有13个信道，但在**中国只允许使用前13个信道**。每个信道22MHZ宽，实际使用来传输数据的只有20MHZ宽，其余的2MHZ用来隔离信道，就好比马路两侧的绿化带

![img](https://pic1.zhimg.com/80/v2-58eb2cd9b6aadf439bb27435b88c3c30_720w.webp)

**在2.4GHz频段，1、6和11是唯一不重叠的频道。**所以，两个设备要相隔5个信道才不会相互干扰，即1、6、11相互隔开，**致使一个区域只能有3个无线设备**

![在这里插入图片描述](https://img-blog.csdnimg.cn/ac5bd1e651dd47c79e00a536d61e375a.png)



## 802.11

![image-20240804154234440](img/计算机/计算机通信/image-20240804154234440.png)

![image-20240804154401690](img/计算机/计算机通信/image-20240804154401690.png)

802.11/wifi1,11b和11a/wifi2,后面依次，到**11ax/wifi6**

1.Wi-Fi标准的工作频段。

- 2.4GHz：802.11，802.11b和802.11g 
- 5GHz：802.11a和802.11ac；
- 2.4GHz+5GHz 802.11n和802.11ax.

2，非重叠信道数量。2.4GHz频段包含13个信道，有3个不重合信道，常用信道为1、6和11，不重合信道间隔5个信道。

3，不同802.11标准的最大速率。比如，802.11n最大支持600Mbps，802.11ax速率可达9600Mbps.

### MAC层

#### 802.11访问控制机制

802.11标准为MAC子层定义了3种访问控制机制。

- CSMA/CA（载波侦听/冲突避免）分布式协调功能:大家争用访问(有竞争)。能够解决隐蔽终端和暴露终端问题。（CSMA/CD 只能检测） 

  > 为什么不用CSMA/CD？这种协议不能解决隐蔽站的问题
  >
  > ![image-20240804162604500](img/计算机/计算机通信/image-20240804162604500.png)

- RTS/CTS信道预约：**要发送先打报告**，其他终端记录信道占用时间。

- PCF点协调功能：由**AP集中轮询**所有终端，将发送权限轮流交给各个终端，类似令牌**（无竞争）**。



## WLAN安全机制

- （1）SSID访问控制：隐藏SSID，让不知道的人搜索不到。
- （2）物理地址过滤：在无线路由器设置MAC地址黑白名单。
- （3）加密
  - （3）WEP认证和加密：**PSK预共享密钥认证，RC4加密。**
  - （4）WPA（802.11i草案）
    - 认证：802.1x。
    - 加密：**RC4（增强）+TKIP（临时密钥完整协议，动态改变密钥）支持完整性认证和防重放攻击。**

  - （5）WPA2（802.11i）
    - **针对WPA优化，加密协议是由RC4变为基于AES的CCMP。**


### 背

Wi-Fi联盟制定的安全认证方案WPA（Wi-Fi Protected Access）是  ( )  标准的子集。802.11i

Wi-fi联盟认可了802.11i标准，并称之为wap2。WPA2无线加密协议**CCMP**是基于**AES**加密

无线局域网通常采用的加密方式是**WPA2**，其安全加密算法是（）。**AES和TKIP**

**在Wi-Fi安全协议中，WPA与WEP相比，采用了（ ）。临时密钥以减少安全风险**





## wlan数据转发方式

**数据转发方式**

WLAN网络中的数据包括控制报文（管理报文）和数据报文。

控制报文是通过CAPWAP的控制隧道转发的

用户的数据报文分为

- 隧道转发（又称为“集中转发”）方式
- 直接转发（又称为“本地转发”）方式
- Soft-GRE转发方式。

**隧道转发方式**

隧道转发方式是指用户的数据报文到达AP后，需要经过**CAPWAP**数据隧道封装后发送给AC，然后由AC再转发到上层网络，如下图

![img](https://img-blog.csdnimg.cn/918f38f95fab457b92b63cbd760faa67.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a-M6LS15a2Z5oKf56m6,size_8,color_FFFFFF,t_70,g_se,x_16)

 **直接转发方式**

直接转发方式是指用户的数据报文到达AP后，不经过CAPWAP的隧道封装而直接转发到上层网络，如下图

![img](https://img-blog.csdnimg.cn/71b623e65235495288178948e5b07b38.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a-M6LS15a2Z5oKf56m6,size_8,color_FFFFFF,t_70,g_se,x_16)

直接转发方式的集中认证

如果采用直接转发方式，业务数据不经过AC转发。当无线用户接入网络需要进行用户接入认证（例如，802.1X认证等）且接入控制点部署在AC上时，用户的认证报文就无法通过AC集中管理，这就给管理员对用户的统一控制造成了不便。所以在直接转发方式下AC会将用户的**认证报文**通过CAPWAP隧道集中到AC转发，如图3。

隧道转发方式、直接转发方式优缺点：

| 数据转发方式 | 优点                                                         | 缺点                                                         |
| ------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 隧道转发     | AC集中转发数据报文，**安全性更高，方便集中管理和控制**，新增设备部署配置方便，对现网改动小。 | 业务数据必须经过AC封装转发，报文转发效率比直接转发方式低，AC所受压力大。 |
| 直接转发     | 业务数据不需要经过AC封装转发，报文转发效率高，AC所受压力小。 | 业务数据不便于集中管理和控制，新增设备部署对现网改动大。     |

## 背

WLAN接入安全控制中，采用的安全措施有：

- 更改默认设置
- 更新AP的Firmware屏蔽SSID广播
- 加密和认证
- MAC地址过滤，物理地址过滤
- WPA2安全认证

# 网络安全

## 网络攻击分类

**主动攻击会破坏原本的传输内容或过程，被动攻击是窃听和分析**

被动攻击：**典型代表嗅探、监听和流量分析**，最难被检测，重点是预防，主要手段是**加密**。

- 窃听：例如搭线窃听、安装通信监视器和读取网上的信息等。
- 流量分析：对网上信息流观察和分析推断出网上传输的有用信息

主动攻击：**假冒、重放、欺骗、会话拦截、消息篡改和拒绝服务等，重点是检测而不是预防，手段有防火墙、IDS(入侵检测系统)等技术**

- 假冒：当一个实体假扮成另一个实体进行网络活动时就发生了假冒。

- 重放：重放攻击指的是攻击者在通信过程中截获并重复发送之前捕获的合法通信数据，以欺骗系统或者获得非法访问权限。攻击者可以通过重放攻击绕过身份验证、发送恶意请求或者窃取敏感信息。

  措施：**随机数，时间戳**

- 数据完整性破坏

- 分布式拒绝服务（Distributed Denial of Service，简称DDoS）将多台计算机联合起来作为攻击平台，通过远程连接，利用恶意程序对一个或多个目标发起DDoS攻击，**消耗目标服务器性能或网络带宽，从而造成服务器无法正常地提供服务。**

  - 攻击原理

    通常，攻击者使用一个非法账号将DDoS主控程序安装在一台计算机上，并在网络上的多台计算机上安装代理程序。在所设定的时间内，主控程序与大量代理程序进行通讯，代理程序收到指令时对目标发动攻击，主控程序甚至能在几秒钟内激活成百上千次代理程序的运行。

    <img src="https://img-blog.csdnimg.cn/img_convert/f8153905c6e3ca28cb91de73f24bd8bf.webp?x-oss-process=image/format,png" alt="image-20221118093423876" style="zoom:50%;" />

  - 常见的DDoS攻击类型

    | DDoS攻击分类      | 攻击子类                                                     | 描述                                                         |
    | :---------------- | :----------------------------------------------------------- | :----------------------------------------------------------- |
    | 畸形报文          | 畸形报文主要包括Frag Flood、Smurf、Stream Flood、Land Flood、IP畸形报文、TCP畸形报文、UDP畸形报文等。 | 畸形报文攻击指通过向目标系统发送有缺陷的IP报文，使得目标系统在处理这样的报文时出现崩溃，从而达到拒绝服务的攻击目的。 |
    | 传输层DDoS攻击    | 传输层DDoS攻击主要包括**Syn Flood**、Ack Flood、UDP Flood、ICMP Flood、RstFlood等。 | 以Syn Flood攻击为例，它利用了TCP协议的三次握手机制，当服务端接收到一个Syn请求时，服务端必须使用一个监听队列将该连接保存一定时间。因此，通过向服务端不停发送Syn请求，但**不响应Syn+Ack报文**，从而消耗服务端的资源。当监听队列被占满时，服务端将无法响应正常用户的请求，达到拒绝服务攻击的目的。 |
    | DNS DDoS攻击      | DNS DDoS攻击主要包括DNS Request Flood、DNS Response Flood、虚假源+真实源DNS Query Flood、权威服务器攻击和Local服务器攻击等。 | 以DNS Query Flood攻击为例，其本质上执行的是真实的Query请求，属于正常业务行为。但如果多台傀儡机同时发起海量的域名查询请求，服务端无法响应正常的Query请求，从而导致拒绝服务。 |
    | 连接型DDoS攻击    | 连接型DDoS攻击主要是指TCP慢速连接攻击、连接耗尽攻击、Loic、Hoic、Slowloris、 Pyloris、Xoic等慢速攻击。 | 以Slowloris攻击为例，其攻击目标是Web服务器的并发上限。当Web服务器的连接并发数达到上限后，Web服务即无法接收新的请求。Web服务接收到新的HTTP请求时，建立新的连接来处理请求，并在处理完成后关闭这个连接。如果该连接一直处于连接状态，收到新的HTTP请求时则需要建立新的连接进行处理。而当所有连接都处于连接状态时，Web将无法处理任何新的请求。Slowloris攻击利用HTTP协议的特性来达到攻击目的。HTTP请求以`\r\n\r\n`标识Headers的结束，如果Web服务端只收到`\r\n`，则认为HTTP Headers部分没有结束，将保留该连接并等待后续的请求内容。 |
    | Web应用层DDoS攻击 | Web应用层攻击主要是指HTTP Get Flood、HTTP Post Flood、CC等攻击。 | 通常应用层攻击完全模拟用户请求，类似于各种搜索引擎和爬虫一样，这些攻击行为和正常的业务并没有严格的边界，难以辨别。Web服务中一些资源消耗较大的事务和页面。例如，Web应用中的分页和分表，如果控制页面的参数过大，频繁的翻页将会占用较多的Web服务资源。尤其在高并发频繁调用的情况下，类似这样的事务就成了早期CC攻击的目标。由于现在的攻击大都是混合型的，因此模拟用户行为的频繁操作都可以被认为是CC攻击。例如，各种刷票软件对网站的访问，从某种程度上来说就是CC攻击。CC攻击瞄准的是Web应用的后端业务，除了导致拒绝服务外，还会直接影响Web应用的功能和性能，包括Web响应时间、数据库服务、磁盘读写等。 |

  措施

  **配置最小特权访问策略、部署IPS防护、启用防火墙的防DDOS功能、购买流量清洗服务、停止不必要的服务端口等。**



- SQL注入攻击

  SQL注入攻击：黑客从正常的网页端口，进行网站访问，通过巧妙构建SQL语句，获取数据库敏感信息，或直接向数据库插入恶意语句。

  SQL注入攻击防范的主要方法如下：

  - 对用户输入做严格检查，防止恶意SQL输入。
  - 部署DBS数据库审计系统、WAF，进行安全阻断。

- 跨站脚本攻击

  跨站脚本攻击（Cross Site Script，为了区别在CSS简称为XSS）指的是恶意攻击者往Web页面里插入恶意html代码，当用户浏览该页之时，嵌入其中Web里面的html代码会被执行，从而达到恶意用户的特殊目的。

  XSS跨站脚本攻击核心都是利用了脚本注入，

  因此解决办法其实很简单：

  - 对用户输入进行过滤，对特殊字符如”<”，”>”转义，可以从根本上防止这一问题。

  - 部署WAF，防火墙，自动过滤攻击报文

### 病毒

**病毒：指一段可执行的程序代码**，通过对其他程序进行修改，可以感染这些程序使其含有该病毒程序的一个拷贝。

病毒四个阶段：

- 潜伏阶段（震网病毒）
- 繁殖阶段（勒索病毒）
- 触发阶段（震网病毒）
- 执行阶段

计算机病毒的分类方法有许多种，按照最通用的区分方式，即根据其感染的途径以及采用的技术区分，计算机病毒可分为文件型计算机病毒、引导型计算机病毒、宏病毒和目录型计算机病毒。

-  文件型计算机病毒感染可执行文件（包括EXE和COM文件
-  引导型计算机病毒影响软盘或硬盘的引导扇区。
-  目录型计算机病毒能够修改硬盘上存储的所有文件的地址。
-  宏病毒感染的对象是使用某此程序创建的文本文档、数据库、电子表格等文件，从文件名可以看出Macro.Melissa是一种宏病毒。

#### 病毒的分类和命名规则

病毒名称的一般格式为<病毒前缀>.<病毒名>.<病毒后缀>。

- 病毒前缀是指病毒的种类，不同种类的病毒其前缀是不同的。比如常见的木马病毒的前缀为Trojan，蠕虫病毒的前缀是Worm等。
- 病毒名是指一个病毒的家族特征，例如CIH 病毒的家族名是“CIH”，振荡波蠕虫病毒的家族名是"Sasser”。
- 病毒后缀是用来区别某个家族病毒的不同变种的，一般都采用英文字母来表示，如Worm.Sasser.b就是指振荡波蠕虫病毒的变种b。如果病毒变种非常多，可以采用数字与字母混合表示

![image-20240822231316823](img/计算机/计算机网络/image-20240822231316823.png)



- 杀毒软件报告发现病毒Macro.Melissa，由该病毒名称可以推断出病毒类型是  （1）  ，这类病毒主要感染目标是  （2）  宏病毒，word/excel

- 震网（Stuxnet）病毒于2010年6月首次被检测出 来，是第一个专门定向攻击真实世界中基础（能 源）设施的**“蠕虫”病毒**。这种病毒可以破坏世界各 国的化工、发电和电力传输企业所使用的核心生 产控制电脑软件。


- 木马
  - **C&C**
  - 一句话木马：eval（）
  - x卧底通过木马形式感染智能手机

## 安全技术

任何形式的网络服务都会导致安全方面的风险，问题是如何将风险降低到最低程度，目前的网络安全措施有数据加密、数字签名、身份认证、防火墙和入侵检测等。

- 数据加密。数据加密是通过对信息的重新组合，使得只有收发双方才能解码并还原信息的一种手段。随着相关技术的发展，加密正逐步被集成到系统和网络中。在硬件方面，已经在研制用于 PC 和服务器主板的加密协处理器。
- 认证又分为实体认证和消息认证两种。

  - **实体认证**是识别通信对方的身份，防止假冒，可以使用数字签名、密码技术、利用人体生理特征（如指纹）进行识别、智能IC卡和USB盘等的方法。
    - **数字签名 RSA**。数字签名可以用来证明消息确实是由发送者签发的，而且，当数字签名用于存储的数据或程序时，可以用来验证数据或程序的完整性。
  - **消息认证**是验证消息在传送或存储过程中有没有被篡改，通常使用**报文摘要方法 MD5**的方法。
- 防火墙。防火墙是位于两个网络之间的屏障，一边是内部网络（可信赖的网络），另一边是外部网络（不可信赖的网络）。按照系统管理员预先定义好的规则控制数据包的进出。
- 内容检查。即使有了防火墙、身份认证和加密，人们仍担心遭到病毒的攻击。

### 信息加密

![image-20240818234004566](img/计算机/计算机网络/image-20240818234004566.png)

#### 私钥密码/对称加密算法

**加密密钥和解密密钥相同的算法**，称为对称加密算法，**对称加密算法相对非对称加密算法加密的效率高**，适合大量数据加密。

优点：加解密速度快、密文紧凑、使用长密钥时的难破解。

缺点：密钥分配问题、密钥管理问题、无法认证源。

常见的对称加密算法有DES、3DES、AES、RC4/5、IDEA

- DES：**共享密钥的加密算法**
  - 数据加密标准（DES）：一种分组密码，在加密前，先对整个明文进行分组。每一个分组为64位，之后进行16轮迭代，产生一组64位密钥，**有效密钥是56位**。
  
  - 3DES：使用DES对明文进行**"加密-解密-加密“**操作。**使用两个密钥，执行三次DES算法，密钥长度是112位（56*2=112）**
  
    加密：K1加密→K2解密→K3加密
  
    解密：K3解密→K2加密-K1解密
  
    一般K1和K3是相同的密钥。
  
- IDEA：**明文和密文分组都是64位，密钥长度128位**

- AES：高级加密标准。可以通过硬件实现，速度快，像3DES一样安全。

  - aes-128(密钥)
  - aes-192
  - aes-256
  
- RC：**流加密算法，用于WIFI**。加密速度快，可达到DES的10倍。分组和密钥长度都可变

  - RC-4：常用**流密码，密钥长度可变**
  - RC-5：**适合对大量的明文消息进行加密传输的**

#### 公钥密码/非对称加密算法

> **公开密钥加密也称为非对称密钥加密。**
>
> **公钥用于加密和认证**

加密密钥和解密密钥不相同的算法，称为非对称加密算法，这种方式又称为公钥密码体制，**解决了对称密钥算法的密钥分配与发送的问题**。

- 优点：密钥分发方便、密钥保管量少、支持数字签名。
- 缺点：加密速度慢（计算量大，**不适合加密大数据**）、数据膨胀率高。

每个实体有两个密钥：公钥公开，私钥自己保存。

- **公钥加密，私钥解密，可实现保密通信**
- **私钥加密，公钥解密，可实现数字签名**

常见的非对称加密算法如下：

- RSA

  ![image-20230516172356421](img/计算机/计算机网络/image-20230516172356421.png)

  mod求余数

  按RSA算法求公钥和密钥：

  （1）选两质数p=5，q=3；
  （2）计算n=p×q=5×3=15；
  （3）计算（p-1）×（q-1）=8；
  （4）公钥e=7，则依据e*d=1 mod（p-1）×（q-1），即7d=1 (mod 8) -> 7d mod 8 = 1(余数)

  结合四个选项，得到d=7，即49 mod 8=1。

- ECC

#### 混合密码

发送方用对称密钥加密需要发送的消息，再用接收方的公钥加密对称密钥，然后一起发送给接收方，接收方先用自己的私钥解密得到对称密钥，再用对称密钥解密得到明文。国产加密算法——SM 系列 是指由国家密码研究相关机构自主研发，具有相关知识产权的商用密码算法，目前己经公布的国产密码算法如下:（2 非 3 杂 14 对） 



### Hash算法/摘要算法

HASH函数，又称为杂凑函数、散列函数，它能够**将任意长度的信息转换成固定长度的哈希值（MD5 128位，SHA 160位）**，并且任意不同消息或文件所生成的哈希值是不一样的。

哈希函数特性：

- **不可逆性（单向）**：几乎无法通过Hash结果推导出原文，即无法通过x的Hash值推导出x
- 碰撞性：几乎没有可能找到一个y，使得y的Hash值等于x的Hash值

- 雪崩效应：输入轻微变化，Hash输出值产生巨大变化

常见的Hash算法有：

- （1）MD5算法：以512位数据块为单位来处理输入，产生**128**位的信息摘要。常用于文件校验。
- （2）SHA算法：以512位数据块为单位来处理输入，产生**160**位的哈希值，具有比MD5更强的安全性。
- （3）SM3国产算法：消息分组长度为512比特，输出**256**位摘要。

作用：

- 文件完整性校验

  <img src="img/计算机/计算机网络/image-20240819094804611.png" alt="image-20240819094804611" style="zoom:50%;" />


  - 账号密码存储

    <img src="img/计算机/计算机网络/image-20230516180120088.png" alt="image-20230516180120088" style="zoom:50%;" />

  - 用户身份认证

    <img src="img/计算机/计算机网络/image-20240819094517660.png" alt="image-20240819094517660" style="zoom:50%;" />



### 数字签名和证书

> 数字签名好比现实中你的签字
>
> 数字证书好比现实中你的身份证 

##### 数字签名

**签名方用自己的私钥进行签名，对方收到后，用签名方的公钥进行验证。**

数字签名算法（**公钥加密算法**）：**RSA**，Rabin，ELGamal签名体制和DSS标准。

数据签名是用于**确认发送者身份和消息完整性**的一个加密消息摘要，具有如下特点：

- 数字签名是可信的。
- 数字签名不可伪造。
- 数字签名不能重新使用。
- 签名文件是不能改变的。
- 数字签名不能抵赖。
- 接收者能够核实发送者身份。

![image-20240819100111545](img/计算机/计算机网络/image-20240819100111545.png)

##### 数字证书

> 场景：A 声明自己是某银行办事员向客户索要账户和密码，客户验证了 A 的签名，确认索要密码的信息是 A 发过来的，那么客户就愿意告诉A用户名和密码么？
> 显然不会。因为客户仅仅证明信息确实是 A 发过来的没有经过篡改的信息，但不能确认 A 就是银行职员、做的事情是否合法。这时需要有一个权威中间部门M（如政府、银监会等），该部门向 A 颁发了一份证书，确认其银行职员身份。这份证书里有这个权威机构 M 的数字签名，以保证这份证书确实是 M 所发。

###### Kerberos和PKI

**PKI体制中，保证数字证书不被篡改的方法是：用CA的私钥对数字证书签名**

- Kerberos

  - 向as申请许可票据
  - 向TGS申请会话票据

- PKI

  - 注册机构RA:负责受理用户申请证书，对申请人的合法性进行认证，并决定是批准或拒绝证书申请。**注册机构并不给用户签发证书而只是对用户进行资格审查。**

  - 证书颁发机构CA:负责给用户颁发、管理和撤销证书。**较小的机构，可以由CA兼任RA的工作**


![image-20240821001909736](img/计算机/计算机网络/image-20240821001909736.png)

### 网络协议

##### **web/Portal认证**

Portal认证的基本过程是：客户机首先通过DHCP协议获取到IP地址（也可以使用静态IP地址），但是客户使用获取到的IP地址并不能登上Internet，在认证通过前只能访问特定的IP地址，这个地址通常是PORTAL服务器的IP地址。采用Portal认证的接入设备必须具备这个能力。**一般通过修改接入设备的访问控制表（ACL）可以做到。**

用户登录到Portal Server后，可以浏览上面的内容，比如广告、新闻等免费信息，同时用户还可以在网页上输入用户名和密码，它们会被WEB客户端应用程序传给 Portal Server，再由Portal Server与NAS之间交互来实现用户的认证。

##### 802.1x

802.1x协议为二层协议，不需要到达三层，而且接入层交换机无需支持802.1q的VLAN，对设备的整体性能要求不高，可以有效降低建网成本。

IEEE802.1x是IEEE（美国电气电子工程师学会）802委员会制定的应用于**LAN交换机和无线LAN接入点**的用户认证技术。

##### PPPOE

以太网上点对点协议（PPP over Ethernet）

##### MAC认证

以终端MAC地址作为身份认证的凭据，进行系统认证。适用于**哑终端认证和免认证场景**。

> 计算机科学中，哑终端表示一个相对于其他种类比较“聪明”的计算机终端来说，功能较为有限的计算机终端。打印机

MAC旁路认证：适用于802.1x中无法启用802.1x的哑终端。将MAC地址作为用户和密码来接入网络。

MAC认证的用户名格式：

```
1.MAC地址：将用户的MAC地址作为用户名，同时使用MAC地址或自定义的字符串作为PASSWORD

2.固定用户名形式：不论用户的MAC何值，所有用户均使用接入控制设备上指定的一个固定用户名和密码来替代MAC地址作为身份信息认证。

3.DHCP：获取用户的DHCP选项字段以及一个固定密码来代替MAC地址作为认证信息。
```

##### 邮件加密PGP

PGP（Pretty Good Privacy）是一个完整的电子邮件安全软件包，PGP提供数据加密和数字签名两种服务。**采用RSA公钥证书进行身份验证，使用IDEA进行数据加密，使用MD5进行数据完整性验证。**

**PGP功能不包括邮件压缩**

## VPN虚拟专用网

虚拟专用网络（Virtual Private Network，VPN）是在**公用网络上建立专用网络的技术**。由于整个 VPN 网络中的任意两个节点之间的连接并没有传统专网所需的端到端的物理链路，而是架构在公用网络服务商ISP所提供的网络平台，所以称之为虚拟网。

实现VPN 的关键技术主要有以下几种。

- 隧道技术（Tunneling）实现 VPN 的最关键部分是在公网上建立虚信道，而建立虚信道是利用隧道技术实现的，IP 隧道的建立可以在链路层和网络层。

  VPN主要隧道协议有

  - 二层：L2TP和**PPTP**（基于PPP）
  - 三层：**IPSec**和GRE
  - 四层：**SSL/TLS**

- 加解密技术（Encryption&Decryption）。VPN可以利用已有的加解密技术实现保密通信，保证公司业务和个人通信的安全。

- 密钥管理技术（Key Management），建立隧道和保密通信都需要密钥管理技术的支撑，密钥管理负责密钥的生成、分发、控制和跟踪，以及验证密钥的真实性等。

- 身份认证技术（Authentication），加入VPN的用户都要通过身份认证，通常使用用户名和密码，或者智能卡来实现用户的身份认证。

### IPSec

企业对网络安全性的需求日益提升，而传统的TCP/IP协议缺乏有效的安全认证和保密机制。IPSec（Internet Protocol Security）作为一种开放标准的安全框架结构，可以**用来保证IP数据报文在网络上传输的机密性、完整性和防重放。**

#### 组成部分



<img src="img/计算机/计算机网络/image-20230524104858373.png" alt="image-20230524104858373" style="zoom:67%;" />

- **AH认证头：数据认证，数据完整性**
  - MD5
  - SHA

- **ESP：数据加密**，ip端口50
  - des
  - 3des
  - aes-128
  - aes-192
  - aes-256
  - sml
- **IKE：密钥**，端口是udp的500

#### 模式

隧道模式 ：隧道模式是对整个IP数据包提供安全传输机制。是在一个IP数据报的后面和前面都添加一些控制字段，构成IPsec数据报

**在隧道模式下，IPSec会另外生成一个新的IP报头，并封装在AH或ESP之前**

![image-20230524105902121](img/计算机/计算机安全/image-20230524105902121.png)

传输模式：在传输模式下，IPsec包头增加在原IP包头和数据之间，在整个传输层报文段的后面和签名添加一些控制字段，构成IPsec数据报。这种方式是把整个传输层报文段都保护起来。因此**只能保证原IP包数据部分的安全性**

![image-20240921162337061](img/计算机/计算机网络/image-20240921162337061.png)

**在传输模式下，AH或ESP报头位于IP报头和传输层报头之间。**



#### 应用场景

站点到站点（Site-to-Site）： 用于连接不同地理位置的网络，如分公司和总部之间的连接。整个子网之间的通信可以通过加密隧道来保护。

远程访问（Remote Access）： 适用于移动用户或远程办公人员，允许他们通过Internet安全地访问公司网络资源。通常使用VPN客户端连接到VPN服务器。



- 企业分支可以通过IPSec VPN接入到企业总部网络。

- 在点到点的环境下，配置IPSec VPN隧道需要明确（4）和（5）对端地址/认证方式




### SSL安全套接层 

**SSL VPN是传输层安全协议**

**SSL安全连接建立在TCP443端口，统一资源定位器使用HTTPS://开头。**

SSL/TLS在Web安全通信中被称为**HTTPS=HTTP+SSL/TLS**

<img src="img/计算机/计算机网络/image-20240821000432359.png" alt="image-20240821000432359" style="zoom:50%;" />

#### HTTPS和SHTTP

- HTTPS=HTTP+SSL/TLS，端口TCP 443
- S-HTTP安全的超文本传输协议（Security HTTP），端口TCP 80。
- S-HTTP**语法**与HTTP一样，**而报文头有所区别**，进行了加密。

#### SSL认证过程

![img](img/计算机/计算机网络/wps585.jpg)

安全套接字协议SSL（Secure Socket Layer）工作在应用层和传输层之间，提供身份认证和保密通信功能。SSL所包含的协议有SSL握手协议、SSL修改密文协议、SSL警告协议和SSL记录协议。

- SSL握手协议负责身份认证和密钥生成。
- SSL记录协议负责接收应用层报文，并将数据划分成可管理的块（214个字节），选择性地压缩数据，应用报文认证码（MAC）对数据进行加密，并增加首部，通过TCP报文段传输数据；接收者将数据进行解密、验证、解压，重装配成应用报文，然后交付更高级的用户。

在客户端与服务器间传输的数据是通过使用对称算法（如 DES 或 RC4）进行加密的。公用密钥算法（通常为 RSA）是用来获得加密密钥交换和数字签名的，此算法使用服务器的SSL数字证书中的公用密钥。有了服务器的SSL数字证书，客户端也可以验证服务器的身份。SSL 协议的版本 1 和 2 只提供服务器认证。版本 3 添加了客户端认证，此认证同时需要客户端和服务器的数字证书。



### SSL和IPSec

![img](img/计算机/计算机安全/358eee822722452798e46459aa6c3b05.png)

- Ipsec 一般用于“网到网”的连接方式,广泛应用于VPN路由器部署。用户通常需要有相应的客户端软件。

  比如分公司内的主机和总公司内的主机有通信需求，这时候可以用ipsec vpn在两个公司之间建立隧道。把两个站点的本地要通过vpn进行互访的网段进行配置。那么13.13.13.1和2.2.2.1互访的时候就会进入vpn隧道。

  <img src="img/计算机/计算机安全/wKgaomTngWaAZcflAAA37en9a40492.jpg" alt="SSL">

-  SSL vpn一般用于企业用户远程办公的场景比较多，即“移动用户-网”的连接，广泛应用于网络安全交易和远程控制。SSLVPN通常无需安装客户端，浏览器即可。

  企业总部一般会布置oa系统，邮件系统等。员工在家办公或者其他分支机构的员工访问总部的这些应用系统的时候，可以使用ssl vpn进行布置。

  <img src="https://file1.elecfans.com//web2/M00/9A/25/wKgaomTngWaAZeUDAAAwSs7NmZw188.jpg" alt="SSL">

因此对于两个机构之间形成一个局域网进行通信，只能用ipsec。但是随着站点的增加，运维压力和布置成本也会相应上升。

而远程办公或远程接入的情景，用户不用装客户端，随便找个有浏览器能上网的电脑就可以接入公司，接入方式更灵活，办公更高效。这种情况用ssl vpn更好。

## 防火墙与入侵检测

### 防火墙

防火墙可以实现内部网络信任网络与外部不可信任网络（Internet）之间或是内部网络不同区域隔离与访问控制。

防火墙技术与分类：包过滤（默认，**不具有查毒功能**）、状态化防火墙、应用层网关、应用层检测DPI

<img src="img/计算机/计算机网络/image-20240822224226060.png" alt="image-20240822224226060" style="zoom:50%;" />

#### 防火墙区域划分

根据网络的安全信任程度和需要保护的对象，人为划分若干安全区域，包括：

- 本地区域（Local）：防火墙本身。
- 信任区域（Trust）：内部安全网络，如内部文件服务器、数据库服务器。
- 非信任区域（Untrust）：外部网络，**比如互联网**。
- 军事缓冲区域（DMZ）：内部网络和外部网络之间的网络，**常放置公共服务设备**，向外提供信息服务。

**受信任程度：Local > Trust > DMZ > Untrust** 

Inbound：低安全级别→高安全级别，比如Untrust → Trust

Outbound：高安全级别 → 低安全级别，比如DMZ →Untrust

##### DMZ

<img src="img/计算机/计算机安全/image-20240507001420284.png" alt=" " style="zoom: 67%;" />

> **1、DMZ是什么？**
>
> 英文全名“Demilitarized Zone”，中文含义是“隔离区”。在安全领域的具体含义是“内外网防火墙之间的区域”。
>
> **2、DMZ做什么？**
>
> DMZ区是一个缓冲区，在DMZ区存放着一些公共服务器，比如论坛等。
>
> 用户要从外网访问到的服务，理论上都可以放到DMZ区。
>
> 内网可以单向访问DMZ区、外网也可以单向访问DMZ区。
>
> **3、为什么设置DMZ区？**
>
> 为了安全（哈哈！）。做个假设，如果你公司的内网可以从互联网被访问的话，那么还存在什么安全？但是有些对外的服务还必须要能够从外网进行访问，在这种情况下“DMZ区”就应运而生了。
>
> DMZ区是一个区域，她提供了对外服务器存放的位置，**有了安全，也有了方便**。通过下面DMZ区布置图可以加深理解

#### 工作模式

- 交换模式 (二层模式)

交换模式的防火墙其实等于从数据链路层开始解析的基于包过滤原理 / 状态机制的网络级防火墙；如果防护墙支持路由模式，则即等于带有加强的过滤规则和状态机制的路由器。

- 路由模式 (三层模式）

当防火墙位于内部网络和外部网络之间时，需要将**防火墙与内部网络、外部网络以及 DMZ 三个区域**相连的接口分别配置成不同网段的 IP 地址，重新规划原有的网络拓扑，此时相当于一台路由器。

- 混合模式

如果防火墙既存在工作在**路由模式的接口（接口具有 IP 地址）**，又存在工作在**透明模式的接口（接口无 IP 地址）**，则防火墙工作在混合模式下。混合模式主要用于透明模式作双机备份的情况，此时启动 VRRP（Virtual Router Redundancy Protocol，虚拟路由冗余协议）功能的接口需要配置 IP 地址，其它接口不配置 IP 地址。

### 入侵检测

- 入侵检测**IDS**是防火墙之后的第二道安全屏障。

  - 入侵检测分类

    - 按信息来源分：HIDS、NIDS、DIDS（主机/网络/分布式）。

    - 按响应方式分：实时检测和非实时检测。


    - **按数据分析技术和处理方式分：异常检测、误用检测**和混合检测。


  - **异常检测**：建立并不断更新和维护系统正常行为的轮廓，定义报警阈值，超过阈值则报警。

    能够检测从未出现的攻击，但误报率高。

  - **误用检测**：对已知的入侵行为特征进行提取，形成入侵模式库，匹配则进行报警。已知入侵检测准确率高，对于未知入侵检测准确率低，**高度依赖特征库**。

    检测技术：专家系统和模式匹配。

- 入侵防御系统IPS定义：入侵防御系统是一种**抢先**的网络安全检测和防御系统，**能检测出攻击并积极响应。**

  - IPS不仅具有入侵检测系统检测攻击行为的能力，而且**具有拦截攻击并阻断攻击**的功能。
  - IPS不是IDS和防火墙功能的简单组合，**IPS在攻击响应上采取的是主动的全面深层次的防御。**



入侵防御系统IPS vs 入侵检测系统IDS

部署位置不同：**IPS一般串行部署，IDS一般旁路部署。**

入侵响应能力不同：**IPS能检测入侵，并能主动防御，IDS只能检测记录日志，发出警报**。

<img src="img/计算机/计算机网络/image-20240822230717320.png" alt="image-20240822230717320" style="zoom:50%;" />

## 背

Kerberos系统中可通过在报文中加入（）来防止重放攻击。防止重放攻击可通过加时间戳方式实现。



IPSEC中安全关联（security Associations）三元组是<安全参数索引SPI，目标IP地址，安全协议>

在生成快速转发表的过程中，五元组是指源IP地址、目的IP地址、源端口号、目的端口号、协议号



入侵检测技术包括专家系统、模型检测、简单匹配；**漏洞扫描不是入侵检测的内容。**

**IDS设备的主要作用是（）。入侵检测**



X.509数字证书标准推荐使用的密码算法是(43)，而国密SM2数字证书采用的公钥密码算法是(44)RSA，ECC



报文摘要算法生成报文摘要的目的是防止发送的报文被篡改



**IPSec是网络层安全协议，L2TP和PPTP是链路层安全协议，TLS是传输层安全协议**。



下图所示为一种数字签名方案，网上传递的报文是  (1)  ，防止A抵赖的证据是  (2)  。$E_B(D_A(P))$,$D_A(P)$

![img](http://pic.cnitpm.com/upload/image/20131130/20131130183644_1093.png)



题图中所示为一种利用公钥加密算法实现的数字签名方案，发送方A要发送给接收方B的报文P经过A的私钥签名和B的公钥加密后形成报文$E_B(D_A(P))$发送给B，B利用自己的私钥$D_B$和A的公钥$E_A$对消息$E_B(D_A(P))$进行解密和认证后得到报文P，并且保存经过A签名的消息$D_A(P)$作为防止A抵赖的证据。

### 协议

**PGP**是支持**电子邮件加密**的协议,使用IDEA进行加密

# 网络操作系统与应用服务器

## 本地用户与组

用户：包含用户名、密码、权限以及说明
用户组：**具有相同性质的用户归结在一起，统一授权，组成用户组。**
创建用户和组：我的电脑-右键-管理-计算机管理-本地用户和组（本地用户信息存储在**本地SAM数据库**）。

<img src="img/计算机/计算机网络/image-20240823155123116.png" alt="image-20240823155123116" style="zoom:67%;" />

## 活动目录

网络中计算机逻辑组织的两种模式：工作组模式和域模式（活动目录AD）。

<img src="img/计算机/计算机网络/image-20240823155333584.png" alt="image-20240823155333584" style="zoom:50%;" />

- 工作组模式：每台计算机都拥有自己的**本地安全账户管理数据库SAM。**
- 域模式：用户信息存储在域控制器，可以在**域中漫游**，访问域中任意一台服务器上的资源。

活动目录：

- 对域中的账户和资源对象进行存放并集中管理。

  **一个动态的分布式文件系统**，包含存储网络信息的目录结构和相关目录服务。

- 域控制器（Domain Controller，DC）域中安装了活动目录的计算机。dcpromo 

- AD存储的用户信息，分散在多个DC，操作系统对信息进行备份和选择性复制，维护信息一致性，提供容错能力。

- 活动目录中对象的名字采用DNS域名结构，安装AD必须先安装DNS组件，**必须安装在NTFS分区**

活动目录工作组分类

- 组策略

  **window用户管理，组策略A-G-DL-P,用户账号-全局组-域本地组-资源权限**

## 远程桌面基础

远程桌面协议RDP，**基于TCP 3389**。

图形化远程桌面连接：开始-所有程序-附件-远程桌面连接命令快捷键：**mstsc**

### Samba

向Linux主机提供Windows风格的**文件和打印机共享服务。**

## IIS服务器（web和FTP）

IIS（Internet Information Server）**因特网信息服务器**。它可以**在Windows操作系统上运行**。可以处理来自客户端的HTTP请求，并将请求发送到相应的Web应用程序。

**IIS可以搭建Web服务器、FTP服务器和SMTP服务器。【没有POP3和IMAP】**

安装IIS服务：开始→管理工具→服务器管理→角色→添加角色→Web服务器（IIS）。

- IIS提供了许多安全功能，如SSL证书、IP地址过滤、访问控制等。这些功能可以帮助您保护您的网站和应用程序免受攻击。

- IIS还提供了负载均衡和故障转移功能。这意味着如果一个服务器出现故障，请求会自动转移到另一个服务器上，从而保证您的网站和应用程序的可用性。 除了以上的功能，IIS还有很多其他的功能，如WebDAV、Web服务扩展、ASP.NET等。这些功能可以帮助您更好地管理和扩展您的Web应用程序。

- IIS支持多种协议，**包括HTTP、FTP、SMTP等**。这意味着您可以在同一个服务器上运行多个应用程序，每个应用程序使用不同的协议。
- IIS支持虚拟主机。这意味着您可以在同一个服务器上运行多个网站，每个网站都有自己的域名和IP地址。

**iis通过分配tcp端口号、ip地址和主机头三种方式来在一台服务器上运行多个网站**

> 要在一台主机上建立多个独立域名的站点，下面的方法中（42）是错误的。**使用虚拟目录**


### 认证

 Windows IIS服务支持的身份认证方式有四种：.NET Passport身份验证、集成Windows身份验证、摘要式身份验证和基本身份验证。

-  集成Windows身份验证以Kerberos票证的形式通过网络向用户发送身份验证信息，并提供较高的安全级别。Windows集成身份验证使用Kerberos版本5和NTLM身份验证。**集成windows身份验证是安全级别最高的验证方法**
-  **摘要式身份验证**，将用户凭据作为**MD5**哈希或消息摘要在网络中进行传输，这样就无法根据哈希对原始用户名和密码进行解码。
-  .NET Passport身份验证，对IIS的请求必须在查询字符串或Cookie中包含有效的.NET Passport凭据，提供了单一登录安全性，为用户提供对Internet上各种服务的访问权限。  
-  基本身份验证：**用户凭据以明文形式在网络中发送。**这种形式提供的安全级别很低，因为几乎所有协议分析程序都**能读取密码**。

## DNS

- 作用：把域名转换成IP地址。

- DNS/DHCP服务器必须为静态IP地址，而Web/FTP均可为动态IP。

- 在Linux操作系统中，采用（）来搭建DNS服务器。Bind

<img src="img/计算机/计算机网络/image-20240823165648374.png" alt="image-20240823165648374" style="zoom:50%;" />





### DNS记录类型

![image-20240824165748406](img/计算机/计算机网络/image-20240824165748406.png)

- SOA指明区域**主**服务器和管理员邮件地址
- MX  指明区域**邮件**服务器及其优先级；
- NS   指明区域**授权**域名服务器记录；

- CNAME 指明主机名的别名；
- A记录，即主机记录，域名到IP的映射。
- PTR记录类型的功能是实现域名的反向查询。实现IP地址到主机名的映射

### DNS查询过程

<img src="img/计算机/计算机网络/image-20240824171330569.png" alt="image-20240824171330569" style="zoom:67%;" />

- DNS服务器在名称解析过程：
  - 本地缓存记录
    - DNS缓存（浏览器/系统都有）：在内存中
    - host文件：在C盘中
  - 本地DNS服务器=主域名服务器
    - 区域记录：所有的都会直接存在本地的，专门做解析的
  - 转发域名服务器
  - 根域名服务

### DNS查询方式

<img src="img/计算机/计算机网络/image-20240824172031551.png" alt="image-20240824172030013" style="zoom: 50%;" />

递归查询：域名服务器帮助用户进行名字解析，并返回最后的结果。【老好人】

- 本地/转发（中介）域名服务器采用的是递归查询

迭代查询：域名服务器进行迭代访问，反复多次，直到最后找到结果。【踢皮球】

- 根域名服务器采用的**迭代查询**，辅助域名服务器配置了**迭代算法**



<img src="img/计算机/计算机网络/image-20240824173655630.png" alt="image-20240824173655630" style="zoom:50%;" />

### 辅助DNS服务器

辅助DNS服务器是一种容错设计，**DNS主服务器出现故障或因负载太重无法及时响应客户机请求**，辅助服务器将挺身而出为主服务器排忧解难。
辅助服务器的区域数据都是从主服务器复制而来，**DNS通知消息**让辅助服务器能及时更新区域信息，只有被通知的辅助域名服务器才能从主域名服务器进行区域复制。

<img src="img/计算机/计算机网络/image-20240824174625535.png" alt="image-20240824174625535" style="zoom:67%;" />



DNS通知是一种推进机制，其作用是**辅助域名服务器及时更新信息**

用户可以通过中继代理使用外网段内DNS服务器进行域名解析。

- 错误：用户只能使用本网段内DNS服务器进行域名解析

## 背

以下域名服务器中，没有域名数据库的  （ ）  。缓存域名服务器 

# linux

Linux系统，**设备和配置都是文件。**网络相关配置文件大多数位于/etc目录下，这些文件**可以在系统运行时修改**，不用重启或停止任何守护程序，更改立刻生效。

## 文件

![图片](img/计算机/linux/640)



### dhcp

```
service dhcpd start（restart 、stop）：DHCP服务启动（重启、停止）
```

- **/etc/dhcpd.conf：DHCP服务主配置文件路径**
- dhcpd.leases保存客户端租约信息的文件
- /usr/sbin/dhcpd 在Linux中提供DHCP服务的**程序**
- /etc/dhcpd.conf 是DHCP服务的配置文件，DHCP服务所有参数都是通过修改dhcpd.conf文件来实现。DHCP服务将主机的**MAC地址和IP地址绑定**在一起的方法

DHCP协议的功能是 （1） 。在Linux中提供DHCP服务的**程序**是 （2） ；DHCP服务将主机的**MAC地址和IP地址绑定**在一起的方法是在 （3） 文件中添加“host主机名{hardware Ethernetxx xx.xx.xx.xx.xx fixed-address 192.168.0.9}”配置项；创建DHCP租用文件的命令是 （4） ；通过运行 （5） 命令可以设置在操作系统启动时自动运行DHCP服务。

- 为客户机自动配置IP地址 
- /usr/sbin/dhcpd
- /etc/dhcpd.conf 
- touch  /var/state/dhcp/dhcpd.leases 
- chkconfig

### http

- /etc/httpd.conf 修改Web服务器配置,Web服务器端口

- **Apache服务器**

  - **/etc/httpd/conf/httpd.conf：主配置文件**

  - **/etc/httpd/：根目录**

    **/var/www/html/：文档根目录**

    **/etc/init.d/httpd：访问日志文件**

    **/var/log/httpd/error_log：错误日志文件**

    **/etc/init.d/httpd start：Apache启动文件**

### dns

<img src="img/计算机/计算机网络/image-20240824175055448.png" alt="image-20240824175055448" style="zoom: 50%;" />

- （1）/etc/resolv.conf：DNS服务器配置文件，包含了主机的**域名搜索顺序和DNS服务器地址。**

  ```
  Seach test.edu.cn
  nameserver 114.114.114.114#首选DNS服务器
  nameserver 8.8.8.8#备用DNS服务器
  ```

- （2）/etc/named.conf：DNS主配置文件，存放各类DNS记录，比如A记录、PTR记录。、

- （3）/etc/hosts：存放主机DNS解析缓存，包含IP地址和主机名之间的映射，还包括主机名的别名；

  ```
  C:\Windows\System32\drivers\etc\hosts
  # For example:
  # 102.54.94.97 rhino.acme.com
  # 38.25.63.10 x.acme.com
  ```

- （4）host.conf：解析器查询顺序配置文件

  ```
  vi/etc/host.conf order hosts bind//表示先查询本地hosts文件，如果没有结果，再尝试查找BIND DNS服务器
  ```

- /etc/hostname文件包含了Linux系统的主机名称

- /etc/sysconfig/network是一个用来指定服务器h的网络配置信息的文件，包含了控制和网络有关的文件和守护程序行为的参数。

- /etc/sysconfig/network-script/ifcfg-enoxxx网络配置文件


  - 使用BIND配置域名服务器，主配置文件存放在named.conf

- /etc/shadow Linux系统中用户登录密码信息存放在
- /etc/gateways建立动态路由

## 命令

### 权限chomd

Linux文件权限分为：

- 五种类型
- 四种权限
  - 读取、写入和执行
- 三个分组
  - 文件所有者、与文件所有者同组的用户和其他用户

第1位：指文件类型。
2~4位：指文件所有者对该文件拥有的权限。
5~7位：指与所有者同组用户对该文件的权限。
8~10位：其他用户对该文件的权限。

![image-20241103004421093](img/计算机/linux/image-20241103004421093.png)

**例如：-rw-r--r--可以表示为：普通文件，用户权限可读可写，用户组权限可读，其他用户可读**

### more

more：分屏显示，类似cat，不过会以一页一页的形式显示，更方便使用者逐页阅读，而最基本的指令就是按空白键（space）就往下一页显示。

- -num：一次显示的行数
- -f：计算行数时，以实际上的行数，而非自动换行过后的行数（有些单行字数太长的会
- 被扩展为两行或两行以上）
- +num：从第num行开始显示

### less

less：按页显示，与more类似，但使用less可以随意浏览文件，而more仅能向前移动，却不能向后移动，而且less在查看之前不会加载整个文件。

-b：<缓冲区大小> 设置缓冲区的大小
-e：当文件显示结束后，自动离开
-N：显示每行的行号
-o：<文件名> 将less输出的内容在指定文件中保存起来
-b：向上翻一页
-d：向后翻半页
-h：显示帮助界面
-Q：退出less命令
-u：向前滚动半页
-y：向前滚动一行

### cp

- -i覆盖既有文件之前先询问用户。**为防止意外覆盖相同文件名的文件，**
- -f 覆盖已经存在的目标文件而不给出提示。
- -R 递归处理，将指定目录下的所有文件与子目录一并处理。
- -a：此选项通常在复制目录时使用，它保留链接、文件属性，并复制目录下的所有内容
- -d：复制时保留链接。这里所说的链接相当于Windows系统中的快捷方式
- -p：除复制文件的内容外，还把修改时间和访问权限也复制到新文件中
- -l：不复制文件，只是生成链接文件

### mv

mv：文件或目录改名、或将文件或目录移入其他位置。
-i：若指定目录已有同名文件，则先询问是否覆盖旧文件
-f：在 mv 操作要覆盖某已有的目标文件时不给任何指示

### rm

rm：文件删除或目录。
-i：删除前逐一询问确认
-f：即使原档案属性设为唯读，亦直接删除，无需逐一确认
-r：将目录及以下之档案亦逐一删除

### mkdir

mkdir：创建目录。
-p：确保目录名称存在，不存在的就建一个。

### rmdir

rmdir：删除目录。
-p：是当子目录被删除后使它也成为空目录的话，则顺便一并删除

### pwd

pwd：显示工作目录。

### ls

ls列出目录。
-a：显示所有文件及目录包括隐藏的文件
-l：**将文件名、文件型态、权限、拥有者、文件大小等信息详细列出**
-r：将文件以相反次序显示（原定依英文字母次序）
-t：将文件以建立时间之先后次序列出
-R：若目录下有文件，则以下之文件亦皆依序列出

-c：**可将文件按修改时间顺序显示**

### ln

ln：为某一个文件在另外一个位置建立一个同步的链接。
-b：删除，覆盖以前建立的链接
-d：允许超级用户制作目录的硬链接
-f：强制执行
-i：交互模式，文件存在则提示用户是否覆盖
-n：把符号链接视为一般目录
-s：软链接（符号链接）
-v：显示详细的处理过程

### grep

grep：查找文件里符合条件的字符串。
-l：列出文件内容符合指定的样式的文件名称
-L：列出文件内容不符合指定的样式的文件名称
-q：不显示任何信息
-s：不显示错误信息
-v：显示不包含匹配文本的所有行
-V：显示版本信息
-w：只显示全字符合的列
-x：只显示全列符合的列



- groupdel group1 删除用户组group1

- grep用于在指定文件中查找指定字符串

- shutdown关闭系统

- （1）cat命令：用来在屏幕上滚动显示文件的内容，cat命令也可以同时查看多个文件的内容，还可以用来合并文件cat[-选项]fileName[filename2]...[fileNameN]
  （2）more命令：如果文本文件比较长，一屏显示不完，这时可以使用more命令将文件内容分屏显示
  （3）less命令：less命令的功能与more命令很相似，也是按页显示文件，不同的是less命令在显示文件时允许用户既**可以向前或向后翻阅文件**。按B键向前翻页显示；按P键向后翻页显示；输入百分比显示指定位置；按Q 键退出显示

- 在Linux系统中，利用 （ ） 命令可以**分页显示**文件的内容。more

- 创建/删除目录命令mkdir rmdir

- chkconfig iptables off可以正确关闭系统防火墙

- ftp

  - get：从服务器端下载文件
  - put：向FTP服务器端上传文件

- iptables

  iptables【-t表名】管理选项【链名】条件匹配-j执行动作
  例：iptables -t filter -A INPUT -s 192.168.184.20 -p tcp -d port 22 -j DROP 拒绝192.168.184.20地址访问端口22

  ![image-20240826114206536](img/计算机/计算机网络/image-20240826114206536.png)

  <img src="img/计算机/计算机网络/image-20240826114714419.png" alt="image-20240826114714419" style="zoom:50%;" />

## Linux用户和组管理

Linux系统中最重要的是超级用户，即**根用户root UID=0**用户管理配置文件（偶尔考）

用户管理配置文件（偶尔考）

- ①/etc/passwd每个用户在该文件中都有一行对应记录，该文件对所有用户都是可读的分为7个域，记录了这个用户的基本属性，格式如下：

  用户名：加密的口令：用户ID：组ID：用户的全名或描述：登录目录：登录shell

- ②**/etc/shadow只有超级用户root能读的文件/etc/shadow**，该文件包含了系统中的所有用户及其口令等相关信息，分成9个域：

  1用户登录名；
  2**用户加密后的口令（**若为空，表示该用户不需口令即可登录；若为*号，表示该账号被禁止）；

useradd[-选项]username (userdel groupadd groupdel)

- -d 指定用于**取代默认/home/username的用户主目录** 

  useradd-d/home/test user1

- -g用户所属用户组的组名或组ID 

  useradd -g test user2

- passwd[-选项]username





# window

## 命令

### win+r

Windows系统下，通过运行  （ ）  命令可以打开Windows管理控制台。mmc

![img](https://pic.cnitpm.com/upload/image/20170117/20170117161318_3492.jpg)

### ping和traceroute

<img src="img/计算机/计算机网络/image-20240826165150960.png" alt="image-20240826165150960" style="zoom: 67%;" />

### ARP

<img src="img/计算机/计算机网络/image-20240826165333825.png" alt="image-20240826165333825" style="zoom:50%;" />

**arp -s IP地址 MAC地址：手动绑定IP与MAC**

### route和nslookup

![image-20240826165857995](img/计算机/计算机网络/image-20240826165857995.png)

- route

  <img src="img/计算机/计算机网络/image-20240826170851926.png" alt="image-20240826170851926" style="zoom:50%;" />

  从路由表中的第一条默认路由，可以知道网关是102.217.115.254。
  从路由表中的第三、四、五条路由，可以知道主机的ip地址为102.217.115.132同时在第三条路由中，可以知道102.217.115.128的子网掩码是255.255.255.128，去往这个地址是从自身接口出去的，说明该主机也在这个子网内。所以子网掩码就是255.255.255.128，

- nslookup为显示域名解析服务器；

  - C:\>nslookup  type=ptr 211.151.91.165  查询 211.151.91.165 到域名的映射
  - C:\>nslookup -qt=a cc.com   cc.com 主机的IP地址

### netstat 

**Netstat 是在内核中访问网络连接相关信息的程序，它能提供TCP 连接，TCP 和UDP 监听，进程内存管理的相关报告**

- -a显示所有连接的信息，包括正在侦听的
- -i显示已配置网络设备的统计信息
- -c持续更新网络状态（每秒一次）直到被人中止
- **-r 显示IP路由表，效果与route print一样**
- **-n 显示活动的TCP连接**
- netstat -ano | findstr "3306"查看3306端口的任务进程

![image-20241103002757259](img/计算机/window/image-20241103002757259.png)

### ipconfig

<img src="img/计算机/计算机网络/image-20240826163338154.png" alt="image-20240826163338154" style="zoom: 67%;" />

### 删除端口

**1、打开终端**

win+r的方式，打卡运行框，输入cmd按下回车，即可打开终端。

**2、查询端口进程**

```
netstat -ano | findstr 8080
```

**3、根据进程ID删除进程**

```
taskkill -PID 9340 -F
```

### 修复

DISM.exe /Online /Cleanup-image /Scanhealth

DISM.exe /Online /Cleanup-image /Checkhealth

DISM.exe /Online /Cleanup-image /Restorehealth

sfc /scannow立即扫描所有受保护的系统文件

SFC是MicrosoftWindows的一种工具，它允许用户扫描所有受保护的系统文件，并检查系统文件的完整性，然后再恢复已损坏的Windows系统文件。SFC命令有助于维护整个系统文件，





### 环境变量

window+r —> sysdm.cpl —> 高级 —>环境变量

### 网络管理







- 





### 任务进程

- tasklist 查看任务进程：**tasklist 命令：是一个用来显示运行在本地或远程计算机上的所有进程的命令行工具。可以用于结束一个或多个任务或进程（根据进程 ID 或图像名来结束进程，结束进程命令 taskkill 或 tskill）。**

  - tasklist /svc：查看系统进程提供的服务，及服务是否正常
  - tasklist | findstr 15976

- taskkill 命令：使用该命令按照进程 ID (PID) 或映像名称终止任务。此命令使用方法与 tasklist 有些类似，在此不再赘述，亲们可依据前面提供的命令参数，自行实践，原谅我偷懒一下 

  - 删除任务pid ：taskkill /f /pid
  - 杀掉对应程序名称的所有进程：taskkill /f /im 程序名

- tskill 命令：通过**进程名称（不包含后缀名）**或者进程 PID 关闭进程。关闭进程后，进程对应的未保存的数据不再保存。

  

## 背

Workstation用SMB协议创建并维护客户端网络与远程服务器之间的连接。

505服务器端HTTP版本不支持

在Windows操作系统中，远程桌面使用的默认端口是3389

DNS域名查询的次序是：本地DNS缓存→本地的hosts文件→本地DNS服务器→根域名服务器。

IIS支持web、FTP和虚拟的SMTP服务器，dns有专门的服务器。

DNS Client是一个访问本地域名解析Cache的组件。

发送邮件，采用的是SMTP协议，所以发送邮件服务器应为smtp.pq.com。接收邮件，采用POP协议，所以接收邮件服务器应为pop.pq.com。

默认情况下，远程桌面用户组（Remote Desktop Users）成员对终端服务器（）。具有用户访问权和来宾访问权

活动目录必须安装在NTFS分区。

### dhcp服务器配置

当DHCP服务器拒绝客户端的IP地址请求时发送（）报文 。DhcpNack

如果DHCP客户端发现分配的IP地址已经被使用，客户端向服务器发出（）报文，拒绝该IP地址。DHCP Decline

客户机可以跨网段申请DHCP服务器提供的IP地址

# 网络管理

## 网络管理体系结构

网络管理五大功能域：故障管理、配置管理、计费管理、性能管理和安全管理。

## 网络监控系统体系结构

代理与监视器两种通信方式：轮询和事件报告。

## SNMP

### 网络管理协议五大标准

ISO制定：CMIS/CMIP公共管理信息服务规范。

基于TCP/IP：简单网络管理协议**SNMPv1、SNMPv2、SNMPv3**。

- SNMPv1网络管理中，管理站和代理站之间可以是一对多关系，也可以是多对一关系。

- SNMPv2增加定义了GetBulk和inform两个新协议操作。
  
  GetBulk：快速获取大块数据。
  Inform：允许一个NMS（网管系统）向另一个NMS发送Trap信息/接收响应消息。
  
- SNMPv3重新定义了网络管理框架和安全机制。
  
  重新定义网络管理框架：将前两版中的管理站和代理统一叫做SNMP实体（entity）。
  安全机制：认证和加密传输
  
  - 时间序列模块：提供重放攻击防护。
  - 认证模块：完整性和数据源认证，使用SHA或MD5。
  - 加密模块：防止内容泄露，使用DES算法。
  
  **有两种威胁是SNMPv3没有防护的：拒绝服务和通信分析。**

基于局域网：远程监控网络RMON-1和RMON-2。

IEEE制定：基于物理层和数据链路层CMOL

ITU-T：电信网络管理标准TMN

### 2个服务3个端口5个报文

SNMP为应用层协议，**通过UDP承载，端口161和162**。不可靠，但效率高，**网络管理不会太多增加网络负载。**

<img src="img/计算机/计算机网络/image-20240826161939563.png" style="zoom: 67%;" />

<img src="img/计算机/计算机网络/image-20240826162127722.png" alt="image-20240826162127722" style="zoom:50%;" />



# 网络规划

## 网络体系结构设计

### 网络项目整体流程

1：需求分析：业务需求，用户需求，应用需求，通信需求，网络需求等。
2：网络系统设计：物理拓扑设计，逻辑网络设计，网络安全设计等。
3：网络项目实施：设备上架，布线，设备配置调试等。
4：网络运行及维护：设备运行，网络运行，网络调优与维护等。

### 网络设计阶段类型

1：四阶段周期

低成本，灵活性高，规模小，结构简单的网络。

![image-20241106223807863](img/计算机/计算机网络/image-20241106223807863.png)

2：五阶段周期/（瀑布模型）

五阶段周期的每个阶段都是一个工作环节，每个环节完毕后才能进入到下一个环节，类似于软件工程中的“瀑布模型”。按照这种流程构建网络，在下一个阶段开始之前，前一阶段的工作已经完成。一般情况下，不允许返回到前面的阶段，如果出现前一阶段的工作没有完成就开始进入下一个阶段，则会对后续的工作造成较大的影响，甚至引起工期拖后和成本超支。适用于较大网络规模，需求明确，但不灵活。

- 需求分析
- 通信规范分析
  - 资源，流量分析
- 逻辑网络设计**（技术选型）**
  - **网络拓扑**
  - **IP地址规划**
  - **安全管理**
- 物理网络设计
- 实施阶段

<img src="img/计算机/组网/image-20240523222640117.png" alt="image-20240523222640117" style="zoom: 33%;" />

在网络设计阶段进行通信流量分析时可以采用简单的80/20规则，下面关于这种规则的说明中，正确的是（）。这个规则适用于内部交流较多而外部访问较少的网络

## 综合布线系统

- 综合布线系统就是为了顺应发展需求而特别设计的一套布线系统
- 对于现代化的大楼来说，就如体内的神经，它采用了一系列高质量的标准材料
- 以模块化的组合方式，把语音、数据、图像和部分控制信号系统用统一的传输媒介进行综合
- 经过统一的规划设计，综合在一套标准的布线系统中，将现代建筑的三大子系统有机地连接起来，为现代建筑的系统集成提供了物理介质
- 可以说，结构化布线系统的成功与否直接关系到现代化的大楼的成败，选择一套高品质的综合布线系统是至关重要的

<img src="https://img-blog.csdnimg.cn/718cef935f224e6389b5cd06b19a5e81.jpeg#pic_center" alt="在这里插入图片描述" style="zoom: 80%;" />

![image-20240913162400176](img/计算机/计算机网络/image-20240913162400176.png)



综合布线系统采用的是**星型结构，主要由6个子系统**构成，而

这6个子系统每一个都可以独立的、不受其他影响的进入到PDS（综合布线系统）终端中，这6个子系统分别是

- **工作区子系统**

   **工作区子系统是由终端设备到信息插座的整个区域**。一个独立的需要安装终端设备的区域划分为一个工作区。工作区应支持电话、数据终端、计算机、电视机、监视器以及传感器等多种终端设备。

- **水平布线子系统**

  各个楼层接线间的**配线架到工作区信息插座之间所安装的线缆**属于水平子系统，水平子系统的作用是将干线子系统线路延伸到用户工作区。

- **管理子系统**
  管理子系统设置在楼层的接线间内，由各种交联设备（双绞线跳线架、光纤跳线架）以及集线器和交换机等交换设备组成。**主要是配线架，做线缆管理和分配**

- **垂直干线子系统**

  干线子系统是建筑物的主干线缆，实现个**楼层管理子系统之间的互连**。干线子系统通常由垂直的大对数铜缆或光缆组成，一头端接于设备间的**主配线架**上，另一头端接在楼层接线间的**管理配线架**上。

- **设备间子系统**
  建筑物的设备间是网络管理人员值班的场所，设备间子系统由建筑物的进户线、交换设备、电话、计算机、适配器以及保安设施组成，实现中央主配线架与各种不同设备（如PBX、网络设备和监控设备等）之间的连接。

- **建筑群子系统(园区子系统)**

  建筑群子系统将一栋建筑的线缆延伸到**建筑群**内的其它建筑的通信设备和设施。它包括铜线、光纤、以及防止其它建筑的电缆的浪涌电压进入本建筑的保护设备。

- 

## 网络安全技术措施表

![image-20240913171731640](img/计算机/计算机网络/image-20240913171731640.png)

机房安全属于物理安全，入侵检测属于网络安全，漏洞补丁管理属于系统安全，而数据库安全则是应用安全。

## 网络分层设计模型

> - 网络出口
>
>   广域网接入
>
>   地址转换
>
>   出口策略
>
> - 核心层
>
>   高速转发
>
>   服务器接入
>
>   路由选择
>
> - 汇聚层
>
>   流量汇聚
>
>   设备/链路冗余
>
>   路由选择
>
>   策略控制
>
> - 接入层
>
>   用户接入
>
>   接入安全
>
>   访问控制

[核心层](https://baike.baidu.com/item/核心层/8750717?fromModule=lemma_inlink)（网络的高速交换主干）、[汇聚层](https://baike.baidu.com/item/汇聚层/8750672?fromModule=lemma_inlink)（提供基于策略的连接）、[接入层](https://baike.baidu.com/item/接入层/8750687?fromModule=lemma_inlink) （将工作站接入网络）。

核心层：核心层是网络主干部分，是整个网络性能的保障，其设备包括路由器、防火墙、核心层交换机等等，相当于公司架构里的管理高层。**核心层的主要功能是实现骨干网络之间的优化传输，负责整个网络的连通和快速交换**。骨干层设计任务的重点**通常是冗余能力、可靠性和高速传输**。核心层一直被认为是所有流量的最终承受者和汇聚者。

汇聚层：汇聚层是网络接入层和核心层的"中介"，就是在工作站接入核心层前先做汇聚，以减轻核心层设备的负荷。汇聚层具有**实施策略和路由控制**、安全、工作组接入、虚拟局域网（VLAN）之间的路由、源地址或目的地址之间的过滤、网关等功能。

接入层：通常将网络中直接面向用户连接或访问网络的部分称为接入层，也就相当于公司架构里的基层员工，因此接入层交换机具有低成本和高端口密度特性。接入层通过光纤、双绞线、同轴电缆、无线接入技术等传输媒介，实现与用户的对接，并进行业务和带宽的分配。

![img](https://img-blog.csdnimg.cn/20210819143727211.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzE0OTc5Nw==,size_16,color_FFFFFF,t_70)







## 广域网接入技术





HFC网络中，从运营商到小区采用的接入介质为（ ），小区入户采用的接入介质为（ ）。

**光纤，同轴电缆**



通过HFC网络实现宽带接入，用户端需要的设备是（1），局端用于控制和管理用户的设备是（2） 。

- cable modem
- cmts



电缆调制解调器（Cable Modem，CM）是基于HFC网络的宽带接入技术。**用于调制解调以及作为以太网接口** 。CM是用户设备与同轴电缆网络的接口。在下行方向，它接收前端设备CMTS（Cable Modem Termination System）发送来的QAM信号，经解调后传送给PC的以太网接口。在上行方向，CM把PC发送的以太帧封装在时隙中，经Q调制后，通过上行数据通路传送给CMTS。

## 网络常见部署模式

网络有四种常见的部署模式：单臂模式部署、路由模式部署、网桥模式部署、旁路模式部署

![img](https://pic3.zhimg.com/80/v2-56dcf82c65a65d2fe90ad0b206b585a6_1440w.webp)





## 背

以下关于交换机获取与其端口连接设备的MAC地址的叙述中，正确的是（） 。交换机获取与其端口连接的设备的mac地址的方法是检验端口流入分组的源地址，并将其记录在地址表中。



计算机网络机房建设过程中，为了屏蔽外界的干扰、漏电及电火花等，要求所有计算机网络设备的机箱、机柜、机壳等都需接地，该接地系统称为安全地，安全地接地电阻要求小于 4欧姆

①独立的防雷保护接地电阻应小于等于10Ω；

②独立的**安全保护接地电阻**应小于等于4Ω；

③独立的交流工作接地电阻应小于等于4Ω；

④独立的直流工作接地电阻应小于等于4Ω；

⑤**防静电接地电阻**一般要求小于等于100Ω。

⑥共用接地体（联合接地）应不大于接地电阻1Ω.



在网络的分层设计模型中，对核心层工作规程的建议是（69） 。**尽量避免使用访问控制列表以减少转发延迟** 



EIA/TIA-568标准规定，在综合布线时，如果信息插座到网卡之间使用无屏蔽双绞线，布线距离最大为 （ ） 米。10米

通常情况下，信息插座的安装位置距离地面的高度为（）cm。30-50

在结构化布线系统设计时，配线间到工作区信息插座的双绞线最大不超过**90米**，信息插座到终端电脑网卡的双绞线最大不超过（69）米。10米





# 组网技术

> 前两道大题一般结合网络架构考察常见的组网设备和技术，包括交换机、路由器、防火墙、无线网等组网设备;对应的主流技术包括dhcp、dns、vlan、acl、网络安全、raid等，因此需要重点掌握这些技术的学习。
>
> 第三道大题从2020年之后，由winserver 2008 r2的考察转变成了对rip、ospf、bgp路由协议的考察，今年上半年的下午考试第三大题就考察了ospf与bgp的结合，所以在备考过程中尤其要重视这3种路由协议的原理及区别。
>
> 第四道大题比较固定，考察华为交换机或路由器的配置，网络工程师第五版教程将旧版教材中的思科交换机/路由器内容替换为了华为交换机/路由器的配置，华为与思科的配置命令有所区别，所以应重视华为交换机/路由器的具体配置命令，建议下载安装华为的ensp网络仿真模拟软件，通过在ensp命令行界面多输入具体命令进行练习，从而熟练掌握各种配置操作，以便在考试中从容应对。

## 概念

### 故障与解决方案

#### 广播风暴

广播风暴现象：**网络慢、所有指示灯高速闪烁、CPU使用率高、CLI卡顿**。

- 交换机的二层转发表空间被占满，清空后短时间内仍然被占满，造成这种现象的原因可能是

  MAC地址表被占满，最可能存在MAC地址攻击，如果有广播风暴，会出现MAC地址表震荡。

造成广播风暴的原因？
（1）二层环路。（没有启用生成树，或者生成树故障，设备/接口故障等）

（2）网络中存在攻击行为，某些终端中毒，持续发送恶意广播，或者扫描。

（3）特殊应用场景，比如云桌面批量启动，网络教室PC一键开机。
如何解决广播风暴？
（1）划分虚拟局域网VLAN，隔离广播域，缩小广播传递范围。
（2）通过STP/MSTP、堆叠、链路聚合等技术，破除二层环路。
（3）查杀终端病毒，消除网络攻击。
（4）交换机配置广播抑制。



故障检测技术和链路冗余，其中常见的关键链路冗余有接口备份、(**链路聚合**)、(**VRRP**)和双机热备份技术。

#### 网络故障排查与诊断

##### 专用故障排查工具

欧姆表，数字万用表及电缆测试器：利用这些参数可以检测电缆的物理连通性。

测试并报告电缆状况，其中包括近端串音、信号衰减及噪音。



时域反射计与光时域反射计

时域反射器（TDR）：能够快速定位**金属线缆**中的短路、断路、阻抗等问题。

光时域反射器（OTDR）：通过对测量曲线的分析，精确测量**光纤**的长度、断裂位置、信号衰减等。**判断出光缆的故障位置**

光功率计（optical power meter）是指用于测量绝对光功率或通过一段光纤的光功率相对损耗的仪器。**测量光缆是否有问题**

光纤传输测试指标中，回波损耗是指（）。信号反射引起的衰减

### ensp上行接口

在ENSP（Enterprise Network Simulation Platform）中，上行接口通常指的是连接到远程网络或外部设备的接口，用于接收数据。

**一般监视上行接口，若接口故障，可以执行主备接口替换**

### 回环ip地址

- **通常 127.0.0.1 称为回环地址。**回环地址主要用于本地网络接口的测试和诊断。通过将网络数据包发送到本地回环地址，可以测试网络协议栈的正常运行，以及确保计算机网络接口卡的驱动程序和硬件设备都能够正常工作。在实际应用中，回环地址可以用于各种网络诊断和测试工具，例如ping、traceroute、telnet等
- 回环地址可以在不需要其他计算机或网络连接的情况下进行测试，使其成为网络接口测试和网络应用程序开发的有用工具。可以用于模拟一些网络服务，例如Web服务器、FTP服务器、邮件服务器等。

### ACL控制访问列表

访问控制列表（Access Control Table List）是最常用的网络流量限制技术，通过该技术可以为路由器或者交换机的接口配置一些控制命令，用来控制接口的进出数据包。

配置ACL主要有两步

1. 首先要指定访问条件，需要创建列表编号（1-99，100-199）或者名称；
2. 然后在指定的列表编号或者名称内添加流量筛选条件（ip地址、路由、协议），并指定是允许（permit）还是拒绝(deny)。

访问控制列表根据筛选条件不同，一般可以分两种

- 标准访问控制列表表只可以限定源地址的流量，通常使用1-99的列表编号；
- 扩展访问控制列表可以针对源地址、目标地址、传输层协议、源端口、目标端口等进行流量控制，通常使用100-199的列表编号。

访问控制列表(Access Control List，ACL)是路由器的一组指令，用于设置路由器过滤数据包的规则，这种规则可以实现下列功能：

-  . 内部过滤分组；
-  . 保护内部网络免受外部的攻击；
-  . 限制对虚拟终端的访问。

### STP生成树协议

#### 技术背景

交换机单链路上行，若存在单点故障，任何一条链路或者设备故障，网络将面临断网。冗余拓扑能够解决单点故障问题，**但是冗余拓扑带来了二层环路问题。**

##### 二层环路-广播风暴

> 什么是环路问题
>
> 多个交换机连接的网络形成了一个环

<img src="img/计算机/计算机网络/image-20240803162115328.png" alt="image-20240803162115328" style="zoom:50%;" />’

网络中若存在二层环路，一旦出现**广播**数据帧，这些数据帧将被交换机不断泛洪，造成广播风暴。广播风暴对网络危害非常大，将严重消耗设备CPU资源及网络带宽，需要格外注意。

##### 二层环路问题-MAC表震荡

![image-20240803162901722](img/计算机/计算机网络/image-20240803162901722.png)

#### **技术概念**

采用生成树（Spanning-tree）技术，能够在网络中存在二层环路时，通过逻辑阻塞（Block）特定端口，从而打破环路，并且在网络出现拓扑变更时及时收敛，保障网络冗余性。

生成树协议是利用SPA算法，**在存在交换环路的网络中生成一个没有环路的树形网络。**运用该算法将交换网络的冗余备份链路从**逻辑**上断开，**当主链路出现故障时，能够自动的切换到备份链路**，保证数据的正常转发；

生成树协议版本：

- 1.STP（生成树协议 IEEE802.1d）（慢，拓扑收敛需要30-50s）

  stp阻塞端口消除环路,存在带宽浪费

- 2.RSTP（快速生成树协议 IEEE802.1w）（快，6s内完成收敛）

  RSTP在STP基础上改进，实现网络拓扑的快速收敛

- 3.MSTP（多生成树协议 IEEE802.1s）

  MSTP在STP和RSTP基础上改进,实现vlan数据负载均衡

#### BID(网桥)

https://blog.csdn.net/weixin_29978783/article/details/112612596

- 桥ID一共8个字节，由**2个字节优先级和6个字节的MAC地址**构成。
  - **桥默认优先级32768，越小越优先**

##### 生成树选举

> 根桥上的端口都是指定端口，根端口的另一端就是指定端口

- 确定一个根桥（Root Bridge）【选优先级和MAC地址最小的网桥】

- 确定其他网桥的根端口（Root Port）【**非根桥的端口到根桥最近的端口**】

  开销来判断，开销最小的就是根端口。如果根路径开销相同，则比较两端交换机的BID，越小越优

  <img src="img/计算机/计算机网络/image-20240803165049361.png" alt="image-20240803165049361" style="zoom:50%;" />

  **路径开销与端口带宽成反比**

- 选出非指定端口（NonDesignated Port）

  其余既不是根端口也不是指定端口的都是阻塞端口

<img src="img/计算机/计算机网络/image-20240803164853779.png" alt="image-20240803164853779" style="zoom:67%;" />

如下图所示，网桥A、B、C连接多个以太网。已知网桥A为根网桥，各个网桥的a、b、f端口为指定端口。那么按照快速生成树协议标准IEE E 802.1d-2004，网桥B的c端口为（）。根端口

<img src="img/计算机/组网/abd0db4b5aaa2552e9991583a3d7384c.png@f_png,q_100,d_progressive,w_1050" alt="img" style="zoom:50%;" />



### 交换机

#### 端口类型

> 光口就是我们通常说的带光板扩展槽的可以插入光纤，进行远距离数据传输，电口就是我们常说的RJ45的端口也就是网线口

端口类型：RJ45电口、光口（SC/GBIC/SFP/SPF+/SFP28）。

- 双绞线
- 光纤
- GBIC：GBIC端口。交换机上的GBIC（Giga Bit-rate Interface Converter，GBIC）插槽（Slot）
  用于安装千兆位端口光电转换器。GBIC 模块是将位电信号转换为光信号的热插拔器件，分为用于级连的GBIC模块和用于堆叠的GBIC模块，如图10-6所示。用于级连的GBIC模块又分为适用于多模光纤（MMF）或单模光纤（SMF）的不同类型。
- SFP端口。小型机架可插拔设备（Small Form-factor Pluggable，SFP）是GBIC的升级版本，其功能基本和GBIC一致，但体积减少一半，可以在相同的面板上配置更多的端口。有时也称SFP模块为小型化GBIC（MINI-GBIC）模块，如图10-7所示。

#### 交换机性能参数

传输模式：半双工、全双工。

**交换容量：端口数\*端口速率\*2**

包转发率：单位时间内发送64字节数据包的个数1000Mbps/8/（64+8+12）-1.488Mpps 

MAC地址数：交换机MAC地址表中可以存储最大的MAC地址数量。

VLAN表项：交换机最大支持VLAN数量，现在都是**4094个**。

#### 转发方式

- 存储转发式交换（Store and Forward）**完整接收数据帧**，缓存、验证、碎片过滤，然后转发。
  - **优点：可以提供差错校验和非对称交换。**
  - **缺点：延迟大。**


  - 直通式交换（Cut-through）输入端口扫描到目标地址后**立即开始转发**。
    - **优点：延迟小、交换速度快。**
    - **缺点：没有检错能力，不能实现非对称交换。**


  - 碎片过滤式交换（Fragment Free）开始转发前先检查数据包的长度**是否够64个字节(最小以太网帧)**，如果小于64个字节，说明是冲突碎片，则丢弃；如果大于等于64个字节，则转发该包。


#### 划分


- 根据交换的协议层划分：二层交换机、三层交换机、多层交换机。

  三层交换机包括二层交换机和三层交换机转发，均由硬件实现；通常三层交换机用在单位内部，路由器放置在出口；

  三层交换机除了存储转发外，还可以采用直通交换技术。

- 根据交换机结构划分：固定端口交换机、模块化交换机。

- 根据配置方式划分：**堆叠交换机、非堆叠交换机。**

- 根据管理类型划分：网管交换机、非网管交换机、智能交换机。

- 层次结构划分：**核心交换机、汇聚交换机、接入交换机。**

#### 交换协议

- 二层交换，根据MAC地址交换

- 三层交换，**根据网络地址ip交换**

  ‌**三层交换机能够实现不同VLAN之间的通信**‌，主要原因是它具有路由功能，能够根据IP地址进行路由选择，使得位于不同VLAN中的设备可以通过三层交换机进行相互通信。

- 多层交换，根据端口，应用协议交换

#### 连接方式

**交换机之间的连接方式主要有两种方式：级联和堆叠**

**其中堆叠方式通过专用的堆叠端口使用堆叠电缆进行连接，可以共享背板带宽；级联方式用双绞线通过普通的端口连接在一起，无法共享背板带宽。**

![image-20230515234533749](img/计算机/计算机网络/image-20230515234533749.png)

**堆叠**型交换机。这种交换机具有专门的堆叠端口，用堆叠电缆把一台交换机的UP口连接到另一台交换机的DOWN口，以实现端口数量的扩充，如图 10-1 所示。一般交换机能够堆叠4~9层，堆叠后的所有交换机可以当作一台交换机来统一管理。

 (1) 堆叠技术的优点：3

- 增加网络端口，提高端口密度，**扩充网络带宽。**
- 逻辑上变为一台设备，**简化了本地管理**
- 一台物理设备故障，其他设备可以接管转发、控制平台，**避免了单点故障**。
- 跨设备的链路聚合，物理上的无环网络，**无需再部署STP**
- 链路聚合中的链路全部有效使用，**链路利用率100%**。

 堆叠技术的缺点：

- 堆叠都是私有协议，不支持跨厂商设备堆叠。
- 需要单独购买堆叠线缆。（现在最新的用光纤也能实现堆叠）
- 存在一定资源浪费，特别高端设备，如果2台核心都配置双引擎，堆叠后只有1个引擎工作。
- 系统升级会造成业务中断
- 可靠性风险：控制层面统一后，相当于把鸡蛋放在一个篮子里，如果整个逻辑设备的控制平面出现问题（比如说路由表被人攻击破坏），就有可能导致整机瘫痪，影响的范围大。



**级联**交换机。这种交换机没有堆叠端口，但可以通过级联方式进行扩充。级连模式使用以太网端口（100M FE端口、GE端口或10GE端口）进行层次间互联，可以通过统一的网管平台实现对全网设备的管理。**为了保证网络运行的效率，级连层数一般不要超过4层。**

#### 网络的分层结构

网络的分层结构把复杂的大型网络分解为多个容易管理的小型网络，每一层交换设备分别实现不同的特定任务。分层的网络设计如图10-3所示。

![image-20230515234658605](img/计算机/计算机网络/image-20230515234658605.png)

- 接入层交换机。接入层是工作站连接网络的入口，实现用户的网络访问控制，这一层的交换机应该以低成本提供高密度的接入端口。例如，华为S2700系列最多可以提供52个快速以太网端口，适合中小型企业网络使用。
- 汇聚层交换机。汇聚层将网络划分为多个广播/组播域，可以实现 VLAN 间的路由选择，并通过访问控制列表实现分组过滤。这一层交换机的端口数量和交换速率要求不是很高，但应提供第三层交换功能。例如，华为S5700-SI系列交换机具有多个10M/100M/1000M Base-T 端口和**千兆 SFP** 端口，可以支持多种光模块收发器，同时提供先进的服务质量（Qos）管理和速度限制，以及安全访问控制列表、组播管理和高性能的 IP 路由。
- 核心层交换机。核心层应采用可扩展的高性能交换机组成园区网的主干线路，提供链路冗余、路由冗余、VLAN 中继和负载均衡等功能，并且与汇聚层交换机具有兼容的技术，支持相同的协议。例如，华为 S6700 系列交换机就是一种适合部署到核心网络的交换机。

#### 交换机接口工作模式

- 链路端口

  - Access：只能属于1个VLAN，一般用于连接计算机端口（计算机和交换机）。

    当一个端口属于vlan 10时，那么带着vlan 10的数据帧会被发送到交换机这个端口上，当这个数据帧通过这个端口时，vlan 10 tag 将会被剥掉，到达用户电脑时，就是一个以太网的帧。而当用户电脑发送一个以太网的帧时，通过这个端口向上走，那么这个端口就会给这个帧加上一个vlan 10 tag。而其他vlan tag的帧则不能从这个端口上下发到电脑上。

  - 2:Trunk：可以允许多个VLAN通过，可以接收和发送多个VLAN的报文，一般用于交换机之间连接的端口

    - 核心技术：打标（给信息打上标签）

      在trunk链路中传递多VLAN 流量时，对流量进行VLAN 的标记，利于对方识别出VLAN并进行数据转发。

      标记协议为 802.1q (dot1q) 在二层以太网封装中的源Mac地址与类型字段之间加入4字节的tag进行VLAN标记，同时使用新的FCS替换旧的FCS (FCS 帧校验序列， 默认为4字节，用于校验数据完整性)

    - **目的：通过一根网线，传递不同VLAN信息。**

  - 3：Hybird:可以允许多个VLAN通过，可以接收和发送多个VLAN 报文，可以用于交换机的间连接也可以用于连接用户计算机

#### vlan

**VLAN是指在一个物理网段内进行逻辑的划分**，划分成若干个虚拟局域网。VLAN最大的特性是**不受物理位置的限制**，可以进行灵活的划分。VLAN具备了一个物理网段所具备的特性。相同VLAN内的主机可以相互直接通信，**不同VLAN间的主机之间互相访问必须经由路由设备进行转发**。广播数据包只可以在本VLAN内进行广播，不能传输到其他VLAN中。

- Port VLAN是实现VLAN的方式之一，它利用交换机的端口进行VLAN的划分，一个端口只能属于一个VLAN

- Tag VLAN是基干交换机端口的另外一种类型，主要用于使交换机的相同Vlan内的主机之间可以直接访问，同时对于不同Vlan的主机进行隔离。

  Tag VLAN遵循IEEE802.1Q协议的标准。在使用配置了Tag VLAN的端口进行数据传输时，**需要在数据帧内添加4个字节的802.1Q标签信息**，用于标示该数据帧属于那个VLAN，便于对端交换机接收到数据帧后进行准确的过滤。

### 路由

#### 接口

广域网WAN端口和局域网LAN端口。

RJ45端口：常规以太网电口。

以太网光口：SC/GBIC/SFP/SPF+/SFP28

AUI端口：用于令牌环或总线型以太网接口。

Serial串口：用于连接DDN、帧中继、X.25、PSTN等网络。

ISDN BRI/PRI端口：ISDN线路互联。

SDH POS接口：155M/622M/2.5G/10G。

#### 静态路由-缺省路由

**生成路由表主要有两种方法：手工配置和动态配置，即静态路由协议配置和动态路由协议配置。**

- 静态路由是指由网络管理员手工配置的路由信息。静态路由除了具有简单、高效、可靠的优点外，它的另一个好处是网络安全保密性高。

  - 配置简单.
  - 手工配置，可控性高。
  - **节省网络带宽**。
  - 网络大，工作量大，比如配置1000条静态路由。
  - 网络故障，**无法响应拓扑动态变化**。

- **缺省路由**可以看作是静态路由的一种特殊情况。当数据在查找路由表时，没有找到和目标相匹配的路由表项时，为数据指定的路由。

  默认路由（Defauit Route）是在路由器无法找到通往目标的路径时使用的转发通路。一般来说，当路由器收到了一个分组，其目标地址在路由表中找不到时，该分组就被丢弃。这与交换机对未知分组进行泛洪（flooding）发送是不同的，在路由表中设置的**默认路由是用来转发未知分组的通路**，配置默认路由可以把以上命令中的目标网络号和子网掩码表示为“0.0.0.0 0.0.0.0”，其含义是所有网络的所有主机

  - 默认路由是一种特殊的静态路由，走投无路的选择。
  - 配置简单，简化管理。
  - 降低路由 CPU、内存资源。
  - 使用场景：网络出口路由器/防火墙/核心交换机。

#### 路由优先级

越小越优先

![image-20240816153014244](img/计算机/计算机网络/image-20240816153014244.png)

OSPF

- 内部network宣告的路由优先级为10
- 外部用import宣告的优先级为150

### NAT

#### NAT产生的技术背景

随着互联网用户的增多，IPv4的公有地址资源显得越发短缺。

同时IPv4公有地址资源存在地址分配不均的问题，这导致部分地区的IPv4可用公有地址严重不足。

**一方面NAT缓解了IPv4地址短缺的问题，另一方面NAT技术让外网无法直接与使用私有地址的内网进行通信，提升了内网的安全性。**

#### NAT技术原理

- NAT：对IP数据报文中的IP地址进行转换，是一种在现网中被广泛部署的技术，**一般部署在网络出口设备，例如路由器或防火墙上。**
- NAT的典型应用场景：在私有网络内部（园区、家庭）使用私有地址，出口设备部署NAT，对于"从内到外”的流量，网络设备通过NAT将数据包的源地址进行转换（转换成特定的公有地址），而对于“从外到内的"流量，则对数据包的目的地址进行转换。
- 通过私有地址的使用结合NAT技术，可以有效节约公网IPv4地址。

<img src="img/计算机/组网/image-20240829140703782.png" alt="image-20240829140703782" style="zoom:50%;" />

## cisco

### 命令

#### 常规

退回到上一级模式（exit）；

直接退回到特权模式（end）；

帮助信息（如？、co？、copy？）

命令自动补齐（Tab）；

Reload重启。

#### 模式

- 用户模式 Swtich>
- 特权模式 Swtich#	en
  - show interface显示接口状态
  - show run查看当前生效的配置信息
  - show vlan
  - show ip rou
  - show ip nat translations 
  - show spanning-tree查看生成树协议


- 全局配置模式Swtich（config）#   conf t


    - 修改交换机名称（hostname X）；


    - 交换机线路视图模式 line console 0


    - 交换机端口视图模式 
    
      ```
      int f0/1 
      int range f0/1-5  //同时配置多个端口1-5 加个range即可
      ```
    
      - no sh  //打开端口
      - 配置交换机端口参数（speed、duplex（双工模式：全双工，半双工））；
      - 查看交换机版本信息（show  version）；
      - **将交换机端口分配到VLAN** switchport access vlan <1-4094>
      - **配置Tag VLAN** switchport mode trunk
      - ip address  IP subnetmask //给端口如VLAN1配置IP地址以及子网掩码



> no shutdown代表什么意思,为什么**每次为端口分配ip后都需要这句话**,是不是必须得?
>
> No shutdown是开启端口的意思,路由器启机以后端口默认的状态是shutdown的,所以必须用no shutdown来开启端口。接口如果被shutdown了，即使接了网线，网络也是无法通行的

### 远程登录

技术原理

交换机的管理方式基本分为两种：带内管理和带外管理。

- 通过远程Telnet、拨号等方式属于带内管理。

- 通过交换机的Console端口管理交换机属于带外管理；这种管理方式不占用交换机的网络端口，**第一次配置交换机必须利用Console端口进行配置**。


<img src="img/计算机/计算机网络/image-20230222103603882.png" alt="image-20230222103603882" style="zoom:67%;" />

> line vty 0 4 
>
> line vty 0 4，该命令是允许用户远程登陆，即**不用用户插Console线缆，只要设备连接网络，配置了接口IP地址即可远程使用Telnet、或者[ssh](https://so.csdn.net/so/search?q=ssh&spm=1001.2101.3001.7020)的方式登陆到设备上**，，CISCO设备一般支持16个并行的远程虚拟终端，按照编号就是：0 - 15.， Line vty 0 4 就是指同时允许5个虚拟终端登陆进行配置,需注意这里配置完成后一定要注意配置enable的密码，要不Telnet是上不去的

- switch（config）#enable password 888 //设置进入特权模式进的密码；


- Switch（config）#line console 0 //可以设置通过console端口连接设备及telnet远程登录时所需要的密码。
- Switch（config-line）#password 777
- Switch（config）#login  //允许登录
- Switch（config）#line vty 04 ////设置最多可以有16终端接入,如果命令是line vty 0 4表示是最多允许5个接入
- Switch（config-line）#password 123//设置远程（telnet）登录密码为123
- Switch（config）#login

### 交换机

#### 交换机划分VLAN配置

**实验目标**
理解虚拟 LAN（VLAN）基本原理；掌握一般交換机按端口划分 VLAN 的配置方法；掌握Tag VLAN配置方法。

**实验背景**
某一公司内财务部、销售部的PC通过2台交换机实现通信；要求财务部和销售部内的PC可以互通，但为了数据安全起见，销售部和财务部需要进行互相隔离，现要在交换机上做适当配置来实现这一目的。

#### 三层交换机实现不同vlan路由转发功能

三层交换的工作原理可以用以下通信实现过程来描述：

①假设两个使用IP协议的站点A、B通过第三层交换机进行通信，发送站点A在开始发送时，把自己的IP地址与目的站点B的IP地址比较，判断B是否与自己在同一子网内。若目的站B与发送站A在同一子网内，则直接进行二层的转发。
②若两个站点不在同一子网内，发送站A则要向“默认网关”发出ARP（地址解析）封包，而“默认网关”的IP地址其实是三层交换机的三层交换模块。
③当发送站A对“默认网关”的IP地址广播出一个ARP请求时，若三层交换模块在以前的通信过程中已经知道B站的MAC地址，则向发送站A回复B的MAC地址；否则，三层交换模块根据路由信息向B站广播一个ARP请求。
④B站得到此ARP请求后向三层交换模块回复其MAC地址，由三层交换模块保存此地址并回复给发送站A；同时将B站的MAC地址发送到二层交换引擎的MAC地址表中。
⑤此后，A向B发送的数据帧便全部交给二层交换处理，信息得以高速交换。

<img src="img/计算机/计算机网络/微信图片_20220616151120.png" alt="微信图片_20220616151120" style="zoom:67%;" />

实验目标
掌握交換机Tag VLAN的配置；掌握三层交換机基本配置方法；掌握三层交換机VLAN路由的配置方法通过三层交换机实现VLAN间相互通信；

实验背景
某企业有两个主要部门，技术部和销售部，分处于不同的办公室，为了安全和便于管理对两个部门的主机进行了VLAN的划分，技术部和销售部分处于不同的VLAN。现由于业务的需求需要销售部和技术部的主机能够相互访问，获得相应的资源，两个部门的交换机通过一台三层交换机进行了连接。

![image-20230220171200809](img/计算机/计算机网络/image-20230220171200809.png)



> 二层交换以mac作为通信手段，三层交换路由，以IP作为通信手段

pc:

- ip:192.168.1.2
- 网关:192.168.1.1

二层：

- int f0/2 vlan 2
  - switchport access vlan 2
  - no sh
- int int f0/3 vlan 3
  - switchport access vlan 3
  - no sh
- int f0/1
  - sw mode trunk

三层

- ip routing

  **三层交换机开启路由功能W1(config)#ip routing**

- int vlan 2
  - no sh
  - ip address 192.168.1.1 255.255.255.0
  
- int vlan 3
  - no sh
  - ip address 192.168.2.1 255.255.255.0

### 快速生成树

**实验目标**

理解生成树协议工作原理；掌握快速生成树协议RSTP基本配置方法；

实验背景
学校为了开展计算机教学和网络办公，建立了一个计算机教室和一个校办公区，这两处的计算机网络通过两台交换机互连组成内部校园网，为了提高网络的可靠性，作为网络管理员，你要用2条链路将交换机互连，现要求在交换机上做适当配置，使网络避免环路。

![image-20230222095532285](img/计算机/计算机网络/image-20230222095532285.png)

https://blog.csdn.net/qq_69814495/article/details/137249299

Switch#show spanning-tree 



s1

- 0/1和0/2 trunk

- Switch(config)#:spanning-tree mode rapid-pvst



s2

- 0/1和0/2 trunk
- Switch(config)#:spanning-tree mode rapid-pvst



测试

- 关闭f0/1，f0/2启动

### 路由器

#### 三层交换机和路由配置

交换机端口添加ip可作为管理，互联，网关使用（网关就是去往其它网段的时候需要网关来进行转发）。**没配置ip的一般当作二层接入端口来使用,配置了就是三层交换机**

> 当Router2想要访问Router1后面的许多的网段的时候，不可能手动去添加静态路由，因为那样工作量太大，也容易配置错误，所以这个时候就只用在Router2上面添加一条简单的默认路由就可以了。

- 默认路由：是对IP数据包中的目的地址找不到存在的路由时，路由器所选择的路由（默认路由代表所有网段，不过同时它的优先级也是最低的。）

  ip route 0.0.0.0 0.0.0.0 **10.0.0.2**

- 静态路由：一种路由的方式，路由项（routing entry）由手动配置，而非动态决定

  ip route 192.168.2.0(目标网段) 255.255.255.0 192.168.3.2（下一条地址）

**配置静态路由的命令的格式为：**

router(config)# ip route network [mask] {address | interface} [distance] [permanent]

**其中各参数含义如下：**

- network：目标网络的网络ID。
- mask：目标网络的子网掩码。
- **address：到达目标网络经过的下一跳路由器的入口IP地址。**
- interface：到达目标网络的必经的本地路由器的出口的接口名称。
- distance：管理开销，不需要改变默认管理开销时，使用该参数进行修改。
- permanent：永久有效。如果配置了该选项，即使该接口被关闭，这条静态路由也不会被删除。

例：ip route 192.168.1.0 255.255.255.0 192.168.2.1

其中，192.168.1.0是目标网络的网络ID；255.255.255.0是目标网络的子网掩码；192.168.2.1是下一跳路由器的与本路由器直连的那个接口的IP地址。

#### 单臂路由配置

实验目标
掌握单臂路由配置方法；通过单臂路由实现不同VLAN间互相通信；

实验背景
某企业有两个主要部门，技术部和销售部，分处于不同的办公室，为了安全和便于管理对两个部门的主机进行了VLAN的划分，技术部和销售部分处于不同的VLAN。现由于业务的需求需要销售部和技术部的主机能够相互访问，获得相应的资源，两个部门的交换机通过一台路由器进行了连接。

技术原理
单臂路由：是为实现VLAN间通信的三层网络设备路由器，它只需要一个以太接口，通过创建子接口可以承担所有VLAN的网关，而在不同的VLAN间转发数据。

![image-20230223095212436](img/计算机/计算机网络/image-20230223095212436.png)

交换机

- 0/1，mode trunck
- 0/2,vlan 2
- 0/3,vlan 3

子接口

- 0/0 no shut

- int f0/0.1 //进入路由器0模块第0端口第1子接口

  encapsulation dot1Q 2 //绑定vlan中继协议,封装协议设置为dot1q允许通过的vlan2

  ip address 192.168.1.1 255.255.255.0

- int f0/0.2

  encapsulation dot1Q 3 //封装协议设置为dot1q允许通过的vlan3

  ip address 192.168.2.1 255.255.255.0

#### 静态路由

实验目标

掌握静态路由的配置方法和技巧；掌握通过静态路由方式实现网络的连通性；**熟悉广域网线缆的连接方式；**

实验背景

学校有新旧两个校区，每个校区是一个独立的局域网，为了使新旧校区能够正常相互通讯，共享资源。每个校区出口利用一台路由器进行连接，两台路由器间学校申请了一条2M的DDN专线进行相连，要求你做适当配置实现两个校区间的正常相互访问。

技术原理

路由器属于网路层设备，能够根据IP包头的信息，选择一条最佳路径，将数据包转发出去。实现**不同网段的主机之间的互相访问**。路由器是根据路由表进行选路和转发的。而路由表里就是由一条条路由信息组成。

![image-20230227154903322](img/计算机/计算机网络/image-20230227154903322.png)

r1

- int f1/0
  - no shutdown
  - ip address 192.168.1.1 255.255.255.0

- int serial 2/0

  - ip address 192.168.3.1 255.255.255.0
  - clock rate 64000
  - no shutdown

- ip route 192.168.2.0 255.255.255.0 192.168.3.2 （匹配192.168.2.0网段的下一条地址192.168.3.2）


  - show ip route

    > C    192.168.1.0/24 is directly connected, FastEthernet1/0
    >
    > S    192.168.2.0/24 [1/0] via 192.168.3.2
    >
    > C    192.168.3.0/24 is directly connected, Serial2/0

r2


  - int s 2/0

    - ip address 192.168.3.2 255.255.255.0
  - int f1/0

    - ip address 192.168.2.1 255.255.255.0
  - ip route 192.168.1.0 255.255.255.0 192.168.3.1

- show ip route

  > S    192.168.1.0/24 [1/0] via 192.168.3.1
  >
  > C    192.168.2.0/24 is directly connected, FastEthernet1/0
  >
  > C    192.168.3.0/24 is directly connected, Serial2/0

  

#### rip动态路由配置

实验目标
掌握RIP协议的配置方法；掌握查看通过动态路由协议RIP学习产生的路由；熟悉**广域网**线缆的连接方式；

实验背景
假设校园网通过一台三层交换机连到校园网出口路由器上，路由器再和校园外的另一台路由器连接。现要做适当配置，实现校园网内部主机与校园网外部主机之间的相互通信。为了简化网管的管理维护工作，学校决定采用RIP V2协议实现互通。

技术原理
RIP（Routing Information Protocols，路由信息协议）是应用较早、使用较普通的IGP内部网关协议，适用用于小型同类网络，是距离矢量协议；RIP协议跳数做为衡量路径开销的，RIP协议里规定最大跳数为15

RIP协议有两个版本：RIPv1和RIPv2，

RIPv1属于有类路由协议，不支持VLSM，以**广播**形式进行路由信息的更新，**更新周期为30秒**；

RIPv2属于无类路由协议，支持VLSM，以**组播**形式进行路由更新。

![image-20230301232659899](img/计算机/计算机网络/image-20230301232659899.png)



router rip 激活rip协议

- version 2 启用rip版本2

- network 邻近网络段

network + 直连网段 发布直连网段


交换机

- f0/10 vlan10 192.168.1.1
- f0/20 vlan20 192.168.3.1
- router rip 启动RIP路由协议
  - network 192.168.1.0 **设置发布路由**
  - network 192.168.3.0
  - version 2


r1

- f0/0 192.168.3.2
- s2/0 192.168.4.1
- router rip
  - network 192.168.3.0
  - network 192.168.4.0
  - version 2
  - clock rate 64000(dce线缆需要配置时钟)

r2

- f0/0 192.168.2.1
- s2/0 192.168.4.2
- router rip
  - version 2
  - network 192.168.2.0
  - network 192.168.4.0

#### OSPF动态路由配置

- 实验目标

  掌握OSPF协议的配置方法；掌握查看通过动态路由协议OSPF学习产生的路由；熟悉广域网线缆的连接方式；

- 实验背景

  假设某公司通过一台三层交换机连到公司出口路由器上，路由器再和公司外的另一台路由器连接。现要做适当配置，实现公司内部主机与公司外部主机之间的相互通信。为了简化网管的管理维护工作，公司决定采用OSPF协议实现互通。

- 技术原理

  OSPF开放式最短路径优先协议，是目前网络中应用最广泛的路由协议之一。属于内部网关路由协议，能够适应各种规模的网络环境，是典型的链路状态协议。OSPF路由协议通过向全网扩散本设备的链路状态信息，**使网络中每台设备最终同步一个具有全网链路状态的数据库，然后路由器采用SPF算法，以自己为根，计算到达其他网络的最短路径，最终形成全网络路由信息。**

![image-20230320112402010](img/计算机/计算机网络/image-20230320112402010.png)bu

router ospl +process-ID 激活OSPF协议

network+直连网段+area+区域号 发布直连网段

交换机

- vlan 10
  - int f0/10 
  - switchport vlan 10
  - ip address  192.168.1.1
- vlan 20
  - int f0/20
  - ip address 192.168.3.1
  - switchport vlan 20

- router ospf 1
  - network 192.168.1.0 0.0.0.255 area 0
  - network 192.168.3.0 0.0.0.255 area 0

路由器1

- int f0/0
  - ip address 192.168.3.2 255.255.255.0
- int serial 2/0
  - no shutdown 
  - clock rate 64000
  - ip address 192.168.4.1 255.255.255.0

- router ospf 1
  - network 192.168.3.0  0.0.0.255  area 0
  - network 192.168.4.0  0.0.0.255  area 0

路由器2

- int f0/0
  - ip address 192.168.2.1 255.255.255.0
- int serial 2/0
  - no shutdown 
  - clock rate 64000
  - ip address 192.168.4.2 255.255.255.0

- router ospf 1
  - network 192.168.2.0  0.0.0.255  area 0
  - network 192.168.4.0  0.0.0.255  area 0

### NAT

https://blog.csdn.net/weixin_46232917/article/details/127045314

https://blog.csdn.net/weixin_45988710/article/details/129440193

NAT分为两种类型：

- NAT（网络地址转换）

  - 静态NAT：实现内部地址与外部地址一对一的映射。现实中，一般都用于服务器；
  - 动态NAT：定义一个地址池，自动映射，也是一对一的。现实中，用得比较少；

- NAPT（**网络端口**地址转换IP地址对应一个全局地址）。

  **NAPT：使用不同的端口来映射多个内网IP地址到一个指定的外网IP地址，多对一。**



定义公网地址池

Router(config)#ip nat pool 地址池名 起始IP 目的IP netmask 子网掩码

Router(config)#ip nat pool WIP 23.34.56.100 23.34.56.102 netmask 255.255.255.0

**ip nat inside source static 192.168.1.2 222.0.1.3(定义内部本地地址到内部全局地址 222.0.1.3的映射)**

ip nat outside source（定义外部全局地址到外部本地地址的映射）

#### 网络地址转换

实验目标
理解NAT网络地址转换的原理及功能；掌握静态NAT的配置，实现局域网访问互联网；

实验背景
你是某公司的网络管理员，欲发布公司的WWW服务。现要求将**内网Web服务器IP地址映射为全局IP地址，实现外部网络可访问公司内部Web服务器**。

技术原理

网络地址转换NAT（Network Address Translation），被广泛应用于各种类型Internet接入方式和各种类型的网络中。原因很简单，**NAT不仅完美地解决了IP地址不足的问题，而且还能够有效地避免来自网络外部的攻击，隐藏并保护网络内部的计算机**。

默认情况下，内部IP地址是无法被路由到外网的，内部主机10.1.1.1要与外部internet通信，IP包到达NAT路由器时，IP包头的源地址10.1.1.1被替换成一个合法的外网IP，并在NAT转换表中保存这条记录。当外部主机发送一个应答到内网时，NAT路由器收到后，查看当前NAT转换表，用10.1.1.1替换掉这个外网地址。

NAT将网络划分为内部网络和外部网络两部分，局域网主机利用NAT访问网络时，是将局域网内部的本地地址转换为全局地址（互联网合法的IP地址）后转发数据包；



![image-20230320215916055](img/计算机/计算机网络/image-20230320215916055.png)

r1

- int f0/0
  - ip address 192.168.1.1 255.255.255.0
- int s 2/0
  - ip address 222.0.1.1 255.255.255.0
  - clock rate 64000
- 静态路由
  - ip route 222.0.2.0 255.255.255.0 222.0.1.2（下一条地址）
- **指定内外部端口**
  - int f 0/0
    - ip nat inside

  - int s 2/0
    - ip nat outside

  - **ip nat inside source static 192.168.1.2 222.0.1.3(将内部IP地址转为外部IP 222.0.1.3)**

r2

- int s 2/0
  - ip address 222.0.1.2 255.255.255.0
- int f0/0
  - ip address 222.0.2.1 255.255.255.0
- 静态路由
  - ip route 192.168.1.0 255.255.255.0 222.0.1.1
  - **配置默认路由：ip route 0.0.0.0 255.255.255.255 0.0.0.0**



#### 网络端口地址转换NAPT配置

实验目标

理解NAT网络地址转换的原理及功能；掌握NAPT的配置，实现局域网访问互联网；

实验背景

你是某公司的网络管理员，公司办公网需要接入互联网，公司只向ISP申请了一条专线，该专线分配了三个公网IP地址，配置实现全公司的主机都能访问外网。

技术原理
NAT将网络划分为内部网络和外部网络两部分，局域网主机利用NAT访问网络时，是将局域网内部的本地地址转换为全局地址（互联网合法的IP地址）后转发数据包；NAT分为两种类型：NAT（网络地址转换）和NAPT（网络端口地址转换IP地址对应一个全局地址）。
NAPT：使用不同的端口来映射多个内网IP地址到一个指定的外网IP地址，**多对一**。
NAPT采用**端口多路复用**方式。内部网络的所有主机均可共享一个合法外部IP地址实现对Internet的访问，从而可以最大限度地节约IP地址资源。同时，又可隐藏网络内部的所有主机，有效避免来自internet的攻击。因此，目前网络中应用最多的就是端口多路复用方式。

![image-20230326212508144](img/计算机/计算机网络/image-20230326212508144.png)

**指定内外部端口**

- int f 0/0
  - ip nat inside
- int s 2/0
  - ip nat outside

- access-list 1 permit 192.168.1.0 0.0.0.255
- ip nat pool 5ijsj 200.1.1.3 200.1.1.3 netmask 255.255.255.0
- ip nat inside source list 1 pool 5ijsj overload 

### 路由器综合路由配置

实验目标
掌握综合路由的配置方法；掌握查看通过路由重分布学习产生的路由；熟悉广域网线缆的连接方式；

实验背景
假设某公司通过一台三层交换机连到公司出口路由器R1上，路由器R1再和公司外的另一台路由器R2连接。**三层交换机与R1间运行RIPV2路由协议，R1与R2间运行OSPF路由协议。现要做适当配置，实现公司内部主机与公司外部主机之间的相互通信。**

技术原理
为了支持本设备能够运行多个路由协议进程，系统软件提供了路由信息从一个路由进程重分布到另外一个路由进程
的功能。比如你可以将OSPF路由域的路由重新分布后通告RIP 路由域中，也可以将RIP 路由域的路由重新分布后通告到OSPF 路由域中。路由的相互重分布可以在所有的IP 路由协议之间进行。
要把路由从一个路由域分布到另一个路由域，并且进行控制**路由重分布**，在路由进程配置模式中执行以下命令：

redistribute protocol
[metric metric] [metricpe metric-type] [match internal | external type | nssa-external type] [tag tag] [route-map route-map-name] [subnets]

![image-20230327091914476](img/计算机/计算机网络/image-20230327091914476.png)



S1

- vlan 2 f0/10 192.168.2.1
- vlan 1 f0/1   192.168.1.1

r1

- int 0/0 192.168.2.2
- int 1/0 192.168.3.1
- router rip
  - network 192.168.2.0
  - version 2
- router ospf 1
  - network 192.168.3.0 0.0.0.255 area 0

r2

- int 1/0 192.168.3.2

- int 0/0 192.168.4.1
- router ospf 1
  - network 192.168.3.0 0.0.0.255 area 0
  - network 192.168.4.0 0.0.0.255 area 0
- 路由重分布
  - router rip
    - redistribute ospf 1
  - router ospf 1
    - redistribute rip subnets 



### ACL控制列表配置

实验目标
理解标准IP访问控制列表的原理及功能；掌握编号的标准IP访问控制列表的配置方法；

实验背景
你是公司的网络管理员，公司的经理部、财务部门和销售部分别属于不同的3个网段，三部门之间用路由器进行信息传递，为了安全起见，公司领导要求销售部门不能对财务部进行访问，但经理部可以对财务部进行访问。
PC1代表经理部的主机、PC2代表销售部的主机、PC3代表财务部的主机。

技术原理
ACLs的全称为接入控制列表（Access Control Lists），**也称为访问列表（Access Lists），俗称为防火墙，在有的文档中还称之为包过滤**。ACLs通过定义一些规则对网络设备接口上的数据报文进行控制：允许通过或丢弃，从而提高网络可管理性和安全性；**IP ACL分为两种：标准IP访问列表和扩展IP访问列表**，编号范围分别为1~ 99、1300~ 1999，100~ 199，2000~2699；

标准IP访问列表可以根据数据包的源IP地址定义规则，进行数据包的过滤；

扩展IP访问列表可以根据数据包的源IP、目的IP、源端口、目的端口、协议来定义规则，进行数据包的过滤；IP ACL基于接口进行规则的应用，分为：入栈应用和出栈应用；

![image-20230517154011558](img/计算机/计算机网络/image-20230517154011558.png)

配置静态路由

r1

- ip route 172.16.4.0 255.255.255.0 172.16.3.2

r2

- ip route 0.0.0.0 0.0.0.0 172.16.3.1

r1

- ip access-list standard 5ijsj
  - permit 172.16.1.0 0.0.0.255(或者deny 172.16.2.0 0.0.0.255)

- int s2/0
  - ip access-group 5ijsj out

## 华为

### 安装

https://blog.csdn.net/qq_45945548/article/details/124512961

### 视图命令

> 命令尽量不要缩写

![image-20230519170915387](img/计算机/计算机网络/image-20230519170915387.png)

- 用户视图

  - save //保存 
  
  
    - reboot //重启设备
  


- system-view进入系统视图


  - 设置

    - sysname name更改设备名字
    - telnet server enable//开启设备telnet功能
    - 设置时间

      - clock timezone设置所在时区
      - clock datetime设置当前时间和日期
      - clock daylight-saving-time设置采用夏时制
    - **undo info-center enable 阻断提示信息**

  - 查看

    - display this 查看最近命令

    - dis current-configuration查看所有配置命令

      dis current-configuration | b display vlan 查看从display vlan开始后面的所有配置命令

    - display interface brief 查看接口

    - display ip interface brief 查看接口ip

    - display vlan

    - display ip routing-table 查看路由表

    - display eth-trunk 

    - display transceiver interface 命令用来**显示设备接口上的光模块信息**。

    - display bfd session all

  - rip
    - display current-configuration configuration rip
    - display rip
    - display rip 1 interface

  - ARP

    [huawei] arp static 192.168.1.8 5489-98cf-2603 //绑定

    [huawei] display arp

    [huawei] display arp all //查看 ARP

- int g0/0/0 接口视图
  - ip address 192.168.2.2 24 添加端口地址
  - undo ip address 192.168.2.2 2 24取消端口地址

### 华为设备登录配置

AAA是Authentication（认证）、Authorization（授权）和Accounting（计费）的简称，是[网络安全](https://cloud.tencent.com/product/ns?from=20065&from_column=20065)的一种管理机制，提供了认证、授权、计费三种安全功能

这三种安全功能的具体作用如下：

• 认证：验证用户是否可以获得网络访问权。

• 授权：授权用户可以使用哪些服务。

• 计费：记录用户使用网络资源的情况。



- telnet server enable //开启设备telnet功能

- user-interface vty  0 4 //开启登录端口0-4。vty0 4表示允许5个用户同时登录
  
  - [Huawei-ui-vty0-4]**protocol inbound telnet** //通过telnet协议登录
  
  - 认证模式：密码模式和AAA模式
  
    - [Huawei-ui-vty0-4]authentication-mode password （用户认证模式为密码模式）
  
    ```
    [Huawei-ui-console0]authentication-mode password 
    Please configure the login password (maximum length 16):123456   
    ```
  
    - [Huawei-ui-vty0-4]authentication-mode aaa //认证方式为aaa（用户认证模式为账号密码模式）
  
- [Huawei]aaa //启用aaa

  - 配置用户

    - local-user admin123 password cipher 123//配置用户名密码
      
    - [Huawei-aaa]local-user admin123 service-type telnet //用户用于telnet
    
    - [Huawei-aaa]local-user admin123 privilege level 15 //用户等级为15
    
      ![image-20230520231727257](img/计算机/计算机网络/image-20230520231727257.png)
    
  - 设置登录信息

    - header login
      用户登录前显示的标题消息
    - header shell
      用户登录后显示的标题消息

### 交换机

#### 基础配置

- vlan batch 10 20 30 40
- undo vlan 40

- [huawei] **interface Vlanif 1** //进入三层vlanif接口
  - [huawei-Vlanif1] ip address 192.168.1.254 24 //配置 IP
  - [huawei-Vlanif1] undo shutdown // 开启接口

- interface GigabitEthernet 0/0/1//进入端口
  - port link-type **access** 
  - port **default** vlan 10 把接口划入vlan100
  - undo shutdown (开启端口)
  - undo port default vlan 将端口从vlan删除 
  - port link-type hybrid(将端口类型恢复成默认的hybrid模式)
  - 配置交换机端口速率
    - [huawei- gigabitEthernet 0/0/1] speed 10 //速率 10M
    - [huawei- gigabitEthernet 0/0/1] auto speed 100 //自动
  - 双工
    - [huawei- g0/0/1]duplex full //全双工
    - [huawei- gigabitEthernet 0/0/1] auto duplex full //自动

#### 三层交换

‌**三层交换机能够实现不同VLAN之间的通信**‌，主要原因是它具有路由功能，能够根据IP地址进行路由选择，使得位于不同VLAN中的设备可以通过三层交换机进行相互通信。

- VLAN（Virtual Local Area Network）的中文名为"虚拟局域网"。与传统的局域网技术相比较，VLAN技术更加灵活，它具有以下优点：网络设备的移动、添加和修改的管理开销减少；可以控制广播活动；可提高网络的安全性。

- VLANIF（Virtual Local Area Network Interface）的中文名为"虚拟局域网接口"，是华为交换机的一个配置项，应用于三层交换机。这是一种逻辑接口，物理上不存在。

- 关系

  - vlan是二层概念，用于划分逻辑网段，vlan互通需要三层通信

  - vlanif被配置在这个三层网络上。vlanif是一个三层逻辑端口，**在二层网络中作为网关存在**。

  - vlanif需要配置ip，vlan不需要

**在配置好二层vlan后，三层交换机上使用vlanif命令建立对应vlan的路由，配置完成后，可以实现VLAN之间的通信。**

<img src="img/计算机/组网/4c4328fe74691b99959fa12bf10e4a0d.png" alt="img" style="zoom:50%;" />

将连接PC1的接口划分进vlan10，PC2划分进vlan20（未划分前默认所有接口都是vlan1）

```
[SW2]vlan batch 10 20 #创建vlan 10和20
[SW1]int Vlanif 10 #进入三层vlanif接口,vlan10配置PC1的网关
[SW1-Vlanif10]ip add 1.1.1.254 24 
[SW1-Vlanif10]int Vlanif 20 #进入vlan20配置PC2的网关
[SW1-Vlanif20]ip add 2.2.2.254 24
[SW1-Vlanif20]q

[SW2]int g0/0/2
[SW2-GigabitEthernet0/0/2]port link-type access #将接口配置为access类型
[SW2-GigabitEthernet0/0/2]port default vlan 10 #将接口加入vlan 10
[SW2]int g0/0/3
[SW2-GigabitEthernet0/0/3]port link-type access
[SW2-GigabitEthernet0/0/3]port default vlan 20
[SW2]int g0/0/1
[SW2-GigabitEthernet0/0/1]port link-type trunk #将接口配置为access类型
[SW2-GigabitEthernet0/0/1]port trunk allow-pass vlan all #允许所有vlan通过
```

三层交换机配置

网关配置在三层交换机上，流量路径PC1->SW2->SW1->SW2->PC2

```
[SW1]vlan batch 10 20
[SW1]int g0/0/1
[SW1-GigabitEthernet0/0/1]port link-type trunk 
[SW1-GigabitEthernet0/0/1]port trunk allow-pass vlan 10 20或者port trunk allow-pass vlan all #允许所有vlan通过
```



#### 链路聚合

链路聚合实验原理是**将多条以太网物理链路捆绑在一起成为一条逻辑链路，以实现增加链路带宽的目的**。此外，这些捆绑在一起的链路通过相互的动态备份，有效的提高了链路的可靠性。

![img](https://img-blog.csdnimg.cn/a7b75962cd5a44579fb18f4d49d05335.png)

链路聚合手动模式

```
[SW1]int Eth-Trunk 10  //创建聚合组序号为10
[SW1-Eth-Trunk10]trunkport GigabitEthernet 0/0/1 to 0/0/3 //把g0/0/1到0/0/3添加到组
[SW1-Eth-Trunk10]port link-type trunk //把三个端口设置为Trunk口
[SW1-Eth-Trunk10]port trunk allow-pass vlan all //允许所有的VLAN通过
```

```
[SW2]int Eth-Trunk 10
[SW2-Eth-Trunk10]trunkport GigabitEthernet 0/0/1 to 0/0/3
Info: This operation may take a few seconds. Please wait for a moment...done.
[SW2-Eth-Trunk10]port link-type trunk 
[SW2-Eth-Trunk10]port trunk allow-pass vlan all 
```

链路聚合LACP模式

```
[SW1]int Eth-Trunk 10  //创建链路聚合组10
[SW1-Eth-Trunk10]mode lacp-static //配置链路聚合模式LACP
```

```
[SW2]int Eth-Trunk 10
[SW2-Eth-Trunk10]mode lacp-static
[SW2-Eth-Trunk10]trunkport GigabitEthernet 0/0/1 to 0/0/3
```

在SW1和SW2上修改最小和最大活动接口：在SW1与SW2设置[链路聚合](https://so.csdn.net/so/search?q=链路聚合&spm=1001.2101.3001.7020)活动接口数量下限为2，最大活动链路数量为2。即把两个千兆接口为活动接口，一个为备用接口，当有活动接口出现故障，将会启动备用接口。

```
[SW1-Eth-Trunk10]least active-linknumber 2  //设置最大活动端口数为2
[SW1-Eth-Trunk10]max active-linknumber 2  //设置最大活动端口数为2
```

![image-20240409141925572](img/计算机/组网/image-20240409141925572.png)

从上图可看出G0/0/3接口已成为备用接口，即不再转发数据。

步骤2：

为满足实际需求，我们将SW3作为LACP主动端，用它来决定活动接口的选择，并将G0/0/3接口更改为活动接口，G0/0/1更改为备用端口。命令：lacp priority （priority） ，原理是修改优先值，**优先值越小，优先级越高**。LACP协议会将优先级高的选择为活动端口

- 将G0/0/3接口更改为活动接口：
  - int g0/0/3
    - lacp priority 30000

- 将G0/0/1设置为备用端口
  - int g0/0/1
    - lacp priority 40000

![image-20240409142630568](img/计算机/组网/image-20240409142630568.png)

步骤3：

从上图可看出G0/0/1端口的优先级虽然修改成功，但仍然为活动端口，原因是因为系统未启动LACP抢占功能，开启LACP抢占功能后才可使高优先级总是成为活动端口，命令为：lacp preempt enable.

并在配置LACP抢占功能的同时，为其配置时延，时延的作用是避免端口切换状态时导致数据传输不稳。命令为：lacp preempt delay（time)。

在SW1上修改LACP抢占功能并且查看信息

```
[SW1]int Eth-Trunk 10
[SW1-Eth-Trunk10]lacp preempt enable//启用LACP抢占功能
[SW1-Eth-Trunk10]lacp preempt delay 10//抢占延迟为10
[SW1-Eth-Trunk10]quit
```

**验证：关闭接口0/0/3**

### 路由

![image-20241023230114479](img/计算机/组网/image-20241023230114479.png)

- 直连路由：路由器本地接口所在网段。
  静态路由：手工配置的路由条目。
  动态路由：路由器之间通过动态路由协议学习到的路由。

#### 命令

[huawei] dis ospf interface //查看 ospf 通告

[huawei] dis ospf peer //查看 ospf 邻居

[huawei] dis ip routing-table //查看路由表

[huawei] dis ospf routing //查看 ospf 路由表

[huawei] display bgp peer//查看*BGP*对等体信息

#### 静态路由配置

静态路由的配置

- 静态路由的配置（关联下一跳IP的方式）
  
  [Router]ip route-static 网络号 掩码 下一跳IP地址 [preference 60 权重是60]
  
  - **设置备份链路就给权重,优先级越小越优**
  
- 静态路由的配置（关联出接口的方式）[Router]ip route-static 网络号 掩码 出接口

- 静态路由的配置（关联出接口和下一跳IP的方式）[Router]ip route-static 网络号 掩码 出接口 下一跳IP地址

配置示例：

[R1]ip route-static 192.168.100.0 255.255.255.0 192.168.12.2

[R1]ip route-static 192.168.100.0 24 192.168.12.2

<img src="img/计算机/计算机网络/image-20240816163353451.png" alt="image-20240816163353451" style="zoom:50%;" />

#### 默认路由配置

**三层交换机需要指向出口，可直接使用默认路由**

[R1]ip route-static 0.0.0.0 0.0.0.0 192.168.12.2（下一跳接口地址）
或
[R1]ip route-static 0.0.0.0 0 192.168.12.2

#### 动态路由

> 动态路由是外网学习内网的路径，而不是内网学习外网路由路径，因为外网的服务器有几百万个，如果去学习的话会对内部交换机路由器资源损耗

##### RIP协议

![ensp配置rip和ospf的命令 ensp rip配置_基本配置](img/计算机/计算机网络/resize,m_fixed,w_1184)

- 配置各台设备接口的IP地址

  ```
  sysname R1
  #
  interface GigabitEthernet0/0/0
   ip address 10.0.12.1 255.255.255.0
   
   sysname R2
  #
  interface GigabitEthernet0/0/0
   ip address 10.0.12.2 255.255.255.0 
  #
  interface GigabitEthernet0/0/1
   ip address 172.16.23.2 255.255.255.0
  ```

  


- 配置RIPv2，实现网络连通

  **RIP只能宣告直连网络的主类网络号**

  ```
  rip 1
   version 2
   network 172.16.0.0
   network 10.0.0.0
  ```
  
  

顺便，在这里再解释一下上图中为什么要用“**undo summary 关闭路由器自动聚合**”的问题。

可参考：[路由环路产生的原因与问题的解决方法](https://www.fujieace.com/huawei/ensp/rip-undo-summary-route-loop.html)

##### OSPF 协议

[huawei] ospf 1  //查看 ospf 默认是进程 1

[huawei-ospf-1] area 0 //声明**主干区域0**

[huawei-ospf-1-area-0.0.0.0] network  192.168.3.0  0.0.0.255//发布直连网段



接口认证，保证数据传输安全性

[R1]int g0/0/0

[R1-GigabitEthernet0/0/0]ospf authentication-mode md5 1 cipher lbb123

#### BGP配置

https://blog.csdn.net/weixin_44712781/article/details/128388493

BGP（Border Gateway Protocol）是一种不同自治系统的路由设备之间进行通信的外部网关协议(Exterior Gateway Protocol，EGP)，**其主要功能是为了实现网络中不同AS之间的通信，并通过协议自身机制来消除路由环路。**

在BGP中，**两个路由器之间的相邻连接称为对等体连接，两个路由器互为对等体**。如果路由器对等体在同一个AS中，就称为IBGP对等体，否则称为EBGP对等体

![](img/计算机/组网/1b7127b3aa3643b7884f5637fe9e5cc5.)

![image-20240903224826601](C:/Users/liming/AppData/Roaming/Typora/typora-user-images/image-20240903224826601.png)

- 配置接口ip，以及rip

  - R1

    ```
    rip 1
     version 2
     network 100.0.0.0
     network 12.0.0.0
     network 13.0.0.0
    ```

- 配置BGP

   - R3
      - bgp 100 ##开启编号为65009的BGP服务
         - ~~router-id 2.2.2.2##用IPV4格式指定路由器标识符，2.2.2.2必须唯一~~
         - peer 34.1.1.2 as-number 200 ##指定对等体，包括IP地址和自治系统号
   
   
      - R4
        - bgp 200
          - peer 34.1.1.1 as-number 100 ##指定EBGP
          - peer 45.1.1.2 as-number 200 ##指定IBGP
   
   
      - R5
        - bgp 200
   


- 配置路由宣告

   **ipv4-family unicast代表IPv4单播路由的宣告**，将100和200网段宣告出去，把业务网段100和200变成BGP路由

   - R3
     - bgp 100
       - ipv4-family unicast
         - network 100.1.1.0 
   - R5
     - bgp 200
       - ipv4-family unicast
         - network 200.1.1.0 

   

- **配置BGP引入路由。**

   **import-route命令用来引入其他路由协议的路由信息**
   **import-route direct | bgp| rip [ *process-id-rip* ] | static | ospf [ *process-id-ospf* ]**
   
   - R3

     - [AR2]rip 1 或者 ospf 1

       [AR2-bgp-af-ipv4]import-route bgp //将bgp中200.1.1.0网段引入rip/ospf路由中，这样同一个自治系统下，所有的路由器都能学习到200.1.1.0网段

     - bgp 100

       import-route rip 1 //将rip路由信息引入到bgp中，这样R4就能学习到rip中的网段信息

- 查看AR5的路由信息（dis bgp routing-table）

  ![image-20240903231028605](img/计算机/组网/image-20240903231028605.png)

  AR5虽然学习到100.1.1.0路由，但因为下一跳34.1.1.1找不到不可达，所以不是有效路由

  AR4

  - 方法1：通过静态路由加表
  - 配置BGP引入直接路由。
  
    ```
    [AR2]bgp 200
    
    [AR2-bgp]ipv4-family unicast
    
    [AR2-bgp-af-ipv4]import-route direct
    ```
  - 方法2：bgp 200
    - r4对R5宣告bgp路由，把下一跳宣告成自己。peer 45.1.1.2 next-hop-local
  
  ![image-20240903224212896](img/计算机/组网/image-20240903224212896.png)



![image-20240903224428084](img/计算机/组网/image-20240903224428084.png)

#### 单臂路由 VLAN 间通信

https://blog.csdn.net/qq_41555586/article/details/134940167?spm=1001.2014.3001.5501

https://blog.csdn.net/weixin_40943540/article/details/125019554

![img](img/计算机/组网/93c3b90a310d43ffabf085ca5523d58c (1).png)

```
<Huawei>sy
[Huawei]vlan batch 10 20
 
[Huawei]int g0/0/2
[Huawei-GigabitEthernet0/0/2]port link-type access 
[Huawei-GigabitEthernet0/0/2]port default vlan 10
 
[Huawei-GigabitEthernet0/0/2]int g0/0/3
[Huawei-GigabitEthernet0/0/3]port link-type access 
[Huawei-GigabitEthernet0/0/3]port default  vlan 20
 
[Huawei-GigabitEthernet0/0/3]int g0/0/1
[Huawei-GigabitEthernet0/0/1]port link-type trunk 
[Huawei-GigabitEthernet0/0/1]port trunk allow-pass vlan 10 20
 
[Huawei-GigabitEthernet0/0/1]int g0/0/4
[Huawei-GigabitEthernet0/0/4]port link-type trunk 	
[Huawei-GigabitEthernet0/0/4]port trunk allow-pass vlan 1 20
```



```
<Huawei>sy
[Huawei]vlan batch 10 20
 
[Huawei]int g0/0/1	
[Huawei-GigabitEthernet0/0/1]port link-type access 
[Huawei-GigabitEthernet0/0/1]port default vlan 10
 
[Huawei-GigabitEthernet0/0/1]int g0/0/2
[Huawei-GigabitEthernet0/0/2]port link-type access 	
[Huawei-GigabitEthernet0/0/2]port default  vlan 20
 
[Huawei-GigabitEthernet0/0/2]int g0/0/3	
[Huawei-GigabitEthernet0/0/3]port link-type trunk 	
[Huawei-GigabitEthernet0/0/3]port trunk allow-pass vlan 10 20
```



```
<Huawei>sy
[Huawei]undo inf en    //关闭信息提示
[Huawei]dhcp enable 
[Huawei]int g0/0/0.1 //接口0/0/0.1为物理0/0/0的逻辑接口，通过配置逻辑接口，并且将此逻辑接口的ip地址设置为pc的网关地址，此时就可以保证vlan间进行通信
[Huawei-GigabitEthernet0/0/0.1]dot1q termination vid 10 //相当于创建vlan10的access
[Huawei-GigabitEthernet0/0/0.1]ip add 192.168.10.254 24
[Huawei-GigabitEthernet0/0/0.1]arp broadcast enable 	//开启ARP广播。子接口未配置arp broadcast enable，一不能主动发送arp广播报文，二会直接将IP报文丢弃不进行转发。
[Huawei-GigabitEthernet0/0/0.1]dhcp select interface  //用来关联接口和逻辑接口地址池，为连接到接口的主机提供配置信息。
 
[Huawei-GigabitEthernet0/0/0.1]int g0/0/0.2
[Huawei-GigabitEthernet0/0/0.2]dot1q termination vid 20
[Huawei-GigabitEthernet0/0/0.2]ip add 192.168.20.254 24
[Huawei-GigabitEthernet0/0/0.2]arp broadcast  enable
[Huawei-GigabitEthernet0/0/0.2]dhcp  select  interface 
[Huawei-GigabitEthernet0/0/0.2]q
[Huawei]q
<Huawei>save
```



### DHCP配置

https://blog.csdn.net/hongmo2020/article/details/131317342

#### 基础配置

##### 全局地址池

**global配置办法(全局配置)，在系统视图下配置DHCP**

- [Huawei]dhcp enable   //开启dhcp功能

- [Huawei]ip pool 1   //系统视图下创建全局IP地址池1（1是地址池名字）

  - [Huawei-ip-pool-pool-1]network IP网段  //配置全局地址池的可分配的网段地址
    - [R2-ip-pool-tushuguan]network 10.1.1.0 mask 255.255.255.0 //配置地址池可动态分配的IP地址范围

  - [Huawei-ip-pool-pool-1]gateway-list IP地址   //配置全局地址池的网关地址
    - gateway-list 10.1.1.254 

  - [Huawei-ip-pool-1] dns-list IP地址    //配置全局地址池的DNS服务器地址
    - dns-list 8.8.8.8

  - **excluded-ip-address** 10.1.1.2  保留IP地址
  - [Huawei-ip-pool-pool-1] lease {day 天 [hour 小时[minute 分钟] | unlimited}    //配置全局地址池下的租期，默认1天
    - lease day 0 hour 12 minute 0 

- 配置接口

  [Huawei]interface GigabitEthernet 端口编号   //进入端口

  [Huawei-GigabitEthernet0/0/1]dhcp select global//端口选择全局DHCP

##### 接口地址池

> **接口方式的[DHCP配置](https://so.csdn.net/so/search?q=DHCP配置&spm=1001.2101.3001.7020)时，就不再需要配置地址池，而是对应端口的地址段作为地址池**

**在具体接口上配置DHCP**

- [SwitchA] dhcp enable//启用dhcp服务
- [Huawei]interface GigabitEthernet 端口编号   //进入端口
  - [Huawei-GigabitEthernet0/0/0]dhcp select interface  //关联接口地址池。用来关联接口和接口地址池，为连接到接口的主机提供配置信息。
  - [Huawei-GigabitEthernet0/0/0]dhcp server dns-list IP地址   //指定接口地址池下的DNS服务器地址
  - [Huawei-GigabitEthernet0/0/0]dhcp server excluded-ip-address 192.168.10.1 192.168.10.200  **//配置接口地址池中不参与自动分配的IP地址范围，网关是默认排除的**
  - [Huawei-GigabitEthernet0/0/0]dhcp server lease {day 天 [hour 小时[minute 分钟] | unlimited}   //IP地址租用有效期**(缺省情况下，ip地址的租期为1天)**
- [huawei] display ip pool //查看 dhcp

**进入vlan端口**

[Huawei]interface Vlanif 10  //进入vlan端口，**对vlan10中的所有接口配置dhcp**

- dhcp select interface //设置DHCP模式为接口 

#### DHCP option43

Option 43：给AP分配IP地址的同时，告诉AP，AC的地址是多少。

![image-20240825082520095](img/计算机/计算机网络/image-20240825082520095.png)

配置Option 43，使AP能够获得AC的IP地址，假设AC的IP地址是10.10.10.1
[DHCP-HW-ip-pool-huawei]option 43 sub-option 3 ascii 10.10.10.1

#### DHCP Snooping

> 某公司局域网使用DHCP动态获取10.10.10.1/24网段的IP地址，某天公司大量终端获得了192.168.1.0/24网段的地址，可在接入交换机上配置（69）功能杜绝该问题再次出现。DHCP Snooping

*DHCP Snooping*是 DHCP 的一种安全特性，主要应用在 交换机 上，作用是**屏蔽接入网络中的非法的 DHCP 服务器**。即开启 *DHCP Snooping* 功能后，网络中的客户端只有从管理员指定的 DHCP 服务器获取 IP 地址。

[Huawei] dhcp snooping enable
[Huawei] int GigabitEthernet0/0/1
[Huawei-GigabitEthernet0/0/1] dhcp snooping trusted
[Huawei] int GigabitEthernet0/0/2
[Huawei-GigabitEthernet0/0/2] dhcp snooping untrusted

#### 案例：三层交换机配置

![image-20240828114059346](img/计算机/组网/image-20240828114059346.png)

- dhcp enable

  - 接口地址池

     - interface Vlanif10

     ```
     ip address 192.168.10.254 255.255.255.0
     dhcp select interface //pc基于接口DHCP，分配该vlan接口下网段的IP
     dhcp server excluded-ip-address 192.168.10.101 192.168.10.253
     dhcp server dns-list 8.8.8.8
     ```

     - interface GigabitEthernet0/0/1
        port link-type access
        port default vlan 10

  - 全局地址池

     - ip pool 20
        gateway-list 192.168.20.254
        network 192.168.20.0 mask 255.255.255.0
        excluded-ip-address 192.168.20.151 192.168.20.253
        dns-list 9.9.9.9
     - interface Vlanif20
        ip address 192.168.20.254 255.255.255.0
        dhcp select global



### NAT地址转换配置

https://blog.csdn.net/qq_41555586/article/details/135085584

#### NAT类型

- NAT（网络地址转换）

  - 静态NAT（静态一对一映射）：内部网络中的每个主机都被**永久映射**成外部网络中的某个合法的地址。多用于服务器场景。
  
  - 动态NAT（基于地址池一对一映射（NO-PAT）：静态NAT严格地一对一进行地址映射，这就导致即便内网主机长时间离线或者不发送数据时，与之对应的公有地址也处于使用状态。为了避免地址浪费，动态NAT提出了地址池的概念：所有可用的公有地址组成地址池。
  
    在外部网络中定义了一系列的合法地址，采用**动态分配**的方法将内部网络映射到外部网络。
  
- NAPT（基于地址池多对一映射）：PAT的NAT设备用一个私网IP地址**映射到公网IP地址的不同端口上（不同端口号-1~65535对应不同服务）**，从而让多台设备使用一个公网IP地址上网。

  **作用**：改变数据包的IP地址和端口号；节约公共网地址，解决安全问题，负载均衡

  <img src="img/计算机/组网/image-20240830143715659.png" alt="image-20240830143715659" style="zoom: 50%;" />

- easy ip：Easy IP的工作原理与NAPT相同，同时转换IP地址和传输层端口，但与NAPT不同的是，**Easy IP没有地址池的概念，而是使用接口地址作为NAT转换的公有地址**。Easy IP主要应用于**通过路由器WAN接口IP地址作为要被映射的公网IP地址的情形**，特别适合小型局域网接入Internet的情况。这里的小型局域网主要指中小型网吧、小型办公室等环境，一般具有以下特点：内部主机较少、出接口通过拨号方式获得临时（或固定）公网IP地址以供内部主机访问Internet


#### NAT

##### 一对一：静态

- 方法一：全局配置 nat

  - [Huawei] nat static global 12.1.1.2 inside 192.168.1.1 netmask 255.255.255.255
  - [Huawei]interface GigabitEthernet0/0/1 #进入外网口
    - [Huawei-GigabitEthernet0/0/1]nat static enable #启动静态NAT
    - 取消 undo nat static enable
  
- 方法二：接口配置nat

  - [Huawei-GigabitEthernet0/0/1]nat static global 12.1.1.10 inside 192.168.1.1 netmask 255.255.255.255
  - 取消：undo nat static global 12.1.1.10 inside 192.168.1.1 netmask 255.255.255.255
  
  <img src="img/计算机/组网/image-20240831131733030.png" alt="image-20240831131733030" style="zoom:50%;" />
  
  ![image-20240831131643978](img/计算机/组网/image-20240831131643978.png)





##### 多对一：动态

把内网192.168.1.0网段动态 nat 映射到公网 IP（12.1.1.2- 12.1.1.10）

- 创建地址池
  - [huawei]  nat address-group 1 12.1.1.2 12.1.1.10  //**设置编号为1的NAT地址池**
    - [huawei]  nat address-group 1 
      - section 12.1.1.2 12.1.1.10 配置NAT地址池，公网地址范围12.1.1.2-12.1.1.10
- 配置地址转换的ACL规则
  - [huawei] acl 2000 //配置 acl(过滤 抓流量)
    - [huawei-acl-basic-2001]  rule 10 permit source 192.168.1.0 0.0.0.255  //设置ACL200编号为10的规则，允许上述源地址通过

- 接口视图下配置带地址池的NAT
  - [huawei] interface g0/0/1 //进入接口
    - [huawei-gigabitEthernet0/0/1] **nat outbound** 2000 address-group 1 no-pat **//关联ACL与地址池进行动态地址转换（从地址池1中取出地址取代原地址成为新的源地址），no-pat参数指定不进行端口转换。**

  - [huawei] display nat outbound //查看 NAT

![image-20240831133021574](img/计算机/组网/image-20240831133021574.png)

- undo nat outbound 2000 address-group 1 no-pat
- undo nat address-group 1

#### Easy IP

- [R1]int g0/0/1

  - ip address 12.1.1.1 255.255.255.0 

    在R1上配置Easy IP让内网所有私有地址通过12.1.1.1访问公网。

  - [R1-GigabitEthernet0/0/0]undo nat outbound 2000 address-group 1 no-pat

    //首先将先前在g0/0/0端口设定的NAT地址池模式关闭    

  - [R1-GigabitEthernet0/0/0]nat outbound 2000

    //重新在g0/0/0端口上绑定规则2000，此时配置的就是Easy-IP特性

![image-20240831134424454](img/计算机/组网/image-20240831134424454.png)

#### NAPT

```
[Huawei]acl number 2000
[Huawei-acl-basic-2000]rule 10 permit source 192.168.10.0 0.0.0.255
[Huawei-acl-basic-2000]rule 20 permit source 192.168.20.0 0.0.0.255
[Huawei-acl-basic-2000]rule 30 permit source 192.168.30.0 0.0.0.255
[Huawei-acl-basic-2000]q
 
[Huawei]nat address-group 1 125.171.0.10
[Huawei]int g0/0/1	
[Huawei-GigabitEthernet0/0/1]nat outbound 2000 address-group 1 //和动态NAT相比，多了参数no-pat
```



#### NAT Server

指定[公有地址：端口]与[私有地址：端口]的一对一映射关系，**将内网服务器映射到公网。**

**外网主机主动访问[公有地址：端口]实现对内网服务器的访问。**

作用

- 安全
- 负载

<img src="img/计算机/计算机网络/image-20230522152835133.png" alt="image-20230522152835133" style="zoom:67%;" />

在R1上配置NAT Server将内网服务器192.168.1.10的80端口映射到公有地址122.1.2.1的80端口。

- [R1] interface GigabitEthernet0/0/1
  - nat server protocol tcp global 12.1.1.2 80 inside 192.168.1.2 80
- AR2测试
  - <AR2>telnet 12.1.1.2 80

### BFD

BFD是一个用于检测两个转发点之间故障的网络协议。在路由上配置BFD后，当到另一点不可达时，BFD会删除套用了它的路由，这样在有多条路由的情况下，可以避免一直走错误的路由

#### 静态路由使用BFD

![](img/计算机/组网/b616401db55e39e6efcf99dddf80477d.jpg)

> R1和R2通过静态路由的配置使各自的环回接口能互相通信

R1配置：

- interface GigabitEthernet0/0/0
  - ip address 192.168.1.1 255.255.255.0 
- interface LoopBack0
  - ip address 1.1.1.1 255.255.255.255 
- ip route-static 2.2.2.2 32 192.168.1.2

R2配置

- interface GigabitEthernet0/0/0
  - ip address 192.168.1.2 255.255.255.0 
- interface LoopBack0
  - ip address 2.2.2.2 255.255.255.255
- ip route-static 1.1.1.1 32 192.168.1.1

在网络基本配置完成后，R1和R2通过静态路由的配置使各自的环回接口能互相通信。**R1上会存在一条到R2 2.2.2.2的路由，即使SW1到R2的线路断开，这条路由也不会消失**

![image-20240902154045865](img/计算机/组网/image-20240902154045865.png)

配置bfd

- R1

  ```
  [R1]bfd    // 开启bfd
  [R1-bfd]q
  [R1]bfd 1 bind peer-ip 192.168.1.2 source-ip 192.168.1.1    
  // 创建编号为1的bfd，peer-ip为对端IP，source-ip为本地的IP
  [R1-bfd-session-1]discriminator local 1    // 本机编号
  [R1-bfd-session-1]discriminator remote 2    
  // 对端编号，对端设备也需要设置本机和对端编号，两台设备的配置应该是相反的
  [R1-bfd-session-1]commit    // 提交配置
  [R1-bfd-session-1]q
  [R1]ip route-static 2.2.2.2 32 192.168.1.2 preference 50 track bfd-session 1    
  // 将bfd 1绑定到该静态路由上，当两个IP直接无法通信，运用了这条bfd的路由会在路由表中删除
  ```

- R2

  ```
  [R2]bfd
  [R2-bfd]q
  [R2]bfd 1 bind peer-ip 192.168.1.1 source-ip 192.168.1.2
  [R2-bfd-session-1]discriminator local 2
  [R2-bfd-session-1]discriminator remote 1
  [R2-bfd-session-1]commit
  [R2-bfd-session-1]q
  [R2]ip route-static 1.1.1.1 32 192.168.1.1 track bfd 1
  ```

验证：删去SW1到R2的线路，到2.2.2.2的路由也随之消失

![image-20240902154953294](img/计算机/组网/image-20240902154953294.png)

#### 动态路由

1. **RIP协议**

[R1-rip-1] bfd all-interfaces enable

\#RIP的全部接口启用BFD。

1. **OSPF协议**

[R1-ospf-1] bfd all-interfaces enable

\#OSPF的全部接口启用BFD。

### 网关冗余技术VRRP

https://blog.csdn.net/2302_78835233/article/details/131688171

- 背景：网关Router出现故障时，本网段内以该设备为网关的主机都不能与Internet进行通信。

- **作用：VRRP协议中文名称虚拟路由冗余协议，应用在路由器上，其作用是某一路由器损坏或链路出现问题立刻切换到另一个路由器上不影响整个网络的运行，更好的保障网络通信**

- VRRP的好处：

  - 主路由失效后，备份路由器立即顶替主路由器的工作，保证数据不会丢失

  - 两个不同的路由器成为不同组的主路由器，相互备份
  
  
    - 跟踪上行链路接口状态，当上行链路接口失效时，自动将备份路由器提升为主路由器，保证数据不会丢失
  


- **VRRP工作原理：**

  VRRP的原理其实很简单，就是**将多个路由器逻辑上虚拟成一个大的路由器来提供服务**，通过在**冗余网关间共享虚拟Mac和ip地址**，保证数据转发时并不是转给某一个具体网关ip，而是把数据传给**虚拟网关ip**，因此不论那个路由器成为主路由器，都不会影响数据通信，通过两个设备间的**心跳线**组播对数据端口进行监控，一旦检测数据转发的端口坏掉，主路由器会停止hello包，备份路由提升为主路由器，由于此切换非常迅速而且不用改变IP地址和MAC地址，实现数据的稳定高效转发。
  
  ![image-20240831162232146](img/计算机/组网/image-20240831162232146.png)
  
- **主备路由器划分标准：**

  
  - 在VRRP中，优先级越高，则越有可能成为Master设备
  
    根据优先级划分主备路由器
  
    1. 优先级分为0-255级别
    2. 优先级**默认为100**
    3. 若其中一个路由器为255级则直接成为主路由器。
  
  - 值越大越优先，值相等则比较接口IP地址大小，大者优先。
  

#### 基本配置

![image-20240831164414140](img/计算机/组网/image-20240831164414140.png)

- 创建VRRP备份组并给备份组配置虚拟IP地址

  [interface-GigabitEthernet0/0/0]vrrp vrid VRID virtual-ip virtual-address //注意：**各备份组之间的虚拟IP地址不能重复；同属一个备份组的设备接口需使用相同的VRID。**

- 配置路由器在备份组中的优先级

  [interface-GigabitEthernet0/0/0]vrrp vrid VRID priority priority-value注意：通常情况下，Master设备的优先级应高于Backup设备。

- 配置备份组中设备的抢占延迟时间**(主路由器没有问题后，回去抢占，可以配置延长多久时间抢占)**

  [interface-GigabitEthernet0/0/0]vrrp vrid VRID preempt-mode timer delay delay 2 配置VRRP位抢占模式，延时2s抢占

  [interface-GigabitEthernet0/0/0]vrrp vrid VRID preempt-mode disable缺省情况下，抢占模式已被激活。

- **配置VRRP备份组监视接口**
  [interface-GigabitEthernet0/0/0]vrrp vrid VRID track interface interface-type interface-number [increased value-increased | reduced value-decreased]
  可配置设备，当检测到上行接口或链路出现故障时，增加或者减少自身优先级，IP地址拥有者和Eth-trunk成员口不允许配置VRRP监视功能。

![image-20240901001458647](img/计算机/组网/image-20240901001458647.png)

```
AR1：
[AR1]interface g0/0/0                                          ##进入g0/0/0接口
[AR1-GigabitEthernet0/0/0]vrrp vrid 1 virtual-ip 192.168.1.254 ##配置 1 组设置虚拟ip
[AR1-GigabitEthernet0/0/0]vrrp vrid 1 priority 120             ##配置优先级为120 
[AR1-GigabitEthernet0/0/0]vrrp vrid 1 preempt-mode timer delay 5 ##延迟抢占为5秒
[AR1-GigabitEthernet0/0/0]vrrp vrid 1 track interface GigabitEthernet 0/0/1 reduced 30  ##监测接口g0/0/1,如果g0/0/1down掉，优先级减少110（当g0/0/1接口down掉后，AR1优先级从120减少为90，而AR2默认优先级为100，AR2优先级比AR1高，    

AR2：
[AR2]interface g0/0/0  
[AR2-GigabitEthernet0/0/0]vrrp vrid 1 virtual-ip 192.168.1.254 ##配置 1 组设置虚拟ip
```

切换等级/或者设备停止

<img src="img/计算机/组网/image-20240901001213270.png" alt="image-20240901001213270" style="zoom:50%;" />

#### VRRP与BFD联动

通过配置VRRP与BFD联动，当Backup设备通过BFD感知故障发生之后，不再等待Master_Down_Timer计时器超时而会在BFD检测周期结束后立即切换VRRP状态，此时可以实现毫秒级的主备切换。

[interface-GigabitEthernet0/0/0] vrrp vrid 1 track bfd-session 2 increased 40 

vrrp vrid virtual-router-id track bfd-session  {bfd-session-id | session-name bfd-configure-name}  [increased value-increased | reduced value-reduced]

如果选择参数session-name bfd-configure-name，可以绑定静态BFD会话或者标识符自协商的静态BFD会话。

如果选择参数bfd-session-id，只能绑定静态BFD会话，指定被监视的BFD会话的**本地标识符**。

### 路由策略和策略路由

https://blog.csdn.net/Xiao_ming20724/article/details/132760071

- **操作对象**‌：**策略路由的优先级比路由策略高，转发在底层，路由在高层，所以转发的优先级比路由的优先级高**
  - 路由策略的**操作对象是路由表**，通过修改路由表的路由条目来控制数据流量的可达性，即对接受和发布的路由进行过滤。
  - 策略路由的**操作对象是‌[数据包](https://www.baidu.com/s?word=数据包&sa=re_dqa_zy)**，通过用户制定的策略进行转发，且该策略优于路由表的转发。这种方式直接作用于数据包的转发，而不是修改路由表本身。
- **应用场景和目的**：
  - **路由策略**通常配置在较低级别的设备上，如交换机和路由器，目的是优化网络性能、提高可靠性和安全性。**路由策略通过修改路由表的路由条目来控制数据流量的可达性**，即对接受和发布的路由进行过滤。这种方式称为路由策略。
  - ‌**策略路由**‌则通常配置在较高级别的设备上，如‌[核心路由器](https://www.baidu.com/s?word=核心路由器&sa=re_dqa_zy)或‌[防火墙](https://www.baidu.com/s?word=防火墙&sa=re_dqa_zy)，目的是实现更复杂的网络需求，如多路径负载均衡、应用程序优化和安全策略实施。策略路由通过用户制定的策略进行转发，且该策略优于路由表的转发。这种方式称为策略路由。
- 过滤机制
  -  路由策略基于访问控制列表过滤、地址前缀列表、路由属性过滤、路由类型过滤等
  - 策略路由基于基于ACL、流分类、流行为、流策略等
- 应用工具和命令
  - 路由策略使用route-policy和filter-policy
  - 策略路由使用traffic-filter和traffic-policy

综上所述，‌**路由策略**‌是基于路由表进行流量的转发和控制，而‌**策略路由**‌则是基于用户制定的策略进行数据包的转发，具有更高的灵活性和优先级。这两种技术都是为了控制网络流量的可达性或调整网络流量的路径，但它们的应用场景、目的以及操作对象有所不同。

#### 路由引入

一个网络拓扑中存在多种不同的路由协议，为了使多种不同的路由协议间能相互通信，出现了路由引入

import-route ospf 1 cost 3

#### ACL基础

ACL是一个匹配工具，能够对报文进行匹配和区分

##### ACL应用

- 匹配IP流量
- 在Traffic-filter中被调用
- 在NAT（Network Address Translation）中被调用
- 在路由策略中被调用
- 在防火墙的策略部署中被调用
- 在Qos中被调用
- 其他.....

##### ACL组成

ACL由若干条permit或deny语句组成。系统按照ACL规则编号从小到大的顺序进行报文匹配，规则编号越小越容易被匹配。

- acl number 2000
  - rule 5 permit source/deny 1.1.1.0 0.0.0.255 // 5规则编号
  
    <img src="img/计算机/计算机网络/image-20230521153517393.png" alt="image-20230521153517393" style="zoom: 50%;" />
  
    - 通配符
  
    ![image-20230521153651525](file:///D:/work/doc/document/img/%E8%AE%A1%E7%AE%97%E6%9C%BA/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20230521153651525.png?lastModify=1730218612)

##### ACL基础配置

| 分类    | 编号范围  | 规则定义描述                                                 |
| ------- | --------- | ------------------------------------------------------------ |
| 基本ACL | 2000-2999 | **仅使用报文的源IP地址**、分片信息和生效时间段信息来定义规则。 |
| 高级ACL | 3000-3999 | 可使用IPv4报文的源IP地址、目的IP地址、IP协议类型、ICMP类型、TCP源/目的端口号、UDP源/目的端口号、生效时间段等来定义规则。 |

- [Huawei]**time-range** workday 8：30 to 18：00 working-day //配置时间段，工作日下的8.30-18

- [huawei] display acl all //查看所有的 acl

- [huawei] dis acl 2000 //查看 acl2000

- 配置路由器

  - 基本ACL:2000-2999

    - [huawei] acl 2000 //启用编号为2000的ACL
      - [Huawei-acl-basic-2000]**rule permit source** 192.168.1.10 0 time-range workday//只允许192.168.1.10这个用户在工作日可以telnet交换机
      - [huawei-acl-basic-2000] rule 5 permit/deny source 1.1.1.1 0  //注意**反掩码** 0，默认步长为 5
      - [huawei-acl-basic-2000]rule deny //这个地方rule deny可以不用写，acl在这种场景下最后隐含有一条deny any的语句

  - 高级 ACL：3000-3999

    ![image-20240829095800426](img/计算机/组网/image-20240829095800426.png)

    - [huawei] acl 3000//启用编号为3000的ACL

      - [huawei-acl-adv-3000] rule 10 deny **ip source** 192.168.1.0 0.0.0.255**（反掩码）** **destination** 192.168.3.100 0（反掩码） //拒绝192.168.1.0网段访问192.168.3.100这个服务器

      - [huawei-acl-adv-3000] rule 20 permit ip source 192.168.2.0 0.0.0.255 destination  192.168.3.100 0//允许192.168.2.0网段访问192.168.3.100这个服务器

      - [huawei-acl-adv-3000] rule 30 deny ip source any destination 192.168.3.100 0//拒绝所有ip访问192.168.3.100这个服务器

- 配置接口

  - [huawei] int g0/0/1 //进入接口
  - [huawei-G0/0/1] **traffic-filter** inbound acl 3000 //应用进入的规则
  - [huawei-G0/0/1] traffic-filter outbound acl 3000 //应用出去的规则

- 配置用户访问路由器权限

  - [huawei]user-interface vty 0 4
  - [huawei-ui-vty0-4]acl 2000 inbound //应用ACL，只允许匹配acl数据流的的用户telent登陆

#### 路由策略

https://blog.csdn.net/oddrock/article/details/134065911

1、在这里路由策略的需求就是，只把R1的lo1和lo2环回口的网络发布给R3，而lo0的网络则不发布出去。
1、2台PC，1台代表总部，1台代表分公司。
2、3台路由器，1台跑RIP，1台跑OSPF，中间1台既跑RIP也跑OSPF

![image-20240922001106296](img/计算机/组网/image-20240922001106296.png)

- 配置R1的接口地址、环回口地址，开启RIPv2，将4个网段都宣告出去。

  ```
  [R1]int g0/0/0
  [R1-GigabitEthernet0/0/0]ip add 12.1.1.1 30
  [R1-GigabitEthernet0/0/0]int lo0
  [R1-LoopBack0]ip add 10.1.1.1 24
  [R1]rip
  [R1-rip-1]version 2
  [R1-rip-1]network 12.0.0.0
  [R1-rip-1]network 10.0.0.0
  ```

- 在R3上配置接口地址和环回口地址，配置OSPF，宣告4个网段。

  ```
  [R3]ospf 1
  [R3-ospf-1]area 0
  [R3-ospf-1-area-0.0.0.0]network 23.1.1.0 0.0.0.3
  [R3-ospf-1-area-0.0.0.0]network 30.1.1.0 0.0.0.255
  [R3-ospf-1-area-0.0.0.0]network 30.1.2.0 0.0.0.255
  [R3-ospf-1-area-0.0.0.0]network 30.1.3.0 0.0.0.255
  ```

- AR2

  - 在R2上开启RIPv2，宣告12网段，然后可以看到R2学到了R1的环回路由。
    
     ```
     [R2]rip
     [R2-rip-1]version 2
     [R2-rip-1]network 12.0.0.0
     ```
     
  - 在R2上开启OSPF，宣告23网段。
    
     ```
     [R2]ospf 1
     [R2-ospf-1]area 0
     [R2-ospf-1-area-0.0.0.0]network 23.1.1.0 0.0.0.3
     [R2-ospf-1-area-0.0.0.0]quit
     ```
  
  - 现在AR1和AR3通过AR2代理转发路由，本地是没有直连对方路由的
  
    - 现在想把R1的环回口路由引入给R3，但只引入lo1和lo2网段的，而不引入Lo3网段的。
  
      - 在R2上创建一个ACL，将想传播的网段挑选出来

        [R2]acl 2000
        [R2-acl-basic-2000]rule 10 permit ip source 10.1.2.0 0.0.0.255
        [R2-acl-basic-2000]rule 10 permit source 10.1.2.0 0.0.0.255
        [R2-acl-basic-2000]rule 20 permit source 10.1.3.0 0.0.0.255
        [R2-acl-basic-2000]quit
  
      - 在R2创建一个路由策略：
  
        ```
        [R2]route-policy FROMR1 permit node 10//创建路由策略，名字叫FROMR1，节点编号为10
        [R2-route-policy]if-match acl 2000
        [R2-route-policy]quit
        ```
  
      - 在R2的OSPF进程里引入RIP的路由，通过路由策略进行筛选。
  
        ```
        [R2]ospf 1
        [R2-ospf-1]import-route rip 1 route-policy FROMR1 //引入路由策略，让AR3学习到AR1的路由信息
        [R2-ospf-1]quit
        ```
  
        这时在R3上可以看到通过OSPF引入了10.1.2.0和10.1.3.0两个网段的路由，但没有引入10.1.1.0网段的路由。这样就完成了按照路由策略的路由引入。
  
    - AR3学习到AR1的路由信息
  
       - acl number 2001  
          rule 10 permit source 10.1.2.0 0.0.0.255 
          rule 20 permit source 10.1.3.0 0.0.0.255 
       - route-policy 20 permit node 20 
          if-match acl 2001 
       - ospf 1 
          import-route rip 1 route-policy 20

#### 策略路由

**通过ACL、流分类、流行为和流策略进行流量控制，目的是配置不同的ip走不同的路由出去**

```
https://blog.csdn.net/WLxiaobaicai/article/details/122973033?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_baidulandingword~default-0-122973033-blog-114209827.235^v43^pc_blog_bottom_relevance_base4&spm=1001.2101.3001.4242.1&utm_relevant_index=3
```

- R1 环回口上有192.168.1.1 跟192.168.2.1 两个IP

  ```
  interface LoopBack0
  ip address 192.168.1.1 255.255.255.0 
  interface LoopBack1
  ip address 192.168.2.1 255.255.255.0 
  ```

- R3上有8.8.8.8 ，R4上有8.8.8.8 

  interface LoopBack0

  ip address 8.8.8.8 255.255.255.0 

**通过策略路由实现**

R1上的192.168.1.1能访问R3上的8.8.8.8 

R1上的192.168.2.1能访问R4上的8.8.8.8 

<img src="img/计算机/组网/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAR1JR44CC,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img" style="zoom:50%;" />

- 基础
  
  - AR1
    interface GigabitEthernet0/0/0
  
    ip address 10.1.12.1 255.255.255.0 
  
    ip route-static 0.0.0.0 0.0.0.0 10.1.12.2
  
  - AR2
  
    interface GigabitEthernet0/0/0 
  
    ip address 10.1.12.2 255.255.255.0
  
  - AR3
  
    interface GigabitEthernet0/0/0
    ip address 10.1.23.3 255.255.255.0
  
  - AR4
  
    interface GigabitEthernet0/0/0
    ip address 10.1.24.4 255.255.255.0 
  
- R2:ACL匹配流量

  - acl number 3000 
    - rule 5 permit ip source 192.168.1.0 0.0.0.255 destination 8.8.8.8 0

  - acl number 3001 
    - rule 5 permit ip source 192.168.2.0 0.0.0.255 destination 8.8.8.8 0

- 定义流分类匹配acl

  - traffic classifier video

    if-match acl 3000 // 流分类关联acl

  - traffic classifier web
    
    if-match acl 3001

- 定义流行为设置重定向到IP

  - traffic behavior a 

    redirect ip-nexthop 10.1.23.3 //并设置重定向到IP

  - traffic behavior b 

    redirect ip-nexthop 10.1.24.4

- 定义流策略绑定流分类跟流行为

  traffic policy test

  classifier video behavior a 绑定流分类跟流行为

  classifier web behavior b

- 在G0/0/0口应用流策略

  interface GigabitEthernet0/0/0 //

  - traffic-policy test inbound

### 配置防火墙安全策略

![image-20240925213951148](img/计算机/组网/image-20240925213951148.png)

- 把防火墙接口加入相应安全域，通过安全区域区分受信任网络和不受信任网络

  - [FW]firewall zone trust  //进入trust区域

    [FW-zone-trust]add int g1/0/1  //把g1/0/0加入trust区域

  - [FW]firewall zone untrust 

    [FW-zone-untrust]add int g1/0/3

  - [FW]firewall zone dmz

    [FW-zone-untrust]add int g1/0/2

- 配置安全策略，让 trust 区域（192.168.1.0/24）可以访问 Internet

  ```
  [FW]security-policy  
  [FW-policy-security]rule name trust_to_untrust//配置一个规则
  [FW-policy-security-rule-starry]source-zone trust   //源地址
  [FW-policy-security-rule-starry]source-address 192.168.1.0 24
  [FW-policy-security-rule-starry]destination-zone untrust  //目的地址
  [FW-policy-security-rule-starry]action permit//动作
  ```

- NAT配置：上述配置虽然放通了192.168.1.0/24访问Internet的流量，但是由于192.168.1.0/24是私有 IP 地址，不能直接进入公网，因此为了让内网用户能够访问公网，还必须配置 NAT。

  - 配置 NAT 地址池，开启端口转换。

    - nat address-group addressgroup1
      - mode pat
      - section  100.1.1.10 100.1.1.20

  - 配置源NAT策略1，实现私网指定网段访问Internet时自动进行源地址转换。

    ```
    [FW]nat-policy
    [FW-policy-nat]rule name policy_nat1
    [FW-policy-nat-rule-policy_nat1]source-zone trust
    [FW-policy-nat-rule-policy_nat1]destination-zone untrust
    [FW-policy-nat-rule-policy_nat1]source-address 192.168.1.0 24
    [FW-policy-nat-rule-policy_nat1]destination-address any
    [FW-policy-nat-rule-policy_nat1]action source-nat address-group addressgroup1
    //采用源地址 NAT，把 192.168.1.0/24 转换为 addressgroup1 的公网地址
    ```

  - 防火墙上放行trust到dmz区域的流量。

    ```
    [Firewall]security-policy
    [Firewall-policy-security]rule name trust_to_dmz
    [Firewall-policy-security-rule-trust_to_dmz]source-zone trust
    [Firewall-policy-security-rule-trust_to_dmz]destination-zone dmz
    [Firewall-policy-security-rule-trust_to_dmz]action permit
    ```

  - 配置服务器端口映射。
    #下面的命令，将内部IP地址192.168.2.100的80端口映射到了公网地址100.1.1.100的80端口，当公网用户访问100.1.1.100的80 端口服务时，自动跳转到内部服务器192.168.2.100的80 端口。

    - 配置安全策略，允许外部网络用户访问 DMZ区域的 Web 服务器网段。
      [FW]security-policy
      [FW-policy-security]rule name untrust_to_dmz
      [FW-policy-security-rule-policy1]source-zone untrust
      [FW-policy-security-rule-policy1]destination-zone dmz
      [FW-policy-security-rule-policy1]destination-address 192.168.2.0 24
      [FW-policy-security-rule-policy1]action permit
    - 配置 NAT Server 功能，把内网 Web 服务映射到公网地址。
      [FW]nat server policy_web protocol tcp global 100.1.1.100 80 inside
      192.168.2.100 80

### IPSec配置

> 1. 配置网络可达
> 2. 配置ACL识别兴趣流
> 3. 创建安全提议
> 4. 创建安全策略
> 5. 应用安全策略

![在这里插入图片描述](img/计算机/计算机网络/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBATHVtcHVy,size_20,color_FFFFFF,t_70,g_se,x_16)

- isp基本信息配置：

  - < Huawei >sys
  - [Huawei]undo info-center enable
  - [Huawei]int g0/0/0
  - [Huawei-GigabitEthernet0/0/0]ip add 100.1.1.2 30
  - [Huawei-GigabitEthernet0/0/0]undo shut
  - [Huawei-GigabitEthernet0/0/0]quit
  - [Huawei]int g0/0/1
  - [Huawei-GigabitEthernet0/0/1]ip add 200.1.1.2 30
  - [Huawei-GigabitEthernet0/0/1]undo shut
  - [Huawei-GigabitEthernet0/0/1]quit
  - [Huawei]int LoopBack 0
  - [Huawei-LoopBack0]ip add 2.2.2.2 32
  - [Huawei-LoopBack0]quit

- 配置ACL识别兴趣流

  - R1的配置：

    - [Huawei]acl 2000
      - rule 10 permit source 192.168.10.0 0.0.0.255
    - [Huawei]acl 3000
      - rule 10 permit ip source 192.168.10.0 0.0.0.255 destination 192.168.20.0 0.0.0.255

    - interface g0/0/1
      - nat outbound 2000 //配置Easy IP才能访问互联网2.2.2.2

  - R2的配置：

    - [Huawei]acl 2000	
      - [Huawei-acl-adv-2000]rule 10 permit source 192.168.20.0 0.0.0.255
    - [Huawei]acl 3000	
      - rule 10 permit ip source 192.168.20.0 0.0.0.255 destination 192.168.10.0 0.0.0.255
    
    - interface g0/0/1
      - nat outbound 2000

- 配置IPSec安全提议(**认证算法采用md5 加密算法采用 DES**)

  - R1的配置：

    [Huawei]ipsec proposal cd //cd为提议名称，用于绑定ipsec安全策略
    [Huawei-ipsec-proposal-cd]encapsulation-mode tunnel //配置工作模式为隧道（默认为隧道）
    [Huawei-ipsec-proposal-cd]transform esp  //配置安全提议的安全协议为esp（可选ah、esp、ah-esp，默认为esp
    [Huawei-ipsec-proposal-cd]esp encryption-algorithm des   //安全提议的加密算法为DES
    [Huawei-ipsec-proposal-cd]esp authentication-algorithm md5   //安全提议的认证算法为md5

  - R2的配置：同理

    [Huawei]ipsec proposal bj

- 配置手动IPSec安全策略(IKE协议提供密钥协商，建立和维护安全联盟**SA**等服务，用来控制信道)

  - R1的配置：

    [Huawei]ipsec policy chengdu 10 manual   \\\配置IPSec策略chengdu,方式为手动
    [Huawei-ipsec-policy-manual-chendu-10]security  acl 3000  \\ \保护acl3000的流量
    [Huawei-ipsec-policy-manual-chendu-10]proposal cd \\\采用IPSec提议cd
    [Huawei-ipsec-policy-manual-chendu-10]tunnel local 100.1.1.1  \\\配置隧道本地地址
    [Huawei-ipsec-policy-manual-chendu-10]tunnel remote 200.1.1.1  \\\配置隧道远端地址
    [Huawei-ipsec-policy-manual-chendu-10]sa spi inbound esp 54321 \\\配置入方向SA编号54321
    [Huawei-ipsec-policy-manual-chendu-10]sa string-key inbound esp cipher kiki	\\\配置入方向SA的认证密钥为qing
    [Huawei-ipsec-policy-manual-chendu-10]sa spi outbound esp 12345  \\\配置出方向SA编号12345
    [Huawei-ipsec-policy-manual-chendu-10]sa string-key outbound esp cipher kiki   \\\配置出方向SA的认证密钥为qing

  - R2的配置：

    [Huawei]ipsec policy beijing 10 manual 
    [Huawei-ipsec-policy-manual-beijing-10]security acl 3000
    [Huawei-ipsec-policy-manual-beijing-10]proposal bj
    [Huawei-ipsec-policy-manual-beijing-10]tunnel local 200.1.1.1
    [Huawei-ipsec-policy-manual-beijing-10]tunnel remote 100.1.1.1	
    [Huawei-ipsec-policy-manual-beijing-10]sa spi inbound esp 12345
    [Huawei-ipsec-policy-manual-beijing-10]sa string-key inbound esp cipher kiki
    [Huawei-ipsec-policy-manual-beijing-10]sa spi outbound esp 54321
    [Huawei-ipsec-policy-manual-beijing-10]sa string-key outbound esp cipher kiki

**特别注意：R1的入口方向对应就是R2的出口方向同理，R2的入口方向对应就是R1的出口方向**

- 在接口应用安全策略

  - R1的配置:

    [Huawei]int g0/0/1
    [Huawei-GigabitEthernet0/0/1]ipsec policy chengdu

  - R2的配置：

    [Huawei]int g0/0/1
    [Huawei-GigabitEthernet0/0/1]ipsec policy beijing

- ACL的配置

  > 因为IPsec逻辑上是一个内部通信，上面用nat接口转换ip地址，所以访问不到

  - R1的配置：
  
    interface g0/0/1
  
    - undo nat outbound 2000
  
    [Huawei]acl 3001
    [Huawei-acl-adv-3001]rule 10 deny ip source 192.168.10.0 0.0.0.255 destination 192.168.20.0 0.0.0.255  \\**不允许192.168.10.0这个网段是通过nat地址转化，而是直接走隧道。**
    [Huawei-acl-adv-3001]rule 20 permit ip
    [Huawei-acl-adv-3001]quit
    [Huawei]int g0/0/1
    [Huawei-GigabitEthernet0/0/1]nat outbound 3001
  
  - R2的配置：
  
    [Huawei]acl 3001	
    [Huawei-acl-adv-3001]rule 10 deny ip source 192.168.20.0 0.0.0.255 destination 192.168.10.0 0.0.0.255
    [Huawei-acl-adv-3001]rule 20 permit ip
    [Huawei-acl-adv-3001]quit
    [Huawei]int g0/0/1
    [Huawei-GigabitEthernet0/0/1]nat outbound 3001

### IPv6

#### 隧道

![img](https://img-blog.csdnimg.cn/61af32c39cf54449a2a7f0897d31436c.png)

（1）R1配置

interface GigabitEthernet0/0/0
 ip address 10.1.12.1 255.255.255.0 
#
interface LoopBack0
 ipv6 enable 
 ipv6 address 2001:1::1111/64 
#
interface Tunnel0/0/0 //创建隧道接口
 ipv6 enable 
 ipv6 address 2001:12::1/64  //设置tunnel接口的ipv6地址
 tunnel-protocol ipv6-ipv4 //指定隧道模式
 source 10.1.12.1 //指定tunnel的源地址

 destination 10.1.12.2
#
ipv6 route-static 2001:2:: 64 Tunnel0/0/0

（2）R2配置

interface GigabitEthernet0/0/0
 ip address 10.1.12.2 255.255.255.0 
#
interface LoopBack0
 ipv6 enable 
 ipv6 address 2001:2::2222/64 
#
interface Tunnel0/0/0
 ipv6 enable 
 ipv6 address 2001:12::2/64 
 tunnel-protocol ipv6-ipv4
 source 10.1.12.2
 destination 10.1.12.1
#
ipv6 route-static 2001:1:: 64 Tunnel0/0/0 



### AP配置

>  **AP的基本功能**
>
> 无线接入点（AP）是无线网络的核心设备，负责将有线信号转换为[无线信号](https://so.csdn.net/so/search?q=无线信号&spm=1001.2101.3001.7020)，使各类无线设备能够接入网络。



![华为AC+AP上线配置_AC_02](img/计算机/组网/resize,m_fixed,w_11841)

<img src="img/计算机/组网/resize,m_fixed,w_1184" alt="华为AC+AP上线配置_华为" style="zoom:50%;" />

AC基础配置

```
[AC6605]vlan batch 100 101 #创建vlan
[AC6605]dhcp enable #开启DHCP服务

VLAN配置
[AC6605]int vlan 100
[AC6605-Vlanif100]description AP_Manage
[AC6605-Vlanif100]ip add 192.168.100.254 24
[AC6605-Vlanif100]dhcp select interface #为DHCP选择源接口
[AC6605-Vlanif100]quit
[AC6605]int vlan 101
[AC6605-Vlanif101]description USER
[AC6605-Vlanif101]ip add 192.168.101.254 24
[AC6605-Vlanif101]dhcp select interface #为DHCP选择源接口
[AC6605-Vlanif101]quit

[AC6605]capwap source interface Vlanif 100 #为capwap隧道绑定vlan

```

AC无线配置

```
[AC6605]wlan #进入无线配置视图
[AC6605-wlan-view]

[AC6605-wlan-view]regulatory-domain-profile name office-domain #创建域管理模板，名称为office-domain
[AC6605-wlan-regulate-domain-office-domain]country-code CN #配置国家代码
[AC6605-wlan-regulate-domain-office-domain]quit

[AC6605-wlan-view]ssid-profile name office-ssid #创建SSID模板，名称为office-ssid
[AC6605-wlan-ssid-prof-office-ssid]ssid office #配置SSID名称为office
[AC6605-wlan-ssid-prof-office-ssid]quit

[AC6605-wlan-view]security-profile name office-security #创建安全策略，名称为office-security
[AC6605-wlan-sec-prof-office-security]security wpa-wpa2 psk pass-phrase 12345678
9 aes #SSID密码为123456789

[AC6605-wlan-view]vap-profile name office-vap #创建VAP模板
[AC6605-wlan-vap-prof-office-vap]forward-mode direct-forward #配置业务数据转发模式
[AC6605-wlan-vap-prof-office-vap]security-profile office-security #绑定安全策略
[AC6605-wlan-vap-prof-office-vap]ssid-profile office-ssid #绑定SSID模板
[AC6605-wlan-vap-prof-office-vap]service-vlan vlan-id 101 #绑定业务VLAN

[AC6605-wlan-view]ap-group name office-ap-group #创建AP组，名称为office-ap-group
[AC6605-wlan-ap-group-office-ap-group]regulatory-domain-profile office-domain #绑定域模板
[AC6605-wlan-ap-group-office-ap-group]vap-profile office-vap wlan 1 radio 0 #绑定vap模板到射频卡0上
[AC6605-wlan-ap-group-office-ap-group]vap-profile office-vap wlan 1 radio 1 #绑定vap模板到射频卡1上

[AC6605-wlan-view]ap-id 0 ap-mac 00e0-fc79-4b40 添加AP，APmac

[AC6605-wlan-ap-0]ap-group office-ap-group #添加到AP组中
```

AC接口配置
[AC6605]int g0/0/1
[AC6605-GigabitEthernet0/0/1]port link-type trunk
[AC6605-GigabitEthernet0/0/1]port trunk allow-pass vlan 100 101

Switch配置

[Switch]vlan batch 100 101 #创建vlan
[Switch]int g0/0/24]int g0/0/24
[Switch-GigabitEthernet0/0/24]description to_AC
[Switch-GigabitEthernet0/0/24]port link-type trunk
[Switch-GigabitEthernet0/0/24]port trunk allow-pass vlan 100 101

[Switch]int g0/0/1
[Switch-GigabitEthernet0/0/1]description to_AP
[Switch-GigabitEthernet0/0/1]port link-type trunk
[Switch-GigabitEthernet0/0/1]port trunk pvid vlan 100 // *PVID*(*Port* *VLAN* ID,端口VLAN ID)是Port *Trunk*配置中的一个重要概念。当一个未经标记的数据包进入Port Trunk端口时,交换机将根据PVID将该数据包划分到相应的VLAN.

[Switch-GigabitEthernet0/0/1]port trunk allow-pass vlan 100 101

### 交换机端口镜像配置

将交换机网口GigabitEthernet1/0/2的流量镜像到部署Snort的网口GigabitEthernet1/0/1上。

<HUAWEI> system-view//进入系统模式

[HUAWEI]observe-port 1 interface gigabitethernet 1/0/1//定义索引号为1的观察端口g1/0/1

[HUAWE]]interface gigabitethernet 1/0/2//进入流量采集接口

[HUAWEI-GigabitEthernet0/0/1]port-mirroring to observe-port 1 inbound//将g1/0/2入方向的流量镜像到g1/0/1





## 背

想让两台属于**不同VLAN主机之间能够通信**，就必须使用路由器或者三层交换机为VLAN之间做路由。











# 知识点

## 背

在基于Web的电子商务应用中，访问存储于数据库中的业务对象的常用方式之一是（）。JDBC



软件开发的增量模型( )。是一种能够快速构造可运行产品的好方法 



SOA（面向服务的架构）是一种（）服务架构。粗粒度、松耦合



SNMPc软件支持的4个内置**TCP服务**是 （ ） 。

FTP、SMTP、WEB和TELNET



评价系统可靠性通常采用MTBF(Mean Time Between Failures，平均故障间隔时间)和MTTR(Mean Time to Repair，平均修复时间)这两个技术指标。其中MTBF是指系统无故障运行的平均时间，通常以(**小时**)为单位。MTBF 越(**大**)，可靠性也就越高，在实际的网络中，故障难以避免，保证可靠性的技术从两个方面实现，



## 标准化与知识产权

### 我国标准的级别

《中华人民共和国标准化法》将标准划分为4个层次：

- （1）国家标准

  - GB：强制性国家标准
  - GB/T：推荐性国家标准
  - GB/Z：指导性国家标准
  - GSB：国家实物标准

- （2）行业标准

  **推荐性行业标准在行业代号后加/T**，如：JB/T，为机械行业推荐性标准，不加T为强制性标准。

- （3）地方标准

  地方标准由省、自治区、直辖市标准化行政主管部门统一编制计划、组织制定、审批、编号和发布**，地方标准以DB开头。**

- （4）企业标准

  **企业标准以Q开头。企业产品标准应在发布后30日内向政府备案。**

除此之外还有国际标准，如：ISO（国际标准化组织）、IEC（国际电工委员会）、ITU（国际电信联盟）。

### 知识产权

我国在IT领域主要有《著作权法》、《计算机软件保护条例》、《专利法》、《商标法》和《反不正当竞争法》五部法律对著作权人进行保护。

> 《中华人民共和国著作权法》和《计算机软件保护条例》是构成我国保护计算机软件著作权的两个基本法律文件。

#### 保护期限

![image-20240918150144421](img/计算机/计算机网络/image-20240918150144421.png)

著作权的保护期限是**作者死后第50年的12月31日。**

关于**软件著作权**产生的时间，表述正确的是（）。自作品完成创作之日

著作权中的**署名权**、修改权、保护作品完整权的**保护期不受限制**。

注册商标有效期为**10年**（若注册人死亡或倒闭1年后，未转移则可注销，期满后6个月内必须续注）

商标权是民事主体享有的在特定的商品或服务上以区分来源为目的排他性使用特定标志的权利，**有效期为10年，但期满前12个月内可申请续展，续展可无限重复进行，因此其有可能<u>无限期</u>地拥有商标权。**

知识产权一般都具有法定的保护期限，**一旦保护期限届满，权利将自行终止**，成为社会公众可以自由使用的知识。 

**商业秘密权**受法律保护的期限是不确定的，一旦为公众所知悉，即成为公众可以自由使用的知识。

#### 著作权

计算机软件是著作权保护作品中的一个特例，因此当《计算机软件保护条例》中没有相关规定时，将参照《著作权法》



#### 知识产权归属

![image-20240918150305318](img/计算机/计算机网络/image-20240918150305318.png)

公民为完成法人或者其他组织工作任务所创作的作品是职务作品，职务作品可以是作品分类中的任何一种形式，如文字作品、电影作品、计算机软件等。职务作品的著作权归属分两种情形：

- 一般职务作品的著作权由作者享有。所谓一般职务作品是指虽是为完成工作任务而为，**但非经法人或其他组织主持，不代表其意志创作，也不由其承担责任的职务作品**。对于一股职务作品，法人或其他组织享有在其业务范围内优先使用的权利，**期限为两年**。优先使用权是专有的，未经单位同意，作者不得许可第三人以与法人或其他组织使用的相同方式使用该作品。在作品完成两年内，如单位在其业务范围内不使用，作者可以要求单位同意由第三人以与法人或其他组织使用的相同方式使用，所获报酬，由作者与单位按约定的比例分配。

- 王某是某公司的软件设计师，完成某项软件开发后按公司规定进行软件归档。以下有关该软件的著作权的叙述中，正确的是（）。此为职务作品，凡是供职于某公司，利用公司相关资源进行开发完成的作品，其著作权归公司所有。

- 某软件公司参与开发管理系统软件的程序员张某，辞职到另一公司任职，于是该项目负责人将该管理系统软件上开发者的署名更改为李某（接张某工作）。该项目负责人的行为（）。**侵犯了署名权**

  署名权只能是真正的开发者和被视同开发者的法人和非法人团体才有资格享有，其他任何个人、单位和组织不得行使此项权利。所以，署名权还隐含着另一种权利，即开发者资格权。法律保护署名权，意味着法律禁止任何未参加开发人在他人开发的软件上署名。《计算机软件保护条例》规定“在他人开发的软件上署名或者更改他人开发的软件上的署名”的行为是侵权行为，这种行为侵犯了开发者身份权即署名权。

软件著作权中翻译权的叙述正确的是：翻译权是指（）的权利。将原软件从—种程序设计语言转换成另一种程序设计语言

我国由（）主管全国软件著作权登记管理工作。国家版权局

提供工具软件的复制品，属于侵犯著作权。类似软件产品和注册商标，不构成侵权



专利权是指国家根据发明人或设计人的申请，以向社会公开发明创造的内容，以及发明创造对社会具有符合法律规定的利益为前提，根据法定程序在一定期限内授予发明人或设计人的一种排他性权利。

**专利权：需申请，先申请者先获得专利， 一定期限内依法享有的独占实施权**





目前根据我国法律法规的规定必须使用注册商标的是烟草类商品。

我国商标注册以申请在先为原则，使用在先为补充。

- 当两个或两个以上申请人在同一种或者类似商品上申请注册相同或者近似商标时，申请在先的人可以获得注册。
- 对于同日申请的情况，商标法及其实施条例规定保护先用人的利益，使用在先的人可以获得注册“使用”包括将商标用于商品、商品包装、容器以及商品交易书上，或者将商标用于广告宣传、展览及其他商业活动中。
- 如果同日使用或均未使用，则采取申请人之间协商解决，不愿协商或者协商不成的，由各申请人**抽签决定**。商标局通知各申请人以抽签的方式确定一个申请人，驳回其他人的注册申请。商标局已经通知但申请人未参加抽签的，视为放弃申请。





知识产权

-  地理标志权是世界贸易组织确认的一种新型知识产权，具有集合性、法定性、永久性、不可转让性等特点。
-  邻接权，又称作品传播者权，是指与著作权相邻近的权利。
-  商业秘密权是公民、企业、单位、组织享有的知识产权。商业秘密的保护范围包括所有技术信息、经营信息，以及其他与商业竞争有关的信息。
   -  商业秘密权是商业秘密的合法控制人采取了保密措施，**依法对其经营信息和技术信息享有的专有使用权**






软件许可使用一般有独占许可使用、独家许可使用和普通许可使用三种形式。

- 独占许可使用，许可的是专有使用权，实施独占许可使用后，软件著作权人不得将软件使用权授予第三方，**软件著作权人自己不能使用该软件；**
- 独家许可使用，许可的是专有使用权，实施独家许可使用后，软件著作权人不得将软件使用权授予第三方，软件著作权人自己可以使用该软件；
- 普通许可使用，许可的是非专有使用权，实施普通许可使用后，软件著作权人可以将软件使用权授予第三方，软件著作权人自己可以使用该软件。

## 软件开发与标准

### 软件设计

#### 需求分析

在敏捷过程的开发方法中，（ ）使用了迭代的方法，其中，把每段时间（30天）一次的迭代称为一个“冲刺”，并按需求的优先级别来实现产品，多个自组织和自治的小组并行地递增实现产品。**并列争球法**



模块独立性是创建良好设计的一个重要原则，一般采用模块间的耦合和模块的内聚两个准则来进行度量。内聚是指模块内部各元素之间联系的紧密程度，内聚度越高，则模块的独立性越好。内聚性一般有以下几种
①巧合内聚，指**一个模块内的各个处理元素之间没有任何联系。**
②逻辑内聚，指模块内执行几个逻辑上相似的功能，通过参数确定该模块完成哪一个功能。
③时间内聚，把需要同时执行的动作组合在一起形成的模块。
④通信内聚，指模块内所有处理元素都在同一个数据结构上操作，或者指各处理使用相同的输入数据或者产生相同的输出数据。
⑤顺序内聚，指一个模块中各个处理元素都密切相关于同一功能且必须顺序执行，前一个功能元素的输出就是下一个功能元素的输入。
⑥功能内聚，是最强的内聚，指模块内所有元素共同完成一个功能，缺一不可。



#### 软件的分类

- 系统软件，如操作系统
- 支撑软件，如开发工具
- 应用软件，如office
- 实时处理软件，一般是工业软件

#### 软件生存周期

> 在信息系统开发过程中，分析阶段任务是回答信息系统“做什么”的问题，设计阶段是回答系统“怎么做”的问题。

- 软件定义
  - 问题定义，落实问题的性质、工程目标和规模，明白要解决什么问题
  - 可行性研究，**估计系统的成本和效益**
  - 需求分析，明确系统必须具备哪些功能，**用数据字典和简要算法描述系统逻辑性**

- 软件开发
  - 概要设计，确立总体结构和模块关系，定义模块之间的接口，设计全局数据结构，制定综合测试计划
  - 详细设计，设计模块内的细节，如算法、数据结构和接口信息

- 编码和单元测试，使用程序设计语言实现模块内功能并测试该模块
- 综合测试

#### 软件开发模型

常见的软件生存周期模型有瀑布模型、演化模 型、螺旋模型、喷泉模型等。 瀑布模型是将软件 生存周期各个活动规定为依线性顺序连接的若干 阶段的模型， 适合于软件需求很明确的软件项 目。V模型是瀑布模型的一种演变模型，将测试 和分析与设计关联进行， 加强分析与设计的验 证。原型模型是一种演化模型， 通过快速构建可 运行的原型系统， 然后根据运行过程中获取的用 户反馈进行改进。 演化模型特别适用于对软件需 求缺乏准确认识的情况。 螺旋模型将瀑布模型和 演化模型结合起来， 加入了两种模型均忽略的风 险分析

常见的软件生存周期模型有瀑布模型、演化模 型、螺旋模型、喷泉模型等。 。。。 螺旋模型将瀑布模型和 演化模型结合起来， 加入了两种模型均忽略的风 险分析

- 瀑布模型，瀑布模型是将软件生存周期各个活动规定为依线性顺序连接的若干 阶段的模型， **适合于软件需求很明确变更少的软件项目**

  - **自顶到下的线性模型，开发后期的测试阶段才能发现问题，增加了开发的风险**

  - 假设某软件公司与客户签订合同开发一个软件系统，系统的功能有较清晰的定义， 且客户对交付时间有严格要求，则该系统的开发最适宜采用（ ）。瀑布模型
- **演化模型特别适用于对软件需求缺乏准确认识的情况**
- V模型是瀑布模型的一种演变模型，将测试 和分析与设计关联进行， 加强分析与设计的验 证
- 原型模型是一种演化模型， 通过**快速构建可运行的原型系统**， 然后根据运行过程中获取的用 户反馈进行改进。 
- **增量模型，先开发核心模块，其他构件逐步附加**
- **螺旋模型，适合于大型复杂项目**
- **喷泉模型，面向对象的典型开发模型**



程序控制的三种结构，顺序、选择、循环

面向对象方法（OO）=对象+类+继承+通过消息的通信

- 对象是具有特殊属性（数据）和行为方式（方法）的实体
- 类是具有相同属性和行为的一个或多个对象的描述
- 实例是类所描述的一个具体的对象



统一建模语言UML，是一种图示建模语言，UML表示法包括**事务、关系和图三种构造块**

#### 软件开发方法

![image-20240918145254659](img/计算机/计算机网络/image-20240918145254659.png)

面向对象开发方法有Booch方法、Coad方法和OMT方法。Jackson方法是一种面向数据结构的开发方法。

#### 软件开发语言

（1）标记语言：一种将文本以及文本相关的其他信息结合起来，展现出关于文档结构和数据处理细节的电脑文字编码。常用于格式化和链接，如HTML、XML。

（2）脚本语言：又称为动态语言，是一种编程语言，用来控制软件应用程序，只在调用时进行解释，可以定义函数和变量，比编译型语言的语法和规则更简单灵活，跨平台移植难度低。典型的脚步语言：Python，JavaScript、VBScript、PHP

（3）编译型语言：程序在执行之前需要一个专门的编译过程，把程序编译成机器语言，比如exe文件。程序执行效率高，依赖编译器，跨平台移植难度大。编译型语言代表有：C、C++、Java。

> 编译和解释的区别
>
> - 1、编译是将源程序翻译成可执行的目标代码；解释程序不产生目标代码。
> - 2、解释程序可跨平台使用；编译程序跨平台性不好。
> - 3、解释程序可以随时修改，立刻生效；编译程序不行。
> - 4、解释程序运行效率低；编译程序执行速度快。

python不是编译型

脚本语言主要是解释方式实现

中间代码可以用栈和队列表示。错误

#### 软件测试

- 人工测试，也叫代码审查，可调编码错和逻辑错
- 机器测试——白盒测试，要完全理解**程序结构和处理过程，测试逻辑路径**，也称为结构测试，逻辑覆盖是白盒测试的常用方法
- 机器测试——黑盒测试，**测试程序的输入输出，也叫功能测试，黑盒白盒互为补充**



修改一个错误做的变更，会引起以前正确运行的代码出错，**回归测试**最可能发现这一问题

软件调试技术一般有蛮干法、原因排除法（对分查找法、归纳法、演绎法）、回溯法

#### 软件项目管理

软件编码规模=(最大规模+4最可能的规模+最小规模)/6



软件过程能力评估，ISO9000:2000和CMM（软件成熟度模型），CMM五个级别，级别三为已定义级，CMM5（5级别）达到优化级



**项目收尾：合同收尾，管理收尾**



- 结构化开发方法是传统的、也是应用较为广泛的一种软件开发方法，它**基于数据流**进行需求分析和软件设计，用抽象模型的概念，按照软件内部数据传递和转换关系，对问题和功能自顶向下逐层分解。
- Jackson系统开发方法是一种典型的**面向数据结构**的分析和设计方法，以活动为中心，一连串活动的顺序组合成一个完整的工作进程。Booch方法是一种面向对象的软件开发方法。
- UNL仅仅是一种**建模标准语言**，规定了构成软件的各个元素和构件的图示规范。



软件风险一**般包括不确定性和损失两个特性**，其中不确定性是指风险可能发生，也可能不发生；损失是当风险确实发生时，会引起的不希望的后果和损失



软件测试时，白盒测试不能发现( ) 功能正确

“白盒法”把测试对象看做是一个打开的盒子，测试人员需了解程序的内部结构和处理过程，以检查处理过程的细节为基础，对程序中尽可能多的逻辑路径进行测试，检验内部控制结构和数据结构是否有错，实际的运行状态与预期的状态是否一致。常用的白盒测试用例设计方法有基本路径测试、循环覆盖测试、逻辑覆盖测试。**白盒测试不关心功能需求，故无法确定功能正确与否**。



数据标准化三个阶段 

业务建模阶段：现实业务过程全面分析和了解；以业务模型为基础；是数据标准化的基础和前题。 

数据规范化阶段：关键和核心；对数据元素进行提取、规范化及管理的过程；是数据标准化的核心和重点。 

文档规范化阶段：是实际应用的关键，是实现离散数据有效合成 的重要途径；是数据标准化的成果有效应用的关键









依据《数据中心设计规范》，在设计数据中心时，成行排列的机柜，其长度大于()米时，两端应设有通道。
A.5
B.6
C.7
D.8
信管网参考答案：B



##### 项目成本管理过程

（1）规划成本：为规划、管理、花费和控制项目成本而制定的政策，程序和文档的过程。影响规划成本过程包括市场条件、货币汇率等事业环境因素和财务数据、历史信息等资产因素。
（2）估算成本：对完成项目活动所需资金进行近似估算的过程。包括完成活动所需要的设备、材料、设施、人员成本的主要因素和通货膨胀、融资成本、应急成本等客观因素。
（3）制定预算：汇总所有单个活动的估算成本，建立一个经批准的成本基准的过程。
（4）控制成本：监督项目状态，以更新项目成本，管理成本基准变更的过程

##### 项目风险管理过程：

（1）规划风险管理：决定如何进行规划和实施项目风险管理活动
（2）识别风险：判断会影响项目的潜在风险
（3）定性风险分析：评估风险概率和影响，进行风险程度排序
（4）定量风险分析：评估风险对项目的总体影响
（5）规划风险应对：制订降低风险的方案行动
（6）控制风险：项目生命期实施风险应对措施来降低风险

## 项目流程图

#### 数据流图（DFD）

> [数据流图**](https://www.baidu.com/s?wd=数据流图&tn=62095104_41_oem_dg&usm=2&ie=utf-8&rsv_pq=ced9f81a00101591&oq=数据流图是什么&rsv_t=fc9eqHoWy4Vy2hWCMnatoM4A0pXc8FGOzdtVPm21r%2BUcEVLIBMk%2F80N%2F%2FPrbZ%2FM722FhDXciXXeU&sa=re_dqa_zy&icon=1)(Data Flow Diagram)，简称[DFD**](https://www.baidu.com/s?wd=DFD&tn=62095104_41_oem_dg&usm=2&ie=utf-8&rsv_pq=ced9f81a00101591&oq=数据流图是什么&rsv_t=682aBWH2nq4wdrB%2BbC8xd0H1AZnxzeZ4v%2F4iKJfJYAFy2nJ3KdNw64IHBIdzTSDXmyVbxaU6oNTZ&sa=re_dqa_zy&icon=1)，是一种图形化的表示方法，用于描述系统中数据的流动和处理过程
>
> 根据层次关系一般将数据流图分为顶层数据流图、中间数据流图和底层数据流图，除顶层数据流图外，其余分层数据流图从0开始编号。对任何一层数据流图来说，称它的上层数据流图为父图，称它的下一层的数据流图为子图。
> **顶层数据流图只含有一个加工，描述了系统的输入和输出**；输入数据流和输出数据流为系统的输入数据和输出数据，表明了系统的范围，以及与外部环境的数据交换关系。
> 底层数据流图是指其加工不能再分解的数据流图，其加工称为“原子加工”。
> 中间数据流图是对父层数据流图中某个加工进行细化，而它的某个加工也可以再次细化，形成子图。中间层次的多少，一般视系统的复杂程度而定。

数据流图（DFD）对系统的功能和功能之间的数据流进行建模，其中顶层数据流图描述了系统的（ ）。输入输出

在面向数据流的设计方法中，一般把数据流图中的数据流划分为 （ ） 两种。变换流和事务流 

利用结构化分析模型进行接口设计时，应以（ ）为依据 数据流图



项目范围管理过程如下所示，其正确的流程顺序是

第一步：收集需求
第二步：定义范围
第三步：创建工作分解结构
第四步：核实范围
第五步：控制范围

#### 甘特图

**甘特图通过条状图来显示，能直观表明每个任务的计划进度和当前进度**

#### PERT

网络图，PERT和CPM都采用网络图，网络图找工期要找最长路径

> 事件（Events）表示主要活动结束的那一点
>
> 活动（Activities）表示从一个事件到另一个事件之间的过程
>
> 松弛时间（slack time）不影响完工前提下可能被推迟完成的最大时间
>
> 计算：**关键路径的总时间-包含该任务的关键路径花的时间**
>
> 关键路线（Critical Path）是PERT网络中花费时间最长的事件和活动的序列

某软件项目的活动图如下图所示，其中顶点表示项目里程碑，连接顶点的边表示包含的活动，边上的数字表示该活动所需的天数，则完成该项目的最长时间为 （1）活动BD**最多可以晚**（2） 天开始而不会影响整个项目的进度。24，24-22=2

![83c05b44a88344e096acf4f1979380ce](img/计算机/计算机基础/83c05b44a88344e096acf4f1979380ce.png)



某软件项目的活动图如下图所示，其中顶点表示项目里程碑，连接顶点的边表示包含的活动，边上的数字表示活动的持续时间
（天），则完成该项目的最少时间为（）天。活动BD和HK最早可以从第（）天开始。（活动AB，AE和AC最早从第1天开始）

20，4（A-B-D，AB+1=4）和11（A-E-G-H,AEGH+1=11）

![img](https://img.kuaiwenyun.com/images/shiti/2019-12/334/SBSad77KjE.png)





某软件项目的活动图如下图所示，其中顶点表示项目里程碑，连接顶点的边表示包含的活动，边上的数字表示活动的持续时间（天）。完成该项目的最少时间为（7）。由于某种原因，现在需要同一个开发人员完成BC和BD，到完成该项目如最少时闻为（8）天。18,20

![05737da4a12840788550c3165e5f22d9](img/计算机/计算机基础/05737da4a12840788550c3165e5f22d9.png)



关键路径：最长的一段（abcefj==abdgfj=18天），bd、bc只能由同一个人来完成，因此最快的方式为，先完成bd再去完成bc（因此相当于此时，关键路径abcefj上推迟了2天完成，因此此时项目完成的最少时间为20天）。



使用PERT图进行进度安排，不能清晰地描述　（1）　，但可以给出哪些任务完成后才能开始另一些任务。下面PERT图所示工程从A到K的关键路径是　（2）　（图中省略了任务的开始和结束时刻）。

![20131129222714_7812](img/计算机/计算机基础/20131129222714_7812.png)



- 各任务之间的并行情况
- ABEGHJK

关键路线(Critical Path)是PERT网络中花费时间最长的事件和活动的序列。

PERT图的特点是通过关键路径法进行包括费用在内的资源最优化考虑，压缩关键路径上的工作，在规定的时间以前把它高效率地完成。PERT图不仅给出了每个任务的开始时间、结束时间和完成该任务所需的时间，还给出任务之间的关系，即哪些任务完成后才能开始另外一些任务，以及如期完成整个工程的关键路径，但是PERT图不能反映任务之间的并行关系。按照定义，题中的PERT图的关键路线是ABEGHJK。



